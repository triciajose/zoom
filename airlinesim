## REVEAL COMPETITION SIMULATION ##
#    Airline Simulation           #



####- MODEL PROPERTIES -####

M StartTime = 0
M EndTime = 7
M InitialSteps = 0
M MultiPlayerRolesRange = Team

R Team = 1..24

M StepsPerInterval = 1
M StepsPerSave = 1
M TimeStep = 1
M TimeFormat = Quarter #
M AllowDivisionByZero = true
M ExecuteDecisionImmediately = false

V X Previ Quarter = STEP - 1
V X Days Of Operation In Quarter = 85
D X Z Timer Switch[Team] = 0

D X Z Reset Lock[Team] = 0
P X Z Reset Lock.ExecuteDecisionImmediately = true
####- MODEL FORMULAS -####

#V MarketShare[Team] = (1 * 0.6) - (0.6 * Price / ARRAYSUM(Price)) + (0.4 * MarketingBudget / ARRAYSUM(MarketingBudget))
#P MarketShare.SaveResult = true

D X Mini Challenge Bonus Income[Team] = 0
#V ExtraDemand[Team] = IF(InFlightMeals = 1, 250, 0)

#V Revenue[Team] = Price * Total Sales
#V Revenue Previous[Team] = PREVIOUS(Revenue)
#V AccumRevenue[Team] = ACCUM(Revenue)

#>V Revenue[Team] = IF(AvailableSeats < (MarketShare * (Demand + ExtraDemand)), Price * AvailableSeats, Price * MarketShare * Demand)https://forio.com/simulate/academic/reveal-competition-simulation/interface/

#V AccumRevenue[Team] = ACCUM(Revenue)

#V InFlightMealsExpense[Team] = IF(InFlightMeals = 1, AvailableSeats * InFightMealsDemand * InFightMealsCostPerPerson, 0)

#V Costs[Team] = (AirplaneFleet * AirplaneCost) + MarketingBudget + InFlightMealsExpense
V Costs[Team] = 0

V Profit[Team] = Total Overall Revenue - Costs

#V FilledSeatsRatio[Team] = Revenue / Price / AvailableSeats

#V Total Market Share[Team] = (0.5 * Route A1 Norm Market Share ) + (0.2 * Route A1 Return Trips Market Share) + (0.3 * Price Market Share)
#V Market Share For Customers[Team] = Total Market Share * Route A1 Norm Demand For Teams
#V Route A1 Sales[Team] = Total Market Share * Route A1 Norm Demand For Teams

###- OPERATIONS MEASURES -#############

V X Reliability Variable Quarterly[8] = {0.93, 0.93, 0.93, 0.93, 0.93, 0.93, 0.93, 0.93}
V X Reliability Variable[Team] = X Reliability Variable Quarterly[STEP + 1]
### FIX!!!!!^
V X Reliability Variable Previ[Team] = PREVIOUS(X Reliability Variable) * Compensation AB Increase Quality
V X Reliability Maintenance[Team] = ((1 - X Reliability Variable) / 2) + X Reliability Variable

V X Quality Variable Quarterly[8] = {0.82, 0.82, 0.82, 0.82, 0.82, 0.82, 0.82, 0.82}
V X Quality Variable[Team] = X Quality Variable Quarterly[STEP + 1]
V X Quality Variable Previ[Team] = PREVIOUS(X Quality Variable)

V X Fuel Cost Per Seat Km[Team] = Fleet Airplanes Fuel Cost Per Seat Mile Average


V X Cost Per Available Seat Km[Team] = ROUND((Total Operating Expenses + Revenue E Refunds On Sales + Revenue F Commissions On Sales) / Total Available Seat Kms, 3)
V X Cost Per Available Seat Km Previ[Team] = PREVIOUS(X Cost Per Available Seat Km, 0)

V X Profit Per Available Seat Km[Team] = Price Yield Per Available Seat Km - X Cost Per Available Seat Km
V X Profit Per Available Seat Km Previ[Team] = PREVIOUS(X Profit Per Available Seat Km, 0)




V X Employees Total[Team] = PREVIOUS(X Employees Total, 72) - X Employee Resignations + Total Pass Expense Quarterly[STEP + 1] * IF(Total Airplanes In Possession > PREVIOUS(Total Airplanes In Possession,0), (Total Airplanes In Possession - PREVIOUS(Total Airplanes In Possession,0)) * 6, 0)
V X Employees Total Previ[Team] = PREVIOUS(X Employees Total, 0)
V X Employee Resignations[Team] = FLOOR(RANDBETWEEN(8,0), 1)
### FIX!!!!!^
V X Employee Resignations Previ[Team] = PREVIOUS(X Employee Resignations, 0)



V X Fuel Market Rates[8] = {1.04, 1.02, 1.01, 0.99, 0.97, 1.02, 0.99, 1.03}  
V X Fuel Market Rate = 3 * X Fuel Market Rates[STEP + 1]
V X Fuel Market Rate Previ = PREVIOUS(X Fuel Market Rate, 0)

V X Fuel Contract Rates[8] = {1.05, 1.04, 0.99, 0.97, 1.02, 0.99, 1.0, 1.02}  
V X Fuel Contract Rate = 3 * X Fuel Contract Rates[STEP + 1]
V X Fuel Contract Rate Previ = PREVIOUS(X Fuel Contract Rate, 0)

V X Share Price[Team] = PREVIOUS(X Share Price, 15) * IF(Profit A Percent Changed Quarter Over Quarter < 0.5, 0.82, IF(Profit A Percent Changed Quarter Over Quarter > 1.2, 1.2,Profit A Percent Changed Quarter Over Quarter))
#* Financing BD Dividend Share Price Factor
### FIX!!!!!^ Add for dividends | Quality | And more
V X Share Price Previ[Team] = PREVIOUS(X Share Price, 0)

V X Shares Outstanding[Team] = PREVIOUS(X Shares Outstanding, (Shareholders 0 Initial Stock + Asset 0 Initial Cash) / 10) + (Financing AG Actual Sell Stock / X Share Price Previ) - (Financing AD Actual Stock Buy Back / X Share Price Previ) + IF(PREVIOUS(X Shares Outstanding, (Shareholders 0 Initial Stock + Asset 0 Initial Cash) / 10) + (Financing AG Actual Sell Stock / X Share Price Previ) - (Financing AD Actual Stock Buy Back / X Share Price Previ) > 150000, 0, 150000 - PREVIOUS(X Shares Outstanding, (Shareholders 0 Initial Stock + Asset 0 Initial Cash) / 10) + (Financing AG Actual Sell Stock / X Share Price Previ) - (Financing AD Actual Stock Buy Back / X Share Price Previ))
### FIX!!!!!^ partially fixed
V X Shares Outstanding Previ[Team] = IF(PREVIOUS(X Shares Outstanding, 0) < 150000, 150000, PREVIOUS(X Shares Outstanding, 0))

V X Shares Earnings Per Share[Team] = Total Retained Income / X Shares Outstanding
V X Shares Earnings Per Share Previ[Team] = Total Retained Income / X Shares Outstanding Previ
#V X Shares Earnings Per Share Previ[Team] = PREVIOUS(X Shares Earnings Per Share, 0)


###- REVENUE -#############

V Total Ticket Sales[Team] = Total Final Sales
V Total Ticket Revenue[Team] = ROUND(Price * Total Ticket Sales * X Days Of Operation In Quarter, 0)
V Revenue A Ticket Sales Previous[Team] = PREVIOUS(Total Ticket Revenue, 0)

V Total Inflight Food Revenue[Team] = ROUND(Inflight Total Food Revenue * X Days Of Operation In Quarter, 0)
V Revenue B Inflight Food Previous[Team] = PREVIOUS(Total Inflight Food Revenue)

V Total Cargo Revenue[Team] = ROUND(Marketing X8 Cargo Service Sales, 0) + X Mini Challenge Bonus Income
V Revenue C Cargo Revenue Previous[Team] = PREVIOUS(Total Cargo Revenue)

V Total Baggage Revenue[Team] = ROUND(Baggage D Revenue * X Days Of Operation In Quarter, 0)
V Revenue D Baggage Revenue Previous[Team] = PREVIOUS(Total Baggage Revenue)

V Revenue E Refunds On Sales[Team] = Total Ticket Revenue * (1 - X Reliability Variable) 
V Revenue E Refunds On Sales Previ[Team] = PREVIOUS(Revenue E Refunds On Sales, 0)

V Revenue F Commissions On Sales[Team] = Total Ticket Revenue * 0.03
### FIX!!!!!^
V Revenue F Commissions On Sales Previ[Team] = PREVIOUS(Revenue F Commissions On Sales, 0) 

V Total Overall Revenue[Team] = (Total Ticket Revenue + Total Inflight Food Revenue + Total Cargo Revenue + Total Baggage Revenue) - Revenue E Refunds On Sales - Revenue F Commissions On Sales
V Revenue Z Overall Previous[Team] = PREVIOUS(Total Overall Revenue, 0)


###- EXPENSES -#############
V Expenses 0A Center Per Seat Km Operating Expense = 0.042

V Total Operations Expenses[Team] = (Total Available Seat Kms * Expenses 0A Center Per Seat Km Operating Expense)
### FIX!!!!!^ <--Semi Fixed already
V Expenses A Operations Expenses Previous[Team] = PREVIOUS(Total Operations Expenses)

#V Total Fuel Expenses Airplane Model 1[Team] = Total Available Seat Kms Airplane Model 1 * Airplane Model 1 Fuel Cost Per Seat Km * X Days Of Operation In Quarter
#V Total Fuel Expenses Airplane Model 2[Team] = Total Available Seat Kms Airplane Model 2 * Airplane Model 2 Fuel Cost Per Seat Km * X Days Of Operation In Quarter
#V Total Fuel Expenses Airplane Model 3[Team] = Total Available Seat Kms Airplane Model 3 * Airplane Model 2 Fuel Cost Per Seat Km * X Days Of Operation In Quarter
#V Total Fuel Expenses Airplane Model 4[Team] = Total Available Seat Kms Airplane Model 4 * Airplane Model 2 Fuel Cost Per Seat Km * X Days Of Operation In Quarter
#V Total Fuel Expenses Airplane Model 5[Team] = Total Available Seat Kms Airplane Model 5 * Airplane Model 2 Fuel Cost Per Seat Km * X Days Of Operation In Quarter
#V Total Fuel Expenses Airplane Model 6[Team] = Total Available Seat Kms Airplane Model 6 * Airplane Model 2 Fuel Cost Per Seat Km * X Days Of Operation In Quarter
#V Total Fuel Expenses Airplane Model 7[Team] = Total Available Seat Kms Airplane Model 7 * Airplane Model 2 Fuel Cost Per Seat Km * X Days Of Operation In Quarter
#V Total Fuel Expenses[Team] = (Total Fuel Expenses Airplane Model 1 + Total Fuel Expenses Airplane Model 2 + Total Fuel Expenses Airplane Model 3 + Total Fuel Expenses Airplane Model 4 + Total Fuel Expenses Airplane Model 5 + Total Fuel Expenses Airplane Model 6 + Total Fuel Expenses Airplane Model 7)
V Total Fuel Expenses[Team] = Total Fuel Expenses For All Markets
V Expenses B Fuel Expenses Previous[Team] = PREVIOUS(Total Fuel Expenses, 0)

V Total Maintenance Expenses Airplane Model 1[Team] = Total Available Seat Kms Airplane Model 1 * X Reliability Maintenance * Airplane Model 1 Maintenance Cost Per Seat Km
V Total Maintenance Expenses Airplane Model 2[Team] = Total Available Seat Kms Airplane Model 2 * X Reliability Maintenance * Airplane Model 2 Maintenance Cost Per Seat Km
V Total Maintenance Expenses Airplane Model 3[Team] = Total Available Seat Kms Airplane Model 3 * X Reliability Maintenance * Airplane Model 3 Maintenance Cost Per Seat Km
V Total Maintenance Expenses Airplane Model 4[Team] = Total Available Seat Kms Airplane Model 4 * X Reliability Maintenance * Airplane Model 4 Maintenance Cost Per Seat Km
V Total Maintenance Expenses Airplane Model 5[Team] = Total Available Seat Kms Airplane Model 5 * X Reliability Maintenance * Airplane Model 5 Maintenance Cost Per Seat Km
V Total Maintenance Expenses Airplane Model 6[Team] = Total Available Seat Kms Airplane Model 6 * X Reliability Maintenance * Airplane Model 6 Maintenance Cost Per Seat Km
V Total Maintenance Expenses Airplane Model 7[Team] = Total Available Seat Kms Airplane Model 7 * X Reliability Maintenance * Airplane Model 7 Maintenance Cost Per Seat Km
V Total Maintenance Expenses[Team] = (Total Maintenance Expenses Airplane Model 1 + Total Maintenance Expenses Airplane Model 2 + Total Maintenance Expenses Airplane Model 3 + Total Maintenance Expenses Airplane Model 4 + Total Maintenance Expenses Airplane Model 5 + Total Maintenance Expenses Airplane Model 6 + Total Maintenance Expenses Airplane Model 7) * X Days Of Operation In Quarter + IF(Maintenance A Scheduling = 1, Maintenance X Level 1 * Total Airplanes In Possession, 0) + IF(Maintenance A Scheduling = 2, Maintenance X Level 2 * Total Airplanes In Possession, 0)
V Expenses C Maintenance Expenses Previous[Team] = PREVIOUS(Total Maintenance Expenses, 0)

V Total Pass Expense Quarterly[8] = {0, 0, 1, 1, 1, 1, 1, 1}  
V Total Passenger Service Expenses[Team] = Total Pass Expense Quarterly[STEP + 1] + Compensation Total * Total Pass Expense Quarterly[STEP  + 1]
#### FiX!!! ^
V Expenses N Passenger Service Expenses Previ[Team] = PREVIOUS(Total Passenger Service Expenses, 0)

V Total Insurance Expenses Airplane Model 1[Team] = Airplane Model 1 Insurance Cost Per Plane * Airplane Model 1 Owned A Leased Planes
V Total Insurance Expenses Airplane Model 2[Team] = Airplane Model 2 Insurance Cost Per Plane * Airplane Model 2 Owned A Leased Planes
V Total Insurance Expenses Airplane Model 3[Team] = Airplane Model 3 Insurance Cost Per Plane * Airplane Model 3 Owned A Leased Planes
V Total Insurance Expenses Airplane Model 4[Team] = Airplane Model 4 Insurance Cost Per Plane * Airplane Model 4 Owned A Leased Planes
V Total Insurance Expenses Airplane Model 5[Team] = Airplane Model 5 Insurance Cost Per Plane * Airplane Model 5 Owned A Leased Planes
V Total Insurance Expenses Airplane Model 6[Team] = Airplane Model 6 Insurance Cost Per Plane * Airplane Model 6 Owned A Leased Planes
V Total Insurance Expenses Airplane Model 7[Team] = Airplane Model 7 Insurance Cost Per Plane * Airplane Model 7 Owned A Leased Planes
V Total Insurance Expenses[Team] = Total Insurance Expenses Airplane Model 1 + Total Insurance Expenses Airplane Model 2 + Total Insurance Expenses Airplane Model 3 + Total Insurance Expenses Airplane Model 4 + Total Insurance Expenses Airplane Model 5 + Total Insurance Expenses Airplane Model 6 + Total Insurance Expenses Airplane Model 7
V Expenses D Insurance Expenses Previous[Team] = PREVIOUS(Total Insurance Expenses, 0)

V Total Marketing Expenses[Team] = Marketing Z Total Expenses
V Expenses E Marketing Expenses Previous[Team] = PREVIOUS(Total Marketing Expenses, 0)

V Total Employee Training Expenses[Team] = Compensation A Employee Training Budget
V Expenses F Employee Training Expenses Previous[Team] = PREVIOUS(Total Employee Training Expenses, 0)

V Total Corporate Social Responsibility Budget[Team] = Donation D Actual Amount Donating
V Expenses G Corporate Social Responsibility Previous[Team] = PREVIOUS(Total Corporate Social Responsibility Budget, 0)

V Total Industry Reports Expenses[Team] = 0
### FIX!!!!!^
V Expenses H Industry Reports Expenses Previous[Team] = PREVIOUS(Total Industry Reports Expenses, 0)

V Total Interest Expenses[Team] = (Liability B Short Term Debt * Financing 0B Short Term Debt Interest Rate) + (Liability C Long Term Debt * Financing 0C Long Term Debt Interest Rate) + PREVIOUS(Flow ZB Overdaft Interest Expenses, 0)
V Expenses I Interest Expenses Previous[Team] = PREVIOUS(Total Interest Expenses, 0)

V Total Lease Expenses[Team] = Airplane Model 1 Monthly Lease Cost * Airplane Model 1 Leased + Airplane Model 2 Monthly Lease Cost * Airplane Model 2 Leased + Airplane Model 3 Monthly Lease Cost * Airplane Model 3 Leased + Airplane Model 4 Monthly Lease Cost * Airplane Model 4 Leased + Airplane Model 5 Monthly Lease Cost * Airplane Model 5 Leased  + Airplane Model 6 Monthly Lease Cost * Airplane Model 6 Leased + Airplane Model 7 Monthly Lease Cost * Airplane Model 7 Leased
V Expenses J Lease Expenses Previous[Team] = PREVIOUS(Total Lease Expenses, 0)

V Total Administration Expenses[Team] = IF(Total Seats Available < 101, Administrative Expense Level 1, IF(Total Seats Available < 201, Administrative Expense Level 2, IF(Total Seats Available < 301, Administrative Expense Level 3, IF(Total Seats Available < 401, Administrative Expense Level 4, IF(Total Seats Available < 501, Administrative Expense Level 5, IF(Total Seats Available < 601, Administrative Expense Level 6, IF(Total Seats Available < 701, Administrative Expense Level 7, Administrative Expense Level 8)))))))
V Expenses K Administration Expenses Previous[Team] = PREVIOUS(Total Administration Expenses, 0)

V Total Depreciation Expenses[Team] = Fleet Quarterly Depreciation Expense
V Expenses L Depreciation Expenses Previous[Team] = PREVIOUS(Total Depreciation Expenses, 0)

#V Total Miscellaneous Expenses[Team] = Fleet Selling Expenses
### FIX!!!!!^
#V Expenses M Miscellaneous Expenses Previous[Team] = PREVIOUS(Total Miscellaneous Expenses, 0)
V Total Miscellaneous Expenses[Team] = Fleet Selling Expenses
V Expenses M Miscellaneous Expenses Previous[Team] = PREVIOUS(Total Miscellaneous Expenses, 0)

V Total Operating Expenses[Team] = Total Operations Expenses + Total Fuel Expenses + Total Maintenance Expenses + Total Insurance Expenses + Total Marketing Expenses + Total Employee Training Expenses + Total Corporate Social Responsibility Budget + Total Industry Reports Expenses + Total Interest Expenses + Total Lease Expenses + Total Administration Expenses + Total Depreciation Expenses + Total Passenger Service Expenses + Total Miscellaneous Expenses
V Expenses Z Total Operating Previous[Team] = PREVIOUS(Total Operating Expenses, 0)


###- PROFIT -#############
V Profit ZZ Constant Income Tax Rate = 0.17


V Total Overall Profit Before Taxes Pre Rounded[Team] = Total Overall Revenue - Total Operating Expenses
V Total Overall Profit Before Taxes[Team] = ROUND(Total Overall Profit Before Taxes Pre Rounded, 0)
V Profit A Total Operating Before Taxes Previous[Team] = PREVIOUS(Total Overall Profit Before Taxes, 0)
V Total Overall Profit Before Taxes After Loss Carry Forward[Team] = Total Overall Profit Before Taxes + Total Loss Carry Forward Removal
V Total Overall Profit Before Taxes After Loss Carry Forward Previ[Team] = PREVIOUS(Total Overall Profit Before Taxes After Loss Carry Forward, 0)


V Profit A Changed Quarter Over Quarter[Team] = Total Overall Profit Before Taxes - PREVIOUS(Total Overall Profit Before Taxes,0)
V Profit A Percent Changed First Calculation[Team] = (ABS(Total Overall Profit Before Taxes - PREVIOUS(Total Overall Profit Before Taxes, 0)) / PREVIOUS(Total Overall Profit Before Taxes, 0)) / 10 / 2
V Profit A Percent Changed Second Calculation[Team] = IF((PREVIOUS(Total Overall Profit Before Taxes, 0) > 0 & Total Overall Profit Before Taxes > 0) | (PREVIOUS(Total Overall Profit Before Taxes, 0) > 0 & Total Overall Profit Before Taxes < 0), 1 * Profit A Changed Quarter Over Quarter, (-1) * Profit A Changed Quarter Over Quarter)
V Profit A Percent Changed Quarter Over Quarter[Team] = IF(PREVIOUS(Total Overall Profit Before Taxes, 0) = 0, 1, IF(Profit A Percent Changed Second Calculation >= 0, 1 + Profit A Percent Changed First Calculation, 1 - Profit A Percent Changed First Calculation))

V Total Loss Carry Forward Removal[Team] = IF(Total Overall Profit Before Taxes <= 0, 0, IF(Total Overall Profit Before Taxes > 0 & PREVIOUS(Total Loss Carry Forward, 0) < 0 & PREVIOUS(Total Loss Carry Forward, 0) * (-1) > Total Overall Profit Before Taxes, Total Overall Profit Before Taxes * (-1), PREVIOUS(Total Loss Carry Forward, 0)))
#IF(PREVIOUS(Total Loss Carry Forward, 0) < 0 & Total Overall Profit Before Taxes > 0 & PREVIOUS(Total Loss Carry Forward, 0) * (-1) < Total Overall Profit Before Taxes, PREVIOUS(Total Loss Carry Forward, 0), Total Overall Profit Before Taxes * (-1))
#V Total Loss Carry Forward Removal Previ[Team] = PREVIOUS(Total Loss Carry Forward Removal, 0)
V Total Loss Carry Forward Removal Previ[Team] = PREVIOUS(Total Loss Carry Forward Removal, 0)
V Total Loss Carry Forward[Team] = PREVIOUS(Total Loss Carry Forward, 0) + IF(Total Overall Profit Before Taxes > 0, 0, Total Overall Profit Before Taxes) - Total Loss Carry Forward Removal
V Total Loss Carry Forward Previ[Team] = PREVIOUS(PREVIOUS(Total Loss Carry Forward, 0), 0)

V Total Income Taxes Pre Rounded[Team] = IF(Total Overall Profit Before Taxes After Loss Carry Forward > 0, Total Overall Profit Before Taxes After Loss Carry Forward * Profit ZZ Constant Income Tax Rate, 0)
V Total Income Taxes Paid[Team] = ROUND(Total Income Taxes Pre Rounded, 0)
V Profit B Income Taxes Paid Previous[Team] = PREVIOUS(Total Income Taxes Paid, 0)

V Total Net Profit[Team] = Total Overall Profit Before Taxes - Total Income Taxes Paid
V Profit C Net Profit Previous[Team] = PREVIOUS(Total Net Profit, 0)

V Total Dividends Payable[Team] = Financing BC Actual Dividends Paid
V Profit D Dividends Paid Previous[Team] = PREVIOUS(Total Dividends Payable, 0)

V Total Retained Income[Team] = Total Net Profit - Total Dividends Payable
V Profit E Retained Income Previous[Team] = PREVIOUS(Total Retained Income, 0)


###- CASH FLOW -#############

V Flow A Beginning Cash[Team] = PREVIOUS(Asset A Cash, Asset 0 Initial Cash)
V Flow A Beginning Cash Previ[Team] = PREVIOUS(Flow A Beginning Cash, 0)

V Flow B Term Deposit Redemption[Team] = Financing ED Redemption Term Deposit Investment
V Flow B Term Deposit Redemption Previ[Team] = PREVIOUS(Flow B Term Deposit Redemption, 0)

V Flow C Gross Revenue[Team] = (Total Ticket Revenue + Total Inflight Food Revenue + Total Cargo Revenue + Total Baggage Revenue) * 0.60
### FIX!!!!!^
V Flow C Gross Revenue Previ[Team] = PREVIOUS(Flow C Gross Revenue, 0)

V Flow D Accounts Receivable[Team] = PREVIOUS(Asset C Accounts Receivable, 0)
V Flow D Accounts Receivable Previ[Team] = PREVIOUS(Flow D Accounts Receivable, 0)

V Flow E Stock Issued[Team] = Financing AA Sell Stock
V Flow E Stock Issued Previ[Team] = PREVIOUS(Flow E Stock Issued, 0)

V Flow F Loan Proceeds[Team] = Financing CB Actual Obtain Short Term Loans + Financing DB Actual Obtain Long Term Loans
V Flow F Loan Proceeds Previ[Team] = PREVIOUS(Flow F Loan Proceeds, 0)

V Flow G Other Income[Team] = Fleet Proceeds From Sale Of Airplanes
V Flow G Other Income Previ[Team] = PREVIOUS(Flow G Other Income, 0)

V Flow M Commissions And Refunds[Team] = Revenue E Refunds On Sales + Revenue F Commissions On Sales
V Flow M Commissions And Refunds Previ[Team] = PREVIOUS(Flow M Commissions And Refunds, 0)

V Flow N Operating Expense[Team] = (Total Operating Expenses - Total Depreciation Expenses) * 0.74
V Flow N Operating Expense Previ[Team] = PREVIOUS(Flow N Operating Expense, 0)

V Flow O Accounts Payable[Team] = PREVIOUS(Liability A Accounts Payable, 0)
V Flow O Accounts Payable Previ[Team] = PREVIOUS(Flow O Accounts Payable, 0)

V Flow P Income Tax Payable[Team] = Total Income Taxes Paid
V Flow P Income Tax Payable Previ[Team] = PREVIOUS(Flow P Income Tax Payable, 0)

V Flow Q Total Loan Payments[Team] = Financing IB Actual Payment of Long Term Loans + Financing HB Actual Payment of Short Term Loans
V Flow Q Total Loan Payments Previ[Team] = PREVIOUS(Flow Q Total Loan Payments, 0)

V Flow R Term Deposit Paid[Team] = Financing EC Actual Term Deposit Investment
V Flow R Term Deposit Paid Previ[Team] = PREVIOUS(Flow R Term Deposit Paid, 0)

V Flow S Dividends[Team] = Financing BC Actual Dividends Paid
V Flow S Dividends Previ[Team] = PREVIOUS(Flow S Dividends, 0)

V Flow T Equipment Purchases[Team] = Fleet Acquisition Actual Cost
V Flow T Equipment Purchases Previ[Team] = PREVIOUS(Flow T Equipment Purchases, 0)

V Flow X Total Cash Inflow[Team] = Flow A Beginning Cash + Flow B Term Deposit Redemption + Flow C Gross Revenue + Flow D Accounts Receivable + Flow E Stock Issued + Flow F Loan Proceeds + Flow G Other Income
V Flow X Total Cash Inflow Previ[Team] = PREVIOUS(Flow X Total Cash Inflow, 0)

V Flow Y Total Cash Outflow[Team] = Flow M Commissions And Refunds + Flow N Operating Expense + Flow O Accounts Payable + Flow P Income Tax Payable + Flow Q Total Loan Payments + Flow R Term Deposit Paid + Flow S Dividends + Flow T Equipment Purchases
V Flow Y Total Cash Outflow Previ[Team] = PREVIOUS(Flow Y Total Cash Outflow, 0)

V Flow Z Total Cash Flow[Team] = Flow X Total Cash Inflow - Flow Y Total Cash Outflow 
V Flow Z Total Cash Flow Previ[Team] = PREVIOUS(Flow Z Total Cash Flow, 0)

V Flow ZB Overdraft Funds[Team] = IF(Flow Z Total Cash Flow < 0, Flow Z Total Cash Flow * -1, 0)
V Flow ZB Overdraft Funds Previ[Team] = PREVIOUS(Flow ZB Overdraft Funds, 0)
V Flow ZB Overdaft Interest Expenses[Team] = Flow ZB Overdraft Funds * 0.22

V Flow ZC Ending Cash[Team] = IF(Flow Z Total Cash Flow < 0, 0, Flow Z Total Cash Flow)
V Flow ZC Ending Cash Previ[Team] = PREVIOUS(Flow ZC Ending Cash, 0)

V Flow ZZ Change In Cash Flow[Team] = Flow B Term Deposit Redemption + Flow C Gross Revenue + Flow D Accounts Receivable + Flow E Stock Issued + Flow F Loan Proceeds + Flow G Other Income - Flow M Commissions And Refunds - Flow N Operating Expense - Flow O Accounts Payable - Flow P Income Tax Payable - Flow Q Total Loan Payments - Flow R Term Deposit Paid - Flow S Dividends - Flow T Equipment Purchases

###- ASSETS -#############
V Asset 0 Initial Cash = 72100

V Asset A Cash[Team] = Flow ZC Ending Cash
V Asset A Cash Previ[Team] = PREVIOUS(Asset A Cash, 0)

V Asset B Short Term Investments[Team] = Financing EA Term Deposit Investment 
V Asset B Short Term Investments Previ[Team] = PREVIOUS(Asset B Short Term Investments, 0)

V Asset C Accounts Receivable[Team] = (Total Ticket Revenue + Total Inflight Food Revenue + Total Cargo Revenue) * 0.40
V Asset C Accounts Receivable Previ[Team] = PREVIOUS(Asset C Accounts Receivable, 0)

V Asset M Aircraft Acquired Value[Team] = (Airplane Model 1 Purchase Cost * Airplane Model 1 Own) + (Airplane Model 2 Purchase Cost * Airplane Model 2 Own) + (Airplane Model 3 Purchase Cost * Airplane Model 3 Own) + (Airplane Model 4 Purchase Cost * Airplane Model 4 Own) + (Airplane Model 5 Purchase Cost * Airplane Model 5 Own) + (Airplane Model 6 Purchase Cost * Airplane Model 6 Own) + (Airplane Model 7 Purchase Cost * Airplane Model 7 Own)
V Asset M Aircraft Acquired Value Previ[Team] = PREVIOUS(Asset M Aircraft Acquired Value, 0)

V Asset N Aircraft Depreciation[Team] = Fleet Total Depreciation
V Asset N Aircraft Depreciation Previ[Team] = PREVIOUS(Asset N Aircraft Depreciation, 0)

V Asset O Aircraft Book Value[Team] = Asset M Aircraft Acquired Value - Asset N Aircraft Depreciation
V Asset O Aircraft Book Value Previ[Team] = PREVIOUS(Asset O Aircraft Book Value, 0)

V Asset P Equiment[Team] = 0
### FIX!!!!!^
V Asset P Equiment Previ[Team] = PREVIOUS(Asset P Equiment, 0)

V Asset X Total Current Assets[Team] = Asset A Cash + Asset B Short Term Investments + Asset C Accounts Receivable
V Asset X Total Current Assets Previ[Team] = PREVIOUS(Asset X Total Current Assets, 0)

V Asset Y Total Non Current Assets[Team] = Asset O Aircraft Book Value + Asset P Equiment
V Asset Y Total Non Current Assets Previ[Team] = PREVIOUS(Asset Y Total Non Current Assets, 0)

V Asset Z Total Assets[Team] = Asset X Total Current Assets + Asset Y Total Non Current Assets
V Asset Z Total Assets Previ[Team] = PREVIOUS(Asset Z Total Assets, 0)


###- LIABILITIES -#############
V Liability 0 Initial Short Term Debt = 306000
V Liability 1 Initial Long Term Debt = 381000

V Liability A Accounts Payable[Team] = (Total Operating Expenses - Total Depreciation Expenses) * 0.26
V Liability A Accounts Payable Previ[Team] = PREVIOUS(Liability A Accounts Payable, 0)

V Liability B Short Term Debt[Team] = PREVIOUS(Liability B Short Term Debt Final, Liability 0 Initial Short Term Debt) + Financing CB Actual Obtain Short Term Loans
#V Liability B Short Term Debt[Team] = PREVIOUS(Liability B Short Term Debt, Liability 0 Initial Short Term Debt) + Financing CB Actual Obtain Short Term Loans
V Liability B Short Term Debt Final[Team] = Liability B Short Term Debt + Flow ZB Overdraft Funds - Financing HB Actual Payment of Short Term Loans 
V Liability B Short Term Debt Previ[Team] = PREVIOUS(Liability B Short Term Debt Final, 0)

V Liability C Long Term Debt[Team] = PREVIOUS(Liability C Long Term Debt, Liability 1 Initial Long Term Debt) + Financing DB Actual Obtain Long Term Loans - Financing IB Actual Payment of Long Term Loans
V Liability C Long Term Debt Previ[Team] = PREVIOUS(Liability C Long Term Debt, 0)

V Liability D Line Of Credit[Team] = FLOOR((Shareholders Z Total Shareholders Equity * 3) - Liability Z Total Liabilities, 100000)
#IF(FLOOR((Shareholders Z Total Shareholders Equity * 3) - Liability Z Total Liabilities, 100000) < 0, 0, FLOOR((Shareholders Z Total Shareholders Equity * 3) - Liability Z Total Liabilities, 100000))
IF(Shareholders Z Total Shareholders Equity < 1, 0, IF(Shareholders Z Total Shareholders Equity * 3 - PREVIOUS(Liability Z Total Liabilities, 0) < 1, 0, PREVIOUS(Shareholders Z Total Shareholders Equity, 0) * 3 - PREVIOUS(Liability Z Total Liabilities, 0)))
#
### FIX!!!!!^
V Liability D Line Of Credit Previ[Team] = PREVIOUS(Liability D Line Of Credit, 0)

V Liability X Total Current Liabilities[Team] = Liability A Accounts Payable + Liability B Short Term Debt Final
V Liability X Total Current Liabilities Previ[Team] = PREVIOUS(Liability X Total Current Liabilities, 0)

V Liability Y Total Non Current Liabilities[Team] = Liability C Long Term Debt
V Liability Y Total Non Current Liabilities Previ[Team] = PREVIOUS(Liability Y Total Non Current Liabilities, 0)

V Liability Z Total Liabilities[Team] = Liability X Total Current Liabilities + Liability Y Total Non Current Liabilities
V Liability Z Total Liabilities Previ[Team] = PREVIOUS(Liability Z Total Liabilities, 0)


###- SHAREHOLDERS EQUITY -#############
V Shareholders 0 Initial Stock = 4313000

V Shareholders A Common Stock[Team] = PREVIOUS(Shareholders A Common Stock, Shareholders 0 Initial Stock + Asset 0 Initial Cash) + Financing AA Sell Stock
### FIX!!!!!^
V Shareholders A Common Stock Previ[Team] = PREVIOUS(Shareholders A Common Stock, 0)

V Shareholders B Retained Earnings[Team] = PREVIOUS(Shareholders B Retained Earnings, Shareholders B Retained Earnings Initialize) + Total Retained Income
V Shareholders B Retained Earnings Previ[Team] = PREVIOUS(Shareholders B Retained Earnings, 0) 
D Shareholders B Retained Earnings Initialize[Team] = 0

V Shareholders Z Total Shareholders Equity[Team] = Shareholders A Common Stock + Shareholders B Retained Earnings
V Shareholders Z Total Shareholders Equity Previ[Team] = PREVIOUS(Shareholders Z Total Shareholders Equity, 0)

V Shareholders ZZ Total Shareholders Equity And Liabilities[Team] = Liability Z Total Liabilities + Shareholders Z Total Shareholders Equity
V Shareholders ZZ Total Shareholders Equity And Liabilities Previ[Team] = PREVIOUS(Shareholders ZZ Total Shareholders Equity And Liabilities, 0)


###- FINANCIAL RATIOS -#############

V Ratio Debt To Equity Ratio[Team] = Liability Z Total Liabilities / Shareholders Z Total Shareholders Equity
V Ratio Debt To Equity Ratio Proposed[Team] = Financing TA Proposed Total Debt And Accounts Payable / PREVIOUS(Shareholders Z Total Shareholders Equity, 0)
V Ratio Debt To Equity Ratio Previ[Team] = PREVIOUS(Ratio Debt To Equity Ratio)


####- PRICING DECISIONS -###################

D Price Structure[Team] = 2
P Price Structure.ExecuteDecisionImmediately = true
#V Pricing Tiers[3] = {1, 2, 3}

D Price Economy[Team] = 0
P Price Economy.DecisionMax = 0.28
P Price Economy.DecisionMin = 0.18
P Price Economy.ExecuteDecisionImmediately = true

D Price Normal[Team] = 0.37
P Price Normal.DecisionMax = 0.42
P Price Normal.DecisionMin = 0.32
P Price Normal.ExecuteDecisionImmediately = true

D Price Luxury[Team] = 0
P Price Luxury.DecisionMax = 0.56
P Price Luxury.DecisionMin = 0.46
P Price Luxury.ExecuteDecisionImmediately = true

V Price Indicator Switch[Team] = IF((Price Structure = 1 & Price Economy = 0) | (Price Structure = 2 & Price Normal = 0) | (Price Structure = 3 & Price Luxury = 0), 1, 0)

V Price[Team] = IF(Price Structure = 1, Price Economy,IF(Price Structure = 2, Price Normal, Price Luxury))
V Price Previ[Team] = PREVIOUS(Price)
V Price Yield Per Available Seat Km[Team] = Price * Total Passenger Load Factor
V Price Yield Per Available Seat Km Previ[Team] = PREVIOUS(Price Yield Per Available Seat Km)
#P Price.DecisionMax = STEP
#P Price.DecisionMin = 1
#P Price.SaveResult = true

#V Price Economy Number Of Teams[Team] = IF(Price Structure = 1, 1, 0)
#V Price Normal Number Of Teams[Team] = IF(Price Structure = 2, 1, 0)
#V Price Luxury Number Of Teams[Team] = IF(Price Structure = 3, 1, 0)

#V Price Sensitivity Economy = 1.001
#V Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Price Economy Number Of Teams)) / Price Economy) ^ Price Sensitivity Economy)
#V Price Market Share Economy[Team] = (Price Attractiveness Economy / ARRAYSUM(Price Attractiveness Economy))

#V Middling of Price[Team] = ABS(Price - ((ARRAYSUM(Price Normal) / ARRAYSUM(Price Normal Number Of Teams)) - 0.12))
#V Price Sensitivity Normal = 1.5
#V Price Attractiveness Normal[Team] = (ARRAYAVG(Middling of Price) / Middling of Price) ^ Price Sensitivity Normal
#V Price Market Share Normal[Team] = (Price Attractiveness Normal / ARRAYSUM(Price Attractiveness Normal))

#V Price Sensitivity Luxury = 1.001
#V Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Price Luxury Number Of Teams))) ^ Price Sensitivity Luxury)
#V Price Market Share Luxury[Team] = (Price Attractiveness Luxury / ARRAYSUM(Price Attractiveness Luxury))


####- ROUTE DECISIONS -####

V Total Planned Daily Flight Distance[Team] = Market A Total Planned Daily Flight Distance + Market B Total Planned Daily Flight Distance + Market C Total Planned Daily Flight Distance + Market D Total Planned Daily Flight Distance + Market E Total Planned Daily Flight Distance
V Total Planned Daily Flight Distance Previ[Team] = PREVIOUS(Total Planned Daily Flight Distance, 0)

V Z Diff BW Total Flight Distance A Total Flight Capacity[Team] = Total Airplane Daily Flight Capacity - Total Planned Daily Flight Distance

V Total Available Seat Kms[Team] = (Market A Total Available Seat Kms + Market B Total Available Seat Kms + Market C Total Available Seat Kms + Market D Total Available Seat Kms + Market E Total Available Seat Kms) * X Days Of Operation In Quarter
V Total Available Seat Kms Previ[Team] = PREVIOUS(Total Available Seat Kms, 0)

V Total Revenue Passenger Kms[Team] = (Market A Total Revenue Passenger Kms + Market B Total Revenue Passenger Kms + Market C Total Revenue Passenger Kms + Market D Total Revenue Passenger Kms + Market E Total Revenue Passenger Kms) * X Days Of Operation In Quarter
V Total Revenue Passenger Kms Previ[Team] = PREVIOUS(Total Revenue Passenger Kms, 0)

V Total Passenger Load Factor[Team] = Total Revenue Passenger Kms / Total Available Seat Kms
V Total Passenger Load Factor Previ[Team] = PREVIOUS(Total Passenger Load Factor, 0)

V Total Available Seat Kms Airplane Model 1[Team] = (Market A Total Available Seat Kms Airplane Model 1 + Market B Total Available Seat Kms Airplane Model 1 + Market C Total Available Seat Kms Airplane Model 1 + Market D Total Available Seat Kms Airplane Model 1 + Market E Total Available Seat Kms Airplane Model 1) * Airplane Model 1 Seats
V Total Actual Seat Kms Airplane Model 1[Team] = Total Available Seat Kms Airplane Model 1 * X Reliability Variable
V Total Available Seat Kms Airplane Model 2[Team] = (Market A Total Available Seat Kms Airplane Model 2 + Market B Total Available Seat Kms Airplane Model 2 + Market C Total Available Seat Kms Airplane Model 2 + Market D Total Available Seat Kms Airplane Model 2 + Market E Total Available Seat Kms Airplane Model 2) * Airplane Model 2 Seats
V Total Actual Seat Kms Airplane Model 2[Team] = Total Available Seat Kms Airplane Model 2 * X Reliability Variable
V Total Available Seat Kms Airplane Model 3[Team] = (Market A Total Available Seat Kms Airplane Model 3 + Market B Total Available Seat Kms Airplane Model 3 + Market C Total Available Seat Kms Airplane Model 3 + Market D Total Available Seat Kms Airplane Model 3 + Market E Total Available Seat Kms Airplane Model 3) * Airplane Model 3 Seats
V Total Actual Seat Kms Airplane Model 3[Team] = Total Available Seat Kms Airplane Model 3 * X Reliability Variable
V Total Available Seat Kms Airplane Model 4[Team] = (Market A Total Available Seat Kms Airplane Model 4 + Market B Total Available Seat Kms Airplane Model 4 + Market C Total Available Seat Kms Airplane Model 4 + Market D Total Available Seat Kms Airplane Model 4 + Market E Total Available Seat Kms Airplane Model 4) * Airplane Model 4 Seats
V Total Actual Seat Kms Airplane Model 4[Team] = Total Available Seat Kms Airplane Model 4 * X Reliability Variable
V Total Available Seat Kms Airplane Model 5[Team] = (Market A Total Available Seat Kms Airplane Model 5 + Market B Total Available Seat Kms Airplane Model 5 + Market C Total Available Seat Kms Airplane Model 5 + Market D Total Available Seat Kms Airplane Model 5 + Market E Total Available Seat Kms Airplane Model 5) * Airplane Model 5 Seats
V Total Actual Seat Kms Airplane Model 5[Team] = Total Available Seat Kms Airplane Model 5 * X Reliability Variable
V Total Available Seat Kms Airplane Model 6[Team] = (Market A Total Available Seat Kms Airplane Model 6 + Market B Total Available Seat Kms Airplane Model 6 + Market C Total Available Seat Kms Airplane Model 6 + Market D Total Available Seat Kms Airplane Model 6 + Market E Total Available Seat Kms Airplane Model 6) * Airplane Model 6 Seats
V Total Actual Seat Kms Airplane Model 6[Team] = Total Available Seat Kms Airplane Model 6 * X Reliability Variable
V Total Available Seat Kms Airplane Model 7[Team] = (Market A Total Available Seat Kms Airplane Model 7 + Market B Total Available Seat Kms Airplane Model 7 + Market C Total Available Seat Kms Airplane Model 7 + Market D Total Available Seat Kms Airplane Model 7 + Market E Total Available Seat Kms Airplane Model 7) * Airplane Model 7 Seats
V Total Actual Seat Kms Airplane Model 7[Team] = Total Available Seat Kms Airplane Model 7 * X Reliability Variable

V Total Route Opening Expenses[Team] = Market A Opening Expenses + Market B Opening Expenses + Market C Opening Expenses + Market D Opening Expenses + Market E Opening Expenses
V Total Fuel Expenses For All Markets[Team] = (Market A Fuel Expenses + Market B Fuel Expenses + Market C Fuel Expenses + Market D Fuel Expenses + Market E Fuel Expenses) * X Days Of Operation In Quarter

V Total Final Sales[Team] = Market A Final Sales + Market B Final Sales + Market C Final Sales + Market D Final Sales + Market E Final Sales
V Total Final Seats Sold[Team] = Market A Final Sales / Market A Roundtrip Distance + Market B Final Sales / Market B Roundtrip Distance + Market C Final Sales / Market C Roundtrip Distance + Market D Final Sales / Market D Roundtrip Distance + Market E Final Sales / Market E Roundtrip Distance





V Airplane 1 Fleet Proposed Total Daily Trips[Team] = Airplane 1 Fleet Market A Total Trips + Airplane 1 Fleet Market B Total Trips + Airplane 1 Fleet Market C Total Trips + Airplane 1 Fleet Market D Total Trips + Airplane 1 Fleet Market E Total Trips
V Airplane 1 Warning[Team] = IF(Airplane 1 Fleet Proposed Total Daily Trips > Airplane Model 1 Available Daily Kms, 1 , 0)

V Airplane 2 Fleet Proposed Total Daily Trips[Team] = Airplane 2 Fleet Market A Total Trips + Airplane 2 Fleet Market B Total Trips + Airplane 2 Fleet Market C Total Trips + Airplane 2 Fleet Market D Total Trips + Airplane 2 Fleet Market E Total Trips
V Airplane 2 Warning[Team] = IF(Airplane 2 Fleet Proposed Total Daily Trips > Airplane Model 2 Available Daily Kms, 1 , 0)

V Airplane 3 Fleet Proposed Total Daily Trips[Team] = Airplane 3 Fleet Market A Total Trips + Airplane 3 Fleet Market B Total Trips + Airplane 3 Fleet Market C Total Trips + Airplane 3 Fleet Market D Total Trips + Airplane 3 Fleet Market E Total Trips
V Airplane 3 Warning[Team] = IF(Airplane 3 Fleet Proposed Total Daily Trips > Airplane Model 3 Available Daily Kms, 1 , 0)

V Airplane 4 Fleet Proposed Total Daily Trips[Team] = Airplane 4 Fleet Market A Total Trips + Airplane 4 Fleet Market B Total Trips + Airplane 4 Fleet Market C Total Trips + Airplane 4 Fleet Market D Total Trips + Airplane 4 Fleet Market E Total Trips
V Airplane 4 Warning[Team] = IF(Airplane 4 Fleet Proposed Total Daily Trips > Airplane Model 4 Available Daily Kms, 1 , 0)

V Airplane 5 Fleet Proposed Total Daily Trips[Team] = Airplane 5 Fleet Market A Total Trips + Airplane 5 Fleet Market B Total Trips + Airplane 5 Fleet Market C Total Trips + Airplane 5 Fleet Market D Total Trips + Airplane 5 Fleet Market E Total Trips
V Airplane 5 Warning[Team] = IF(Airplane 5 Fleet Proposed Total Daily Trips > Airplane Model 5 Available Daily Kms, 1 , 0)

V Airplane 6 Fleet Proposed Total Daily Trips[Team] = Airplane 6 Fleet Market A Total Trips + Airplane 6 Fleet Market B Total Trips + Airplane 6 Fleet Market C Total Trips + Airplane 6 Fleet Market D Total Trips + Airplane 6 Fleet Market E Total Trips
V Airplane 6 Warning[Team] = IF(Airplane 6 Fleet Proposed Total Daily Trips > Airplane Model 6 Available Daily Kms, 1 , 0)

V Airplane 7 Fleet Proposed Total Daily Trips[Team] = Airplane 7 Fleet Market A Total Trips + Airplane 7 Fleet Market B Total Trips + Airplane 7 Fleet Market C Total Trips + Airplane 7 Fleet Market D Total Trips + Airplane 7 Fleet Market E Total Trips
V Airplane 7 Warning[Team] = IF(Airplane 7 Fleet Proposed Total Daily Trips > Airplane Model 7 Available Daily Kms, 1 , 0)



##- CONSTANTS -##

V Route Const Opening New Route Expense = 17000

##### MARKET A #####

V Market A Roundtrip Distance = 677
V Market A Demand[3] = {PREVIOUS(Market A Demand[1] * 1.02, 600), PREVIOUS(Market A Demand[2] * 1.02, 1500), PREVIOUS(Market A Demand[3] * 1.02, 400)}

V Market A Total Available Seat Kms Airplane Model 1[Team] = Route A1 Airplane Model 1 Kms Flown Daily + Route A2 Airplane Model 1 Kms Flown Daily + Route A3 Airplane Model 1 Kms Flown Daily + Route A4 Airplane Model 1 Kms Flown Daily + Route A5 Airplane Model 1 Kms Flown Daily
V Market A Total Actual Seat Kms Airplane Model 1[Team] = Market A Total Available Seat Kms Airplane Model 1 * X Reliability Variable
V Market A Total Available Seat Kms Airplane Model 2[Team] = Route A1 Airplane Model 2 Kms Flown Daily + Route A2 Airplane Model 2 Kms Flown Daily + Route A3 Airplane Model 2 Kms Flown Daily + Route A4 Airplane Model 2 Kms Flown Daily + Route A5 Airplane Model 2 Kms Flown Daily
V Market A Total Actual Seat Kms Airplane Model 2[Team] = Market A Total Available Seat Kms Airplane Model 2 * X Reliability Variable
V Market A Total Available Seat Kms Airplane Model 3[Team] = Route A1 Airplane Model 3 Kms Flown Daily + Route A2 Airplane Model 3 Kms Flown Daily + Route A3 Airplane Model 3 Kms Flown Daily + Route A4 Airplane Model 3 Kms Flown Daily + Route A5 Airplane Model 3 Kms Flown Daily
V Market A Total Actual Seat Kms Airplane Model 3[Team] = Market A Total Available Seat Kms Airplane Model 3 * X Reliability Variable
V Market A Total Available Seat Kms Airplane Model 4[Team] = Route A1 Airplane Model 4 Kms Flown Daily + Route A2 Airplane Model 4 Kms Flown Daily + Route A3 Airplane Model 4 Kms Flown Daily + Route A4 Airplane Model 4 Kms Flown Daily + Route A5 Airplane Model 4 Kms Flown Daily
V Market A Total Actual Seat Kms Airplane Model 4[Team] = Market A Total Available Seat Kms Airplane Model 4 * X Reliability Variable
V Market A Total Available Seat Kms Airplane Model 5[Team] = Route A1 Airplane Model 5 Kms Flown Daily + Route A2 Airplane Model 5 Kms Flown Daily + Route A3 Airplane Model 5 Kms Flown Daily + Route A4 Airplane Model 5 Kms Flown Daily + Route A5 Airplane Model 5 Kms Flown Daily
V Market A Total Actual Seat Kms Airplane Model 5[Team] = Market A Total Available Seat Kms Airplane Model 5 * X Reliability Variable
V Market A Total Available Seat Kms Airplane Model 6[Team] = Route A1 Airplane Model 6 Kms Flown Daily + Route A2 Airplane Model 6 Kms Flown Daily + Route A3 Airplane Model 6 Kms Flown Daily + Route A4 Airplane Model 6 Kms Flown Daily + Route A5 Airplane Model 6 Kms Flown Daily
V Market A Total Actual Seat Kms Airplane Model 6[Team] = Market A Total Available Seat Kms Airplane Model 6 * X Reliability Variable
V Market A Total Available Seat Kms Airplane Model 7[Team] = Route A1 Airplane Model 7 Kms Flown Daily + Route A2 Airplane Model 7 Kms Flown Daily + Route A3 Airplane Model 7 Kms Flown Daily + Route A4 Airplane Model 7 Kms Flown Daily + Route A5 Airplane Model 7 Kms Flown Daily
V Market A Total Actual Seat Kms Airplane Model 7[Team] = Market A Total Available Seat Kms Airplane Model 7 * X Reliability Variable

V Market A Opening Expenses[Team] = Route A1 Opening Expense + Route A2 Opening Expense + Route A3 Opening Expense + Route A4 Opening Expense + Route A5 Opening Expense
V Market A Fuel Expenses[Team] = Route A1 Total Fuel Expenses + Route A2 Total Fuel Expenses + Route A3 Total Fuel Expenses + Route A4 Total Fuel Expenses + Route A5 Total Fuel Expenses

V Market A Total Available Seat Kms[Team] = Route A1 Available Seat Kms + Route A2 Available Seat Kms + Route A3 Available Seat Kms + Route A4 Available Seat Kms + Route A5 Available Seat Kms

V Market A Total Revenue Passenger Kms[Team] =  Route A1 Revenue Passenger Kms + Route A2 Revenue Passenger Kms + Route A3 Revenue Passenger Kms + Route A4 Revenue Passenger Kms + Route A5 Revenue Passenger Kms

V Market A Total Planned Daily Flight Distance[Team] = Route A1 Roundtrip Distance Planned + Route A2 Roundtrip Distance Planned + Route A3 Roundtrip Distance Planned + Route A4 Roundtrip Distance Planned + Route A5 Roundtrip Distance Planned

V Market A Final Sales[Team] = (Route A1 Final Sales + Route A2 Final Sales + Route A3 Final Sales + Route A4 Final Sales + Route A5 Final Sales) * Market A Roundtrip Distance


V Airplane 1 Fleet Market A Total Trips[Team] = (Route A1 Airplane Model 1 Proposed Trips + Route A2 Airplane Model 1 Proposed Trips + Route A3 Airplane Model 1 Proposed Trips + Route A4 Airplane Model 1 Proposed Trips + Route A5 Airplane Model 1 Proposed Trips) * Market A Roundtrip Distance
V Airplane 2 Fleet Market A Total Trips[Team] = (Route A1 Airplane Model 2 Proposed Trips + Route A2 Airplane Model 2 Proposed Trips + Route A3 Airplane Model 2 Proposed Trips + Route A4 Airplane Model 2 Proposed Trips + Route A5 Airplane Model 2 Proposed Trips) * Market A Roundtrip Distance
V Airplane 3 Fleet Market A Total Trips[Team] = (Route A1 Airplane Model 3 Proposed Trips + Route A2 Airplane Model 3 Proposed Trips + Route A3 Airplane Model 3 Proposed Trips + Route A4 Airplane Model 3 Proposed Trips + Route A5 Airplane Model 3 Proposed Trips) * Market A Roundtrip Distance
V Airplane 4 Fleet Market A Total Trips[Team] = (Route A1 Airplane Model 4 Proposed Trips + Route A2 Airplane Model 4 Proposed Trips + Route A3 Airplane Model 4 Proposed Trips + Route A4 Airplane Model 4 Proposed Trips + Route A5 Airplane Model 4 Proposed Trips) * Market A Roundtrip Distance
V Airplane 5 Fleet Market A Total Trips[Team] = (Route A1 Airplane Model 5 Proposed Trips + Route A2 Airplane Model 5 Proposed Trips + Route A3 Airplane Model 5 Proposed Trips + Route A4 Airplane Model 5 Proposed Trips + Route A5 Airplane Model 5 Proposed Trips) * Market A Roundtrip Distance
V Airplane 6 Fleet Market A Total Trips[Team] = (Route A1 Airplane Model 6 Proposed Trips + Route A2 Airplane Model 6 Proposed Trips + Route A3 Airplane Model 6 Proposed Trips + Route A4 Airplane Model 6 Proposed Trips + Route A5 Airplane Model 6 Proposed Trips) * Market A Roundtrip Distance
V Airplane 7 Fleet Market A Total Trips[Team] = (Route A1 Airplane Model 7 Proposed Trips + Route A2 Airplane Model 7 Proposed Trips + Route A3 Airplane Model 7 Proposed Trips + Route A4 Airplane Model 7 Proposed Trips + Route A5 Airplane Model 7 Proposed Trips) * Market A Roundtrip Distance



# Planned Trips #
V Airplane 1 Fleet Market A Total Planned Trips[Team] = (Route A1 Airplane Model 1 Trips + Route A2 Airplane Model 1 Trips + Route A3 Airplane Model 1 Trips + Route A4 Airplane Model 1 Trips + Route A5 Airplane Model 1 Trips) * Market A Roundtrip Distance
V Airplane 2 Fleet Market A Total Planned Trips[Team] = (Route A1 Airplane Model 2 Trips + Route A2 Airplane Model 2 Trips + Route A3 Airplane Model 2 Trips + Route A4 Airplane Model 2 Trips + Route A5 Airplane Model 2 Trips) * Market A Roundtrip Distance
V Airplane 3 Fleet Market A Total Planned Trips[Team] = (Route A1 Airplane Model 3 Trips + Route A2 Airplane Model 3 Trips + Route A3 Airplane Model 3 Trips + Route A4 Airplane Model 3 Trips + Route A5 Airplane Model 3 Trips) * Market A Roundtrip Distance
V Airplane 4 Fleet Market A Total Planned Trips[Team] = (Route A1 Airplane Model 4 Trips + Route A2 Airplane Model 4 Trips + Route A3 Airplane Model 4 Trips + Route A4 Airplane Model 4 Trips + Route A5 Airplane Model 4 Trips) * Market A Roundtrip Distance
V Airplane 5 Fleet Market A Total Planned Trips[Team] = (Route A1 Airplane Model 5 Trips + Route A2 Airplane Model 5 Trips + Route A3 Airplane Model 5 Trips + Route A4 Airplane Model 5 Trips + Route A5 Airplane Model 5 Trips) * Market A Roundtrip Distance
V Airplane 6 Fleet Market A Total Planned Trips[Team] = (Route A1 Airplane Model 6 Trips + Route A2 Airplane Model 6 Trips + Route A3 Airplane Model 6 Trips + Route A4 Airplane Model 6 Trips + Route A5 Airplane Model 6 Trips) * Market A Roundtrip Distance
V Airplane 7 Fleet Market A Total Planned Trips[Team] = (Route A1 Airplane Model 7 Trips + Route A2 Airplane Model 7 Trips + Route A3 Airplane Model 7 Trips + Route A4 Airplane Model 7 Trips + Route A5 Airplane Model 7 Trips) * Market A Roundtrip Distance


### Route A1 ###

#V Route A1 Roundtrip Distance = 832

V Route A1 Roundtrip Distance Planned[Team] = Market A Roundtrip Distance * IF(Route A1 Online = 1,Route A1 Return Trips, 0)

## Route A1 Establishment ##

#V Route A1 Demand[3] = {PREVIOUS(Route A1 Demand[1] * 1.02, 800), PREVIOUS(Route A1 Demand[2] * 1.02, 1000), PREVIOUS(Route A1 Demand[3] * 1.02, 700)}
V Route A1 Demand For Teams[3] = {Market A Demand[1] + ((SQRT(Market A Demand[1] / 10 * Route A1 Num Of Teams[1])) * 10), Market A Demand[2] + ((SQRT(Market A Demand[2] / 10 * Route A1 Num Of Teams[2])) * 10), Market A Demand[3] + ((SQRT(Market A Demand[3] / 10 * Route A1 Num Of Teams[3])) * 10)}
D Route A1 Online[Team] = 1
P Route A1 Online.ExecuteDecisionImmediately = true

V Route A1 Online Economy[Team] = IF(Route A1 Online = 1 & Price Structure = 1, 1, 0)
V Route A1 Online Normal[Team] = IF(Route A1 Online = 1 & Price Structure = 2, 1, 0)
V Route A1 Online Luxury[Team] = IF(Route A1 Online = 1 & Price Structure = 3, 1, 0)

V Route A1 First Quarter Online[Team] = REMEMBER((Route A1 Online = 1) & (PREVIOUS(Route A1 Online) = 0), STEP)
V Route A1 Number Of Quarters Online[Team] = IF(Route A1 Online = 1, STEP - Route A1 First Quarter Online + 1, 0)
V Route A1 Num Of Teams[3] = {ARRAYSUM(Route A1 Online Economy), ARRAYSUM(Route A1 Online Normal), ARRAYSUM(Route A1 Online Luxury)}

#V Route A1 Norm Quarters[Team] = 0 + IF(Route A1 Norm Online = 1, 1, (-1) * Route A1 Norm Quarters Mirror)
#V Route A1 Norm Quarters Mirror[Team] = Route A1 Norm Quarters
#P Route A1 Norm Quarters Mirror.ExecuteDecisionImmediately = false

V Route A1 Attractiveness[Team] = IF(Route A1 Number Of Quarters Online = 1, 1, SQRT(Route A1 Number Of Quarters Online) + Route A1 Number Of Quarters Online)

V Route A1 Attractiveness Economy[Team] = IF(Route A1 Online = 1 & Price Structure = 1, Route A1 Attractiveness, 0)
V Route A1 Attractiveness Normal[Team] = IF(Route A1 Online = 1 & Price Structure = 2, Route A1 Attractiveness, 0)
V Route A1 Attractiveness Luxury[Team] = IF(Route A1 Online = 1 & Price Structure = 3, Route A1 Attractiveness, 0)

V Route A1 Market Share[Team] = (Route A1 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route A1 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route A1 Attractiveness Normal), ARRAYSUM(Route A1 Attractiveness Luxury))))
V Route A1 Total Market Share[Team] = IF(Route A1 Online = 0, 0, (0.5 * Route A1 Market Share ) + (0.2 * Route A1 Return Trips Market Share) + (0.3 * Route A1 Price Overall Market Share))
V Route A1 Market Share For Customers[Team] = Route A1 Total Market Share * (IF(Price Structure = 1, Route A1 Demand For Teams[1], IF(Price Structure = 2, Route A1 Demand For Teams[2], Route A1 Demand For Teams[3])))

V Route A1 Sales[Team] = Route A1 Total Market Share * (IF(Price Structure = 1, Route A1 Demand For Teams[1], IF(Price Structure = 2, Route A1 Demand For Teams[2], Route A1 Demand For Teams[3])))

V Route A1 Final Sales[Team] = IF(Route A1 Sales > Route A1 Seat Supply, Route A1 Seat Supply, Route A1 Sales)

V Route A1 Revenue Passenger Kms[Team] = Route A1 Final Sales * Market A Roundtrip Distance

## Route Trips ##
D Route A1 Return Trips[Team] = 4
P Route A1 Return Trips.ExecuteDecisionImmediately = true
V Route A1 Return Trips Previ[Team] = PREVIOUS(Route A5 Return Trips, 0)
V Route A1 Return Trips Sensitivity = 1.5

V Route A1 Average Number Of Trips = IF(ARRAYSUM(Route A1 Online) = 0, 0, ARRAYSUM(Route A1 Return Trips) / ARRAYSUM(Route A1 Online))
V Route A1 Average Number Of Trips Previ = PREVIOUS(Route A1 Average Number Of Trips, 0)

V Route A1 Return Trips Economy[Team] = IF(Route A1 Online = 1 & Price Structure = 1, Route A1 Return Trips, 0)
V Route A1 Return Trips Normal[Team] = IF(Route A1 Online = 1 & Price Structure = 2, Route A1 Return Trips, 0)
V Route A1 Return Trips Luxury[Team] = IF(Route A1 Online = 1 & Price Structure = 3, Route A1 Return Trips, 0)

V Route A1 Return Trips Attractiveness[Team] = (Route A1 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route A1 Return Trips Economy) / Route A1 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route A1 Return Trips Normal) / Route A1 Num Of Teams[2], ARRAYSUM(Route A1 Return Trips Luxury) / Route A1 Num Of Teams[3]))) ^ Route A1 Return Trips Sensitivity

V Route A1 Return Trips Attractiveness Economy[Team] = IF(Route A1 Online = 1 & Price Structure = 1, Route A1 Return Trips Attractiveness, 0)
V Route A1 Return Trips Attractiveness Normal[Team] = IF(Route A1 Online = 1 & Price Structure = 2, Route A1 Return Trips Attractiveness, 0)
V Route A1 Return Trips Attractiveness Luxury[Team] = IF(Route A1 Online = 1 & Price Structure = 3, Route A1 Return Trips Attractiveness, 0)

V Route A1 Return Trips Market Share[Team] = (Route A1 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route A1 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route A1 Return Trips Attractiveness Normal), ARRAYSUM(Route A1 Return Trips Attractiveness Luxury))))

V Route A1 Seat Supply[Team] = Route A1 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route A1 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route A1 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route A1 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route A1 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route A1 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route A1 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route A1 Available Seat Kms[Team] = Route A1 Seat Supply * Market A Roundtrip Distance

# Route Trips By Plane #

V Route A1 Total Airplane Kms Planned[Team] = Route A1 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route A1 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route A1 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route A1 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route A1 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route A1 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route A1 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route A1 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route A1 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route A1 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route A1 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route A1 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route A1 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route A1 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route A1 Airplane Model 7 Trips)
V Z Route A1 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route A1 Return Trips - Route A1 Total Plane Trips Scheduled

D Route A1 Airplane Model 1 Trips[Team] = 4
P Route A1 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route A1 Airplane Model 1 Proposed Trips[Team] = IF(Route A1 Online = 0, 0, Route A1 Airplane Model 1 Trips)
V Route A1 Airplane Model 1 Actual Trips[Team] = IF(Route A1 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route A1 Airplane Model 1 Trips))
V Route A1 Airplane Model 1 Kms Flown Daily[Team] = Route A1 Airplane Model 1 Actual Trips * Market A Roundtrip Distance

D Route A1 Airplane Model 2 Trips[Team] = 0
P Route A1 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route A1 Airplane Model 2 Proposed Trips[Team] = IF(Route A1 Online = 0, 0, Route A1 Airplane Model 2 Trips)
V Route A1 Airplane Model 2 Actual Trips[Team] = IF(Route A1 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route A1 Airplane Model 2 Trips))
V Route A1 Airplane Model 2 Kms Flown Daily[Team] = Route A1 Airplane Model 2 Actual Trips * Market A Roundtrip Distance

D Route A1 Airplane Model 3 Trips[Team] = 0
P Route A1 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route A1 Airplane Model 3 Proposed Trips[Team] = IF(Route A1 Online = 0, 0, Route A1 Airplane Model 3 Trips)
V Route A1 Airplane Model 3 Actual Trips[Team] = IF(Route A1 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route A1 Airplane Model 3 Trips))
V Route A1 Airplane Model 3 Kms Flown Daily[Team] = Route A1 Airplane Model 3 Actual Trips * Market A Roundtrip Distance

D Route A1 Airplane Model 4 Trips[Team] = 0
P Route A1 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route A1 Airplane Model 4 Proposed Trips[Team] = IF(Route A1 Online = 0, 0, Route A1 Airplane Model 4 Trips)
V Route A1 Airplane Model 4 Actual Trips[Team] = IF(Route A1 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route A1 Airplane Model 4 Trips))
V Route A1 Airplane Model 4 Kms Flown Daily[Team] = Route A1 Airplane Model 4 Actual Trips * Market A Roundtrip Distance

D Route A1 Airplane Model 5 Trips[Team] = 0
P Route A1 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route A1 Airplane Model 5 Proposed Trips[Team] = IF(Route A1 Online = 0, 0, Route A1 Airplane Model 5 Trips)
V Route A1 Airplane Model 5 Actual Trips[Team] = IF(Route A1 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route A1 Airplane Model 5 Trips))
V Route A1 Airplane Model 5 Kms Flown Daily[Team] = Route A1 Airplane Model 5 Actual Trips * Market A Roundtrip Distance

D Route A1 Airplane Model 6 Trips[Team] = 0
P Route A1 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route A1 Airplane Model 6 Proposed Trips[Team] = IF(Route A1 Online = 0, 0, Route A1 Airplane Model 6 Trips)
V Route A1 Airplane Model 6 Actual Trips[Team] = IF(Route A1 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route A1 Airplane Model 6 Trips))
V Route A1 Airplane Model 6 Kms Flown Daily[Team] = Route A1 Airplane Model 6 Actual Trips * Market A Roundtrip Distance

D Route A1 Airplane Model 7 Trips[Team] = 0
P Route A1 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route A1 Airplane Model 7 Proposed Trips[Team] = IF(Route A1 Online = 0, 0, Route A1 Airplane Model 7 Trips)
V Route A1 Airplane Model 7 Actual Trips[Team] = IF(Route A1 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route A1 Airplane Model 7 Trips))
V Route A1 Airplane Model 7 Kms Flown Daily[Team] = Route A1 Airplane Model 7 Actual Trips * Market A Roundtrip Distance

## Route Pricing ##
V Route A1 Price Economy Number Of Teams[Team] = IF(Route A1 Online = 1 & Price Structure = 1, 1, 0)
V Route A1 Price Normal Number Of Teams[Team] = IF(Route A1 Online = 1 & Price Structure = 2, 1, 0)
V Route A1 Price Luxury Number Of Teams[Team] = IF(Route A1 Online = 1 & Price Structure = 3, 1, 0)

V Route A1 Price Sensitivity Economy = 1.001
V Route A1 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route A1 Price Economy Number Of Teams)) / Price Economy) ^ Route A1 Price Sensitivity Economy)
V Route A1 Price Market Share Economy[Team] = (Route A1 Price Attractiveness Economy / ARRAYSUM(Route A1 Price Attractiveness Economy))

V Route A1 Middling of Price[Team] = IF(Route A1 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route A1 Price Normal Number Of Teams)) - 0.12)), 0)
V Route A1 Price Sensitivity Normal = 1.5
V Route A1 Price Attractiveness Normal[Team] = (ARRAYAVG(Route A1 Middling of Price) / Route A1 Middling of Price) ^ Route A1 Price Sensitivity Normal
V Route A1 Price Market Share Normal[Team] = (Route A1 Price Attractiveness Normal / ARRAYSUM(Route A1 Price Attractiveness Normal))

V Route A1 Price Sensitivity Luxury = 1.001
V Route A1 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route A1 Price Luxury Number Of Teams))) ^ Route A1 Price Sensitivity Luxury)
V Route A1 Price Market Share Luxury[Team] = (Route A1 Price Attractiveness Luxury / ARRAYSUM(Route A1 Price Attractiveness Luxury))

V Route A1 Price Overall Market Share[Team] = IF(Price Structure = 1, Route A1 Price Market Share Economy, IF(Price Structure = 2, Route A1 Price Market Share Normal, Route A1 Price Market Share Luxury))

## Route Expenses ##

V Route A1 Opening Expense[Team] = IF(PREVIOUS(Route A1 Online = 0) & Route A1 Online = 1, Route Const Opening New Route Expense, 0) 

V Route A1 Fuel Expenses Airplane Model 1[Team] = Route A1 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route A1 Fuel Expenses Airplane Model 2[Team] = Route A1 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route A1 Fuel Expenses Airplane Model 3[Team] = Route A1 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route A1 Fuel Expenses Airplane Model 4[Team] = Route A1 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route A1 Fuel Expenses Airplane Model 5[Team] = Route A1 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route A1 Fuel Expenses Airplane Model 6[Team] = Route A1 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route A1 Fuel Expenses Airplane Model 7[Team] = Route A1 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route A1 Total Fuel Expenses[Team] = Route A1 Fuel Expenses Airplane Model 1 + Route A1 Fuel Expenses Airplane Model 2 + Route A1 Fuel Expenses Airplane Model 3 + Route A1 Fuel Expenses Airplane Model 4 + Route A1 Fuel Expenses Airplane Model 5 + Route A1 Fuel Expenses Airplane Model 6 + Route A1 Fuel Expenses Airplane Model 7 

### Route A2 ###

V Route A2 Roundtrip Distance Planned[Team] = Market A Roundtrip Distance * IF(Route A2 Online = 1,Route A2 Return Trips, 0)

## Route A2 Establishment ########
V Route A2 Demand For Teams[3] = {Market A Demand[1] + ((SQRT(Market A Demand[1] / 10 * Route A2 Num Of Teams[1])) * 10), Market A Demand[2] + ((SQRT(Market A Demand[2] / 10 * Route A2 Num Of Teams[2])) * 10), Market A Demand[3] + ((SQRT(Market A Demand[3] / 10 * Route A2 Num Of Teams[3])) * 10)}
D Route A2 Online[Team] = 1
P Route A2 Online.ExecuteDecisionImmediately = true

#V Route A2 Opening Expense[Team] = IF(PREVIOUS(Route A2 Online = 0) & Route A2 Online = 1, Route Const Opening New Route Expense, 0) 

V Route A2 Online Economy[Team] = IF(Route A2 Online = 1 & Price Structure = 1, 1, 0)
V Route A2 Online Normal[Team] = IF(Route A2 Online = 1 & Price Structure = 2, 1, 0)
V Route A2 Online Luxury[Team] = IF(Route A2 Online = 1 & Price Structure = 3, 1, 0)

V Route A2 First Quarter Online[Team] = REMEMBER((Route A2 Online = 1) & (PREVIOUS(Route A2 Online) = 0), STEP)
V Route A2 Number Of Quarters Online[Team] = IF(Route A2 Online = 1, STEP - Route A2 First Quarter Online + 1, 0)
V Route A2 Num Of Teams[3] = {ARRAYSUM(Route A2 Online Economy), ARRAYSUM(Route A2 Online Normal), ARRAYSUM(Route A2 Online Luxury)}

V Route A2 Attractiveness[Team] = IF(Route A2 Number Of Quarters Online = 1, 1, SQRT(Route A2 Number Of Quarters Online) + Route A2 Number Of Quarters Online)

V Route A2 Attractiveness Economy[Team] = IF(Route A2 Online = 1 & Price Structure = 1, Route A2 Attractiveness, 0)
V Route A2 Attractiveness Normal[Team] = IF(Route A2 Online = 1 & Price Structure = 2, Route A2 Attractiveness, 0)
V Route A2 Attractiveness Luxury[Team] = IF(Route A2 Online = 1 & Price Structure = 3, Route A2 Attractiveness, 0)

V Route A2 Market Share[Team] = (Route A2 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route A2 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route A2 Attractiveness Normal), ARRAYSUM(Route A2 Attractiveness Luxury))))
V Route A2 Total Market Share[Team] = IF(Route A2 Online = 0, 0, (0.5 * Route A2 Market Share ) + (0.2 * Route A2 Return Trips Market Share) + (0.3 * Route A2 Price Overall Market Share))
V Route A2 Market Share For Customers[Team] = Route A2 Total Market Share * (IF(Price Structure = 1, Route A2 Demand For Teams[1], IF(Price Structure = 2, Route A2 Demand For Teams[2], Route A2 Demand For Teams[3])))

V Route A2 Sales[Team] = Route A2 Total Market Share * (IF(Price Structure = 1, Route A2 Demand For Teams[1], IF(Price Structure = 2, Route A2 Demand For Teams[2], Route A2 Demand For Teams[3])))

V Route A2 Final Sales[Team] = IF(Route A2 Sales > Route A2 Seat Supply, Route A2 Seat Supply, Route A2 Sales)

V Route A2 Revenue Passenger Kms[Team] = Route A2 Final Sales * Market A Roundtrip Distance

# Route Trips
D Route A2 Return Trips[Team] = 4
P Route A2 Return Trips.ExecuteDecisionImmediately = true
V Route A2 Return Trips Previ[Team] = PREVIOUS(Route A5 Return Trips, 0)
V Route A2 Return Trips Sensitivity = 1.5

V Route A2 Average Number Of Trips = IF(ARRAYSUM(Route A2 Online) = 0, 0, ARRAYSUM(Route A2 Return Trips) / ARRAYSUM(Route A2 Online))
V Route A2 Average Number Of Trips Previ = PREVIOUS(Route A2 Average Number Of Trips, 0)

V Route A2 Return Trips Economy[Team] = IF(Route A2 Online = 1 & Price Structure = 1, Route A2 Return Trips, 0)
V Route A2 Return Trips Normal[Team] = IF(Route A2 Online = 1 & Price Structure = 2, Route A2 Return Trips, 0)
V Route A2 Return Trips Luxury[Team] = IF(Route A2 Online = 1 & Price Structure = 3, Route A2 Return Trips, 0)

V Route A2 Return Trips Attractiveness[Team] = (Route A2 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route A2 Return Trips Economy) / Route A2 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route A2 Return Trips Normal) / Route A2 Num Of Teams[2], ARRAYSUM(Route A2 Return Trips Luxury) / Route A2 Num Of Teams[3]))) ^ Route A2 Return Trips Sensitivity

V Route A2 Return Trips Attractiveness Economy[Team] = IF(Route A2 Online = 1 & Price Structure = 1, Route A2 Return Trips Attractiveness, 0)
V Route A2 Return Trips Attractiveness Normal[Team] = IF(Route A2 Online = 1 & Price Structure = 2, Route A2 Return Trips Attractiveness, 0)
V Route A2 Return Trips Attractiveness Luxury[Team] = IF(Route A2 Online = 1 & Price Structure = 3, Route A2 Return Trips Attractiveness, 0)

V Route A2 Return Trips Market Share[Team] = (Route A2 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route A2 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route A2 Return Trips Attractiveness Normal), ARRAYSUM(Route A2 Return Trips Attractiveness Luxury))))

V Route A2 Seat Supply[Team] = Route A2 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route A2 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route A2 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route A2 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route A2 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route A2 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route A2 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route A2 Available Seat Kms[Team] = Route A2 Seat Supply * Market A Roundtrip Distance

# Route Trips By Plane #

V Route A2 Total Airplane Kms Planned[Team] = Route A2 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route A2 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route A2 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route A2 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route A2 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route A2 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route A2 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route A2 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route A2 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route A2 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route A2 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route A2 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route A2 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route A2 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route A2 Airplane Model 7 Trips)
V Z Route A2 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route A2 Return Trips - Route A2 Total Plane Trips Scheduled

D Route A2 Airplane Model 1 Trips[Team] = 4
P Route A2 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route A2 Airplane Model 1 Proposed Trips[Team] = IF(Route A2 Online = 0, 0, Route A2 Airplane Model 1 Trips)
V Route A2 Airplane Model 1 Actual Trips[Team] = IF(Route A2 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route A2 Airplane Model 1 Trips))
V Route A2 Airplane Model 1 Kms Flown Daily[Team] = Route A2 Airplane Model 1 Actual Trips * Market A Roundtrip Distance

D Route A2 Airplane Model 2 Trips[Team] = 0
P Route A2 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route A2 Airplane Model 2 Proposed Trips[Team] = IF(Route A2 Online = 0, 0, Route A2 Airplane Model 2 Trips)
V Route A2 Airplane Model 2 Actual Trips[Team] = IF(Route A2 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route A2 Airplane Model 2 Trips))
V Route A2 Airplane Model 2 Kms Flown Daily[Team] = Route A2 Airplane Model 2 Actual Trips * Market A Roundtrip Distance

D Route A2 Airplane Model 3 Trips[Team] = 0
P Route A2 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route A2 Airplane Model 3 Proposed Trips[Team] = IF(Route A2 Online = 0, 0, Route A2 Airplane Model 3 Trips)
V Route A2 Airplane Model 3 Actual Trips[Team] = IF(Route A2 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route A2 Airplane Model 3 Trips))
V Route A2 Airplane Model 3 Kms Flown Daily[Team] = Route A2 Airplane Model 3 Actual Trips * Market A Roundtrip Distance

D Route A2 Airplane Model 4 Trips[Team] = 0
P Route A2 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route A2 Airplane Model 4 Proposed Trips[Team] = IF(Route A2 Online = 0, 0, Route A2 Airplane Model 4 Trips)
V Route A2 Airplane Model 4 Actual Trips[Team] = IF(Route A2 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route A2 Airplane Model 4 Trips))
V Route A2 Airplane Model 4 Kms Flown Daily[Team] = Route A2 Airplane Model 4 Actual Trips * Market A Roundtrip Distance

D Route A2 Airplane Model 5 Trips[Team] = 0
P Route A2 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route A2 Airplane Model 5 Proposed Trips[Team] = IF(Route A2 Online = 0, 0, Route A2 Airplane Model 5 Trips)
V Route A2 Airplane Model 5 Actual Trips[Team] = IF(Route A2 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route A2 Airplane Model 5 Trips))
V Route A2 Airplane Model 5 Kms Flown Daily[Team] = Route A2 Airplane Model 5 Actual Trips * Market A Roundtrip Distance

D Route A2 Airplane Model 6 Trips[Team] = 0
P Route A2 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route A2 Airplane Model 6 Proposed Trips[Team] = IF(Route A2 Online = 0, 0, Route A2 Airplane Model 6 Trips)
V Route A2 Airplane Model 6 Actual Trips[Team] = IF(Route A2 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route A2 Airplane Model 6 Trips))
V Route A2 Airplane Model 6 Kms Flown Daily[Team] = Route A2 Airplane Model 6 Actual Trips * Market A Roundtrip Distance

D Route A2 Airplane Model 7 Trips[Team] = 0
P Route A2 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route A2 Airplane Model 7 Proposed Trips[Team] = IF(Route A2 Online = 0, 0, Route A2 Airplane Model 7 Trips)
V Route A2 Airplane Model 7 Actual Trips[Team] = IF(Route A2 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route A2 Airplane Model 7 Trips))
V Route A2 Airplane Model 7 Kms Flown Daily[Team] = Route A2 Airplane Model 7 Actual Trips * Market A Roundtrip Distance


## Route Pricing ##

V Route A2 Price Economy Number Of Teams[Team] = IF(Route A2 Online = 1 & Price Structure = 1, 1, 0)
V Route A2 Price Normal Number Of Teams[Team] = IF(Route A2 Online = 1 & Price Structure = 2, 1, 0)
V Route A2 Price Luxury Number Of Teams[Team] = IF(Route A2 Online = 1 & Price Structure = 3, 1, 0)

V Route A2 Price Sensitivity Economy = 1.001
V Route A2 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route A2 Price Economy Number Of Teams)) / Price Economy) ^ Route A2 Price Sensitivity Economy)
V Route A2 Price Market Share Economy[Team] = (Route A2 Price Attractiveness Economy / ARRAYSUM(Route A2 Price Attractiveness Economy))

V Route A2 Middling of Price[Team] = IF(Route A2 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route A2 Price Normal Number Of Teams)) - 0.12)), 0)
V Route A2 Price Sensitivity Normal = 1.5
V Route A2 Price Attractiveness Normal[Team] = (ARRAYAVG(Route A2 Middling of Price) / Route A2 Middling of Price) ^ Route A2 Price Sensitivity Normal
V Route A2 Price Market Share Normal[Team] = (Route A2 Price Attractiveness Normal / ARRAYSUM(Route A2 Price Attractiveness Normal))

V Route A2 Price Sensitivity Luxury = 1.001
V Route A2 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route A2 Price Luxury Number Of Teams))) ^ Route A2 Price Sensitivity Luxury)
V Route A2 Price Market Share Luxury[Team] = (Route A2 Price Attractiveness Luxury / ARRAYSUM(Route A2 Price Attractiveness Luxury))

V Route A2 Price Overall Market Share[Team] = IF(Price Structure = 1, Route A2 Price Market Share Economy, IF(Price Structure = 2, Route A2 Price Market Share Normal, Route A2 Price Market Share Luxury))

## Route Expenses ##

V Route A2 Opening Expense[Team] = IF(PREVIOUS(Route A2 Online = 0) & Route A2 Online = 1, Route Const Opening New Route Expense, 0) 

V Route A2 Fuel Expenses Airplane Model 1[Team] = Route A2 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route A2 Fuel Expenses Airplane Model 2[Team] = Route A2 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route A2 Fuel Expenses Airplane Model 3[Team] = Route A2 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route A2 Fuel Expenses Airplane Model 4[Team] = Route A2 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route A2 Fuel Expenses Airplane Model 5[Team] = Route A2 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route A2 Fuel Expenses Airplane Model 6[Team] = Route A2 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route A2 Fuel Expenses Airplane Model 7[Team] = Route A2 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route A2 Total Fuel Expenses[Team] = Route A2 Fuel Expenses Airplane Model 1 + Route A2 Fuel Expenses Airplane Model 2 + Route A2 Fuel Expenses Airplane Model 3 + Route A2 Fuel Expenses Airplane Model 4 + Route A2 Fuel Expenses Airplane Model 5 + Route A2 Fuel Expenses Airplane Model 6 + Route A2 Fuel Expenses Airplane Model 7 


### Route A3 ###

V Route A3 Roundtrip Distance Planned[Team] = Market A Roundtrip Distance * IF(Route A3 Online = 1,Route A3 Return Trips, 0)

## Route A3 Establishment ########
V Route A3 Demand For Teams[3] = {Market A Demand[1] + ((SQRT(Market A Demand[1] / 10 * Route A3 Num Of Teams[1])) * 10), Market A Demand[2] + ((SQRT(Market A Demand[2] / 10 * Route A3 Num Of Teams[2])) * 10), Market A Demand[3] + ((SQRT(Market A Demand[3] / 10 * Route A3 Num Of Teams[3])) * 10)}
D Route A3 Online[Team] = 1
P Route A3 Online.ExecuteDecisionImmediately = true

#V Route A3 Opening Expense[Team] = IF(PREVIOUS(Route A3 Online = 0) & Route A3 Online = 1, Route Const Opening New Route Expense, 0) 

V Route A3 Online Economy[Team] = IF(Route A3 Online = 1 & Price Structure = 1, 1, 0)
V Route A3 Online Normal[Team] = IF(Route A3 Online = 1 & Price Structure = 2, 1, 0)
V Route A3 Online Luxury[Team] = IF(Route A3 Online = 1 & Price Structure = 3, 1, 0)

V Route A3 First Quarter Online[Team] = REMEMBER((Route A3 Online = 1) & (PREVIOUS(Route A3 Online) = 0), STEP)
V Route A3 Number Of Quarters Online[Team] = IF(Route A3 Online = 1, STEP - Route A3 First Quarter Online + 1, 0)
V Route A3 Num Of Teams[3] = {ARRAYSUM(Route A3 Online Economy), ARRAYSUM(Route A3 Online Normal), ARRAYSUM(Route A3 Online Luxury)}

V Route A3 Attractiveness[Team] = IF(Route A3 Number Of Quarters Online = 1, 1, SQRT(Route A3 Number Of Quarters Online) + Route A3 Number Of Quarters Online)

V Route A3 Attractiveness Economy[Team] = IF(Route A3 Online = 1 & Price Structure = 1, Route A3 Attractiveness, 0)
V Route A3 Attractiveness Normal[Team] = IF(Route A3 Online = 1 & Price Structure = 2, Route A3 Attractiveness, 0)
V Route A3 Attractiveness Luxury[Team] = IF(Route A3 Online = 1 & Price Structure = 3, Route A3 Attractiveness, 0)

V Route A3 Market Share[Team] = (Route A3 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route A3 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route A3 Attractiveness Normal), ARRAYSUM(Route A3 Attractiveness Luxury))))
V Route A3 Total Market Share[Team] = IF(Route A3 Online = 0, 0, (0.5 * Route A3 Market Share ) + (0.2 * Route A3 Return Trips Market Share) + (0.3 * Route A3 Price Overall Market Share))
V Route A3 Market Share For Customers[Team] = Route A3 Total Market Share * (IF(Price Structure = 1, Route A3 Demand For Teams[1], IF(Price Structure = 2, Route A3 Demand For Teams[2], Route A3 Demand For Teams[3])))

V Route A3 Sales[Team] = Route A3 Total Market Share * (IF(Price Structure = 1, Route A3 Demand For Teams[1], IF(Price Structure = 2, Route A3 Demand For Teams[2], Route A3 Demand For Teams[3])))

V Route A3 Final Sales[Team] = IF(Route A3 Sales > Route A3 Seat Supply, Route A3 Seat Supply, Route A3 Sales)

V Route A3 Revenue Passenger Kms[Team] = Route A3 Final Sales * Market A Roundtrip Distance

# Route Trips
D Route A3 Return Trips[Team] = 4
P Route A3 Return Trips.ExecuteDecisionImmediately = true
V Route A3 Return Trips Previ[Team] = PREVIOUS(Route A3 Return Trips, 0)
V Route A3 Return Trips Sensitivity = 1.5

V Route A3 Average Number Of Trips = IF(ARRAYSUM(Route A3 Online) = 0, 0, ARRAYSUM(Route A3 Return Trips) / ARRAYSUM(Route A3 Online))
V Route A3 Average Number Of Trips Previ = PREVIOUS(Route A3 Average Number Of Trips, 0)

V Route A3 Return Trips Economy[Team] = IF(Route A3 Online = 1 & Price Structure = 1, Route A3 Return Trips, 0)
V Route A3 Return Trips Normal[Team] = IF(Route A3 Online = 1 & Price Structure = 2, Route A3 Return Trips, 0)
V Route A3 Return Trips Luxury[Team] = IF(Route A3 Online = 1 & Price Structure = 3, Route A3 Return Trips, 0)

V Route A3 Return Trips Attractiveness[Team] = (Route A3 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route A3 Return Trips Economy) / Route A3 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route A3 Return Trips Normal) / Route A3 Num Of Teams[2], ARRAYSUM(Route A3 Return Trips Luxury) / Route A3 Num Of Teams[3]))) ^ Route A3 Return Trips Sensitivity

V Route A3 Return Trips Attractiveness Economy[Team] = IF(Route A3 Online = 1 & Price Structure = 1, Route A3 Return Trips Attractiveness, 0)
V Route A3 Return Trips Attractiveness Normal[Team] = IF(Route A3 Online = 1 & Price Structure = 2, Route A3 Return Trips Attractiveness, 0)
V Route A3 Return Trips Attractiveness Luxury[Team] = IF(Route A3 Online = 1 & Price Structure = 3, Route A3 Return Trips Attractiveness, 0)

V Route A3 Return Trips Market Share[Team] = (Route A3 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route A3 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route A3 Return Trips Attractiveness Normal), ARRAYSUM(Route A3 Return Trips Attractiveness Luxury))))

V Route A3 Seat Supply[Team] = Route A3 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route A3 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route A3 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route A3 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route A3 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route A3 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route A3 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route A3 Available Seat Kms[Team] = Route A3 Seat Supply * Market A Roundtrip Distance

# Route Trips By Plane #

V Route A3 Total Airplane Kms Planned[Team] = Route A3 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route A3 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route A3 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route A3 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route A3 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route A3 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route A3 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route A3 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route A3 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route A3 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route A3 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route A3 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route A3 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route A3 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route A3 Airplane Model 7 Trips)
V Z Route A3 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route A3 Return Trips - Route A3 Total Plane Trips Scheduled

D Route A3 Airplane Model 1 Trips[Team] = 4
P Route A3 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route A3 Airplane Model 1 Proposed Trips[Team] = IF(Route A3 Online = 0, 0, Route A3 Airplane Model 1 Trips)
V Route A3 Airplane Model 1 Actual Trips[Team] = IF(Route A3 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route A3 Airplane Model 1 Trips))
V Route A3 Airplane Model 1 Kms Flown Daily[Team] = Route A3 Airplane Model 1 Actual Trips * Market A Roundtrip Distance

D Route A3 Airplane Model 2 Trips[Team] = 0
P Route A3 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route A3 Airplane Model 2 Proposed Trips[Team] = IF(Route A3 Online = 0, 0, Route A3 Airplane Model 2 Trips)
V Route A3 Airplane Model 2 Actual Trips[Team] = IF(Route A3 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route A3 Airplane Model 2 Trips))
V Route A3 Airplane Model 2 Kms Flown Daily[Team] = Route A3 Airplane Model 2 Actual Trips * Market A Roundtrip Distance

D Route A3 Airplane Model 3 Trips[Team] = 0
P Route A3 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route A3 Airplane Model 3 Proposed Trips[Team] = IF(Route A3 Online = 0, 0, Route A3 Airplane Model 3 Trips)
V Route A3 Airplane Model 3 Actual Trips[Team] = IF(Route A3 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route A3 Airplane Model 3 Trips))
V Route A3 Airplane Model 3 Kms Flown Daily[Team] = Route A3 Airplane Model 3 Actual Trips * Market A Roundtrip Distance

D Route A3 Airplane Model 4 Trips[Team] = 0
P Route A3 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route A3 Airplane Model 4 Proposed Trips[Team] = IF(Route A3 Online = 0, 0, Route A3 Airplane Model 4 Trips)
V Route A3 Airplane Model 4 Actual Trips[Team] = IF(Route A3 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route A3 Airplane Model 4 Trips))
V Route A3 Airplane Model 4 Kms Flown Daily[Team] = Route A3 Airplane Model 4 Actual Trips * Market A Roundtrip Distance

D Route A3 Airplane Model 5 Trips[Team] = 0
P Route A3 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route A3 Airplane Model 5 Proposed Trips[Team] = IF(Route A3 Online = 0, 0, Route A3 Airplane Model 5 Trips)
V Route A3 Airplane Model 5 Actual Trips[Team] = IF(Route A3 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route A3 Airplane Model 5 Trips))
V Route A3 Airplane Model 5 Kms Flown Daily[Team] = Route A3 Airplane Model 5 Actual Trips * Market A Roundtrip Distance

D Route A3 Airplane Model 6 Trips[Team] = 0
P Route A3 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route A3 Airplane Model 6 Proposed Trips[Team] = IF(Route A3 Online = 0, 0, Route A3 Airplane Model 6 Trips)
V Route A3 Airplane Model 6 Actual Trips[Team] = IF(Route A3 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route A3 Airplane Model 6 Trips))
V Route A3 Airplane Model 6 Kms Flown Daily[Team] = Route A3 Airplane Model 6 Actual Trips * Market A Roundtrip Distance

D Route A3 Airplane Model 7 Trips[Team] = 0
P Route A3 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route A3 Airplane Model 7 Proposed Trips[Team] = IF(Route A3 Online = 0, 0, Route A3 Airplane Model 7 Trips)
V Route A3 Airplane Model 7 Actual Trips[Team] = IF(Route A3 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route A3 Airplane Model 7 Trips))
V Route A3 Airplane Model 7 Kms Flown Daily[Team] = Route A3 Airplane Model 7 Actual Trips * Market A Roundtrip Distance

## Route Pricing ##

V Route A3 Price Economy Number Of Teams[Team] = IF(Route A3 Online = 1 & Price Structure = 1, 1, 0)
V Route A3 Price Normal Number Of Teams[Team] = IF(Route A3 Online = 1 & Price Structure = 2, 1, 0)
V Route A3 Price Luxury Number Of Teams[Team] = IF(Route A3 Online = 1 & Price Structure = 3, 1, 0)

V Route A3 Price Sensitivity Economy = 1.001
V Route A3 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route A3 Price Economy Number Of Teams)) / Price Economy) ^ Route A3 Price Sensitivity Economy)
V Route A3 Price Market Share Economy[Team] = (Route A3 Price Attractiveness Economy / ARRAYSUM(Route A3 Price Attractiveness Economy))

V Route A3 Middling of Price[Team] = IF(Route A3 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route A3 Price Normal Number Of Teams)) - 0.12)), 0)
V Route A3 Price Sensitivity Normal = 1.5
V Route A3 Price Attractiveness Normal[Team] = (ARRAYAVG(Route A3 Middling of Price) / Route A3 Middling of Price) ^ Route A3 Price Sensitivity Normal
V Route A3 Price Market Share Normal[Team] = (Route A3 Price Attractiveness Normal / ARRAYSUM(Route A3 Price Attractiveness Normal))

V Route A3 Price Sensitivity Luxury = 1.001
V Route A3 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route A3 Price Luxury Number Of Teams))) ^ Route A3 Price Sensitivity Luxury)
V Route A3 Price Market Share Luxury[Team] = (Route A3 Price Attractiveness Luxury / ARRAYSUM(Route A3 Price Attractiveness Luxury))

V Route A3 Price Overall Market Share[Team] = IF(Price Structure = 1, Route A3 Price Market Share Economy, IF(Price Structure = 2, Route A3 Price Market Share Normal, Route A3 Price Market Share Luxury))

## Route Expenses ##

V Route A3 Opening Expense[Team] = IF(PREVIOUS(Route A3 Online = 0) & Route A3 Online = 1, Route Const Opening New Route Expense, 0) 

V Route A3 Fuel Expenses Airplane Model 1[Team] = Route A3 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route A3 Fuel Expenses Airplane Model 2[Team] = Route A3 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route A3 Fuel Expenses Airplane Model 3[Team] = Route A3 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route A3 Fuel Expenses Airplane Model 4[Team] = Route A3 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route A3 Fuel Expenses Airplane Model 5[Team] = Route A3 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route A3 Fuel Expenses Airplane Model 6[Team] = Route A3 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route A3 Fuel Expenses Airplane Model 7[Team] = Route A3 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route A3 Total Fuel Expenses[Team] = Route A3 Fuel Expenses Airplane Model 1 + Route A3 Fuel Expenses Airplane Model 2 + Route A3 Fuel Expenses Airplane Model 3 + Route A3 Fuel Expenses Airplane Model 4 + Route A3 Fuel Expenses Airplane Model 5 + Route A3 Fuel Expenses Airplane Model 6 + Route A3 Fuel Expenses Airplane Model 7 


### Route A4 ###

V Route A4 Roundtrip Distance Planned[Team] = Market A Roundtrip Distance * IF(Route A4 Online = 1,Route A4 Return Trips, 0)

## Route A4 Establishment ########
V Route A4 Demand For Teams[3] = {Market A Demand[1] + ((SQRT(Market A Demand[1] / 10 * Route A4 Num Of Teams[1])) * 10), Market A Demand[2] + ((SQRT(Market A Demand[2] / 10 * Route A4 Num Of Teams[2])) * 10), Market A Demand[3] + ((SQRT(Market A Demand[3] / 10 * Route A4 Num Of Teams[3])) * 10)}
D Route A4 Online[Team] = 1
P Route A4 Online.ExecuteDecisionImmediately = true

#V Route A4 Opening Expense[Team] = IF(PREVIOUS(Route A4 Online = 0) & Route A4 Online = 1, Route Const Opening New Route Expense, 0) 

V Route A4 Online Economy[Team] = IF(Route A4 Online = 1 & Price Structure = 1, 1, 0)
V Route A4 Online Normal[Team] = IF(Route A4 Online = 1 & Price Structure = 2, 1, 0)
V Route A4 Online Luxury[Team] = IF(Route A4 Online = 1 & Price Structure = 3, 1, 0)

V Route A4 First Quarter Online[Team] = REMEMBER((Route A4 Online = 1) & (PREVIOUS(Route A4 Online) = 0), STEP)
V Route A4 Number Of Quarters Online[Team] = IF(Route A4 Online = 1, STEP - Route A4 First Quarter Online + 1, 0)
V Route A4 Num Of Teams[3] = {ARRAYSUM(Route A4 Online Economy), ARRAYSUM(Route A4 Online Normal), ARRAYSUM(Route A4 Online Luxury)}

V Route A4 Attractiveness[Team] = IF(Route A4 Number Of Quarters Online = 1, 1, SQRT(Route A4 Number Of Quarters Online) + Route A4 Number Of Quarters Online)

V Route A4 Attractiveness Economy[Team] = IF(Route A4 Online = 1 & Price Structure = 1, Route A4 Attractiveness, 0)
V Route A4 Attractiveness Normal[Team] = IF(Route A4 Online = 1 & Price Structure = 2, Route A4 Attractiveness, 0)
V Route A4 Attractiveness Luxury[Team] = IF(Route A4 Online = 1 & Price Structure = 3, Route A4 Attractiveness, 0)

V Route A4 Market Share[Team] = (Route A4 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route A4 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route A4 Attractiveness Normal), ARRAYSUM(Route A4 Attractiveness Luxury))))
V Route A4 Total Market Share[Team] = IF(Route A4 Online = 0, 0, (0.5 * Route A4 Market Share ) + (0.2 * Route A4 Return Trips Market Share) + (0.3 * Route A4 Price Overall Market Share))
V Route A4 Market Share For Customers[Team] = Route A4 Total Market Share * (IF(Price Structure = 1, Route A4 Demand For Teams[1], IF(Price Structure = 2, Route A4 Demand For Teams[2], Route A4 Demand For Teams[3])))

V Route A4 Sales[Team] = Route A4 Total Market Share * (IF(Price Structure = 1, Route A4 Demand For Teams[1], IF(Price Structure = 2, Route A4 Demand For Teams[2], Route A4 Demand For Teams[3])))

V Route A4 Final Sales[Team] = IF(Route A4 Sales > Route A4 Seat Supply, Route A4 Seat Supply, Route A4 Sales)

V Route A4 Revenue Passenger Kms[Team] = Route A4 Final Sales * Market A Roundtrip Distance

# Route Trips
D Route A4 Return Trips[Team] = 4
P Route A4 Return Trips.ExecuteDecisionImmediately = true
V Route A4 Return Trips Previ[Team] = PREVIOUS(Route A4 Return Trips, 0)
V Route A4 Return Trips Sensitivity = 1.5

V Route A4 Average Number Of Trips = IF(ARRAYSUM(Route A4 Online) = 0, 0, ARRAYSUM(Route A4 Return Trips) / ARRAYSUM(Route A4 Online))
V Route A4 Average Number Of Trips Previ = PREVIOUS(Route A4 Average Number Of Trips, 0)


V Route A4 Return Trips Economy[Team] = IF(Route A4 Online = 1 & Price Structure = 1, Route A4 Return Trips, 0)
V Route A4 Return Trips Normal[Team] = IF(Route A4 Online = 1 & Price Structure = 2, Route A4 Return Trips, 0)
V Route A4 Return Trips Luxury[Team] = IF(Route A4 Online = 1 & Price Structure = 3, Route A4 Return Trips, 0)

V Route A4 Return Trips Attractiveness[Team] = (Route A4 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route A4 Return Trips Economy) / Route A4 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route A4 Return Trips Normal) / Route A4 Num Of Teams[2], ARRAYSUM(Route A4 Return Trips Luxury) / Route A4 Num Of Teams[3]))) ^ Route A4 Return Trips Sensitivity

V Route A4 Return Trips Attractiveness Economy[Team] = IF(Route A4 Online = 1 & Price Structure = 1, Route A4 Return Trips Attractiveness, 0)
V Route A4 Return Trips Attractiveness Normal[Team] = IF(Route A4 Online = 1 & Price Structure = 2, Route A4 Return Trips Attractiveness, 0)
V Route A4 Return Trips Attractiveness Luxury[Team] = IF(Route A4 Online = 1 & Price Structure = 3, Route A4 Return Trips Attractiveness, 0)

V Route A4 Return Trips Market Share[Team] = (Route A4 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route A4 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route A4 Return Trips Attractiveness Normal), ARRAYSUM(Route A4 Return Trips Attractiveness Luxury))))

V Route A4 Seat Supply[Team] = Route A4 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route A4 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route A4 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route A4 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route A4 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route A4 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route A4 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route A4 Available Seat Kms[Team] = Route A4 Seat Supply * Market A Roundtrip Distance

# Route Trips By Plane #

V Route A4 Total Airplane Kms Planned[Team] = Route A4 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route A4 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route A4 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route A4 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route A4 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route A4 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route A4 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route A4 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route A4 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route A4 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route A4 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route A4 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route A4 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route A4 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route A4 Airplane Model 7 Trips)
V Z Route A4 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route A4 Return Trips - Route A4 Total Plane Trips Scheduled

D Route A4 Airplane Model 1 Trips[Team] = 4
P Route A4 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route A4 Airplane Model 1 Proposed Trips[Team] = IF(Route A4 Online = 0, 0, Route A4 Airplane Model 1 Trips)
V Route A4 Airplane Model 1 Actual Trips[Team] = IF(Route A4 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route A4 Airplane Model 1 Trips))
V Route A4 Airplane Model 1 Kms Flown Daily[Team] = Route A4 Airplane Model 1 Actual Trips * Market A Roundtrip Distance

D Route A4 Airplane Model 2 Trips[Team] = 0
P Route A4 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route A4 Airplane Model 2 Proposed Trips[Team] = IF(Route A4 Online = 0, 0, Route A4 Airplane Model 2 Trips)
V Route A4 Airplane Model 2 Actual Trips[Team] = IF(Route A4 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route A4 Airplane Model 2 Trips))
V Route A4 Airplane Model 2 Kms Flown Daily[Team] = Route A4 Airplane Model 2 Actual Trips * Market A Roundtrip Distance

D Route A4 Airplane Model 3 Trips[Team] = 0
P Route A4 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route A4 Airplane Model 3 Proposed Trips[Team] = IF(Route A4 Online = 0, 0, Route A4 Airplane Model 3 Trips)
V Route A4 Airplane Model 3 Actual Trips[Team] = IF(Route A4 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route A4 Airplane Model 3 Trips))
V Route A4 Airplane Model 3 Kms Flown Daily[Team] = Route A4 Airplane Model 3 Actual Trips * Market A Roundtrip Distance

D Route A4 Airplane Model 4 Trips[Team] = 0
P Route A4 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route A4 Airplane Model 4 Proposed Trips[Team] = IF(Route A4 Online = 0, 0, Route A4 Airplane Model 4 Trips)
V Route A4 Airplane Model 4 Actual Trips[Team] = IF(Route A4 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route A4 Airplane Model 4 Trips))
V Route A4 Airplane Model 4 Kms Flown Daily[Team] = Route A4 Airplane Model 4 Actual Trips * Market A Roundtrip Distance

D Route A4 Airplane Model 5 Trips[Team] = 0
P Route A4 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route A4 Airplane Model 5 Proposed Trips[Team] = IF(Route A4 Online = 0, 0, Route A4 Airplane Model 5 Trips)
V Route A4 Airplane Model 5 Actual Trips[Team] = IF(Route A4 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route A4 Airplane Model 5 Trips))
V Route A4 Airplane Model 5 Kms Flown Daily[Team] = Route A4 Airplane Model 5 Actual Trips * Market A Roundtrip Distance

D Route A4 Airplane Model 6 Trips[Team] = 0
P Route A4 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route A4 Airplane Model 6 Proposed Trips[Team] = IF(Route A4 Online = 0, 0, Route A4 Airplane Model 6 Trips)
V Route A4 Airplane Model 6 Actual Trips[Team] = IF(Route A4 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route A4 Airplane Model 6 Trips))
V Route A4 Airplane Model 6 Kms Flown Daily[Team] = Route A4 Airplane Model 6 Actual Trips * Market A Roundtrip Distance

D Route A4 Airplane Model 7 Trips[Team] = 0
P Route A4 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route A4 Airplane Model 7 Proposed Trips[Team] = IF(Route A4 Online = 0, 0, Route A4 Airplane Model 7 Trips)
V Route A4 Airplane Model 7 Actual Trips[Team] = IF(Route A4 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route A4 Airplane Model 7 Trips))
V Route A4 Airplane Model 7 Kms Flown Daily[Team] = Route A4 Airplane Model 7 Actual Trips * Market A Roundtrip Distance

## Route Pricing ##

V Route A4 Price Economy Number Of Teams[Team] = IF(Route A4 Online = 1 & Price Structure = 1, 1, 0)
V Route A4 Price Normal Number Of Teams[Team] = IF(Route A4 Online = 1 & Price Structure = 2, 1, 0)
V Route A4 Price Luxury Number Of Teams[Team] = IF(Route A4 Online = 1 & Price Structure = 3, 1, 0)

V Route A4 Price Sensitivity Economy = 1.001
V Route A4 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route A4 Price Economy Number Of Teams)) / Price Economy) ^ Route A4 Price Sensitivity Economy)
V Route A4 Price Market Share Economy[Team] = (Route A4 Price Attractiveness Economy / ARRAYSUM(Route A4 Price Attractiveness Economy))

V Route A4 Middling of Price[Team] = IF(Route A4 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route A4 Price Normal Number Of Teams)) - 0.12)), 0)
V Route A4 Price Sensitivity Normal = 1.5
V Route A4 Price Attractiveness Normal[Team] = (ARRAYAVG(Route A4 Middling of Price) / Route A4 Middling of Price) ^ Route A4 Price Sensitivity Normal
V Route A4 Price Market Share Normal[Team] = (Route A4 Price Attractiveness Normal / ARRAYSUM(Route A4 Price Attractiveness Normal))

V Route A4 Price Sensitivity Luxury = 1.001
V Route A4 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route A4 Price Luxury Number Of Teams))) ^ Route A4 Price Sensitivity Luxury)
V Route A4 Price Market Share Luxury[Team] = (Route A4 Price Attractiveness Luxury / ARRAYSUM(Route A4 Price Attractiveness Luxury))

V Route A4 Price Overall Market Share[Team] = IF(Price Structure = 1, Route A4 Price Market Share Economy, IF(Price Structure = 2, Route A4 Price Market Share Normal, Route A4 Price Market Share Luxury))

## Route Expenses ##

V Route A4 Opening Expense[Team] = IF(PREVIOUS(Route A4 Online = 0) & Route A4 Online = 1, Route Const Opening New Route Expense, 0) 

V Route A4 Fuel Expenses Airplane Model 1[Team] = Route A4 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route A4 Fuel Expenses Airplane Model 2[Team] = Route A4 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route A4 Fuel Expenses Airplane Model 3[Team] = Route A4 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route A4 Fuel Expenses Airplane Model 4[Team] = Route A4 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route A4 Fuel Expenses Airplane Model 5[Team] = Route A4 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route A4 Fuel Expenses Airplane Model 6[Team] = Route A4 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route A4 Fuel Expenses Airplane Model 7[Team] = Route A4 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route A4 Total Fuel Expenses[Team] = Route A4 Fuel Expenses Airplane Model 1 + Route A4 Fuel Expenses Airplane Model 2 + Route A4 Fuel Expenses Airplane Model 3 + Route A4 Fuel Expenses Airplane Model 4 + Route A4 Fuel Expenses Airplane Model 5 + Route A4 Fuel Expenses Airplane Model 6 + Route A4 Fuel Expenses Airplane Model 7 


### Route A5 ###

V Route A5 Roundtrip Distance Planned[Team] = Market A Roundtrip Distance * IF(Route A5 Online = 1,Route A5 Return Trips, 0)

## Route A5 Establishment ########
V Route A5 Demand For Teams[3] = {Market A Demand[1] + ((SQRT(Market A Demand[1] / 10 * Route A5 Num Of Teams[1])) * 10), Market A Demand[2] + ((SQRT(Market A Demand[2] / 10 * Route A5 Num Of Teams[2])) * 10), Market A Demand[3] + ((SQRT(Market A Demand[3] / 10 * Route A5 Num Of Teams[3])) * 10)}
D Route A5 Online[Team] = 1
P Route A5 Online.ExecuteDecisionImmediately = true

#V Route A5 Opening Expense[Team] = IF(PREVIOUS(Route A5 Online = 0) & Route A5 Online = 1, Route Const Opening New Route Expense, 0) 

V Route A5 Online Economy[Team] = IF(Route A5 Online = 1 & Price Structure = 1, 1, 0)
V Route A5 Online Normal[Team] = IF(Route A5 Online = 1 & Price Structure = 2, 1, 0)
V Route A5 Online Luxury[Team] = IF(Route A5 Online = 1 & Price Structure = 3, 1, 0)

V Route A5 First Quarter Online[Team] = REMEMBER((Route A5 Online = 1) & (PREVIOUS(Route A5 Online) = 0), STEP)
V Route A5 Number Of Quarters Online[Team] = IF(Route A5 Online = 1, STEP - Route A5 First Quarter Online + 1, 0)
V Route A5 Num Of Teams[3] = {ARRAYSUM(Route A5 Online Economy), ARRAYSUM(Route A5 Online Normal), ARRAYSUM(Route A5 Online Luxury)}

V Route A5 Attractiveness[Team] = IF(Route A5 Number Of Quarters Online = 1, 1, SQRT(Route A5 Number Of Quarters Online) + Route A5 Number Of Quarters Online)

V Route A5 Attractiveness Economy[Team] = IF(Route A5 Online = 1 & Price Structure = 1, Route A5 Attractiveness, 0)
V Route A5 Attractiveness Normal[Team] = IF(Route A5 Online = 1 & Price Structure = 2, Route A5 Attractiveness, 0)
V Route A5 Attractiveness Luxury[Team] = IF(Route A5 Online = 1 & Price Structure = 3, Route A5 Attractiveness, 0)

V Route A5 Market Share[Team] = (Route A5 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route A5 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route A5 Attractiveness Normal), ARRAYSUM(Route A5 Attractiveness Luxury))))
V Route A5 Total Market Share[Team] = IF(Route A5 Online = 0, 0, (0.5 * Route A5 Market Share ) + (0.2 * Route A5 Return Trips Market Share) + (0.3 * Route A5 Price Overall Market Share))
V Route A5 Market Share For Customers[Team] = Route A5 Total Market Share * (IF(Price Structure = 1, Route A5 Demand For Teams[1], IF(Price Structure = 2, Route A5 Demand For Teams[2], Route A5 Demand For Teams[3])))

V Route A5 Sales[Team] = Route A5 Total Market Share * (IF(Price Structure = 1, Route A5 Demand For Teams[1], IF(Price Structure = 2, Route A5 Demand For Teams[2], Route A5 Demand For Teams[3])))

V Route A5 Final Sales[Team] = IF(Route A5 Sales > Route A5 Seat Supply, Route A5 Seat Supply, Route A5 Sales)

V Route A5 Revenue Passenger Kms[Team] = Route A5 Final Sales * Market A Roundtrip Distance

# Route Trips
D Route A5 Return Trips[Team] = 4
P Route A5 Return Trips.ExecuteDecisionImmediately = true
V Route A5 Return Trips Previ[Team] = PREVIOUS(Route A5 Return Trips, 0)
V Route A5 Return Trips Sensitivity = 1.5

V Route A5 Average Number Of Trips = IF(ARRAYSUM(Route A5 Online) = 0, 0, ARRAYSUM(Route A5 Return Trips) / ARRAYSUM(Route A5 Online))
V Route A5 Average Number Of Trips Previ = PREVIOUS(Route A5 Average Number Of Trips, 0)

V Route A5 Return Trips Economy[Team] = IF(Route A5 Online = 1 & Price Structure = 1, Route A5 Return Trips, 0)
V Route A5 Return Trips Normal[Team] = IF(Route A5 Online = 1 & Price Structure = 2, Route A5 Return Trips, 0)
V Route A5 Return Trips Luxury[Team] = IF(Route A5 Online = 1 & Price Structure = 3, Route A5 Return Trips, 0)

V Route A5 Return Trips Attractiveness[Team] = (Route A5 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route A5 Return Trips Economy) / Route A5 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route A5 Return Trips Normal) / Route A5 Num Of Teams[2], ARRAYSUM(Route A5 Return Trips Luxury) / Route A5 Num Of Teams[3]))) ^ Route A5 Return Trips Sensitivity

V Route A5 Return Trips Attractiveness Economy[Team] = IF(Route A5 Online = 1 & Price Structure = 1, Route A5 Return Trips Attractiveness, 0)
V Route A5 Return Trips Attractiveness Normal[Team] = IF(Route A5 Online = 1 & Price Structure = 2, Route A5 Return Trips Attractiveness, 0)
V Route A5 Return Trips Attractiveness Luxury[Team] = IF(Route A5 Online = 1 & Price Structure = 3, Route A5 Return Trips Attractiveness, 0)

V Route A5 Return Trips Market Share[Team] = (Route A5 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route A5 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route A5 Return Trips Attractiveness Normal), ARRAYSUM(Route A5 Return Trips Attractiveness Luxury))))

V Route A5 Seat Supply[Team] = Route A5 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route A5 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route A5 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route A5 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route A5 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route A5 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route A5 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route A5 Available Seat Kms[Team] = Route A5 Seat Supply * Market A Roundtrip Distance

# Route Trips By Plane #

V Route A5 Total Airplane Kms Planned[Team] = Route A5 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route A5 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route A5 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route A5 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route A5 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route A5 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route A5 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route A5 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route A5 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route A5 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route A5 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route A5 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route A5 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route A5 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route A5 Airplane Model 7 Trips)
V Z Route A5 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route A5 Return Trips - Route A5 Total Plane Trips Scheduled

D Route A5 Airplane Model 1 Trips[Team] = 4
P Route A5 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route A5 Airplane Model 1 Proposed Trips[Team] = IF(Route A5 Online = 0, 0, Route A5 Airplane Model 1 Trips)
V Route A5 Airplane Model 1 Actual Trips[Team] = IF(Route A5 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route A5 Airplane Model 1 Trips))
V Route A5 Airplane Model 1 Kms Flown Daily[Team] = Route A5 Airplane Model 1 Actual Trips * Market A Roundtrip Distance

D Route A5 Airplane Model 2 Trips[Team] = 0
P Route A5 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route A5 Airplane Model 2 Proposed Trips[Team] = IF(Route A5 Online = 0, 0, Route A5 Airplane Model 2 Trips)
V Route A5 Airplane Model 2 Actual Trips[Team] = IF(Route A5 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route A5 Airplane Model 2 Trips))
V Route A5 Airplane Model 2 Kms Flown Daily[Team] = Route A5 Airplane Model 2 Actual Trips * Market A Roundtrip Distance

D Route A5 Airplane Model 3 Trips[Team] = 0
P Route A5 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route A5 Airplane Model 3 Proposed Trips[Team] = IF(Route A5 Online = 0, 0, Route A5 Airplane Model 3 Trips)
V Route A5 Airplane Model 3 Actual Trips[Team] = IF(Route A5 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route A5 Airplane Model 3 Trips))
V Route A5 Airplane Model 3 Kms Flown Daily[Team] = Route A5 Airplane Model 3 Actual Trips * Market A Roundtrip Distance

D Route A5 Airplane Model 4 Trips[Team] = 0
P Route A5 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route A5 Airplane Model 4 Proposed Trips[Team] = IF(Route A5 Online = 0, 0, Route A5 Airplane Model 4 Trips)
V Route A5 Airplane Model 4 Actual Trips[Team] = IF(Route A5 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route A5 Airplane Model 4 Trips))
V Route A5 Airplane Model 4 Kms Flown Daily[Team] = Route A5 Airplane Model 4 Actual Trips * Market A Roundtrip Distance

D Route A5 Airplane Model 5 Trips[Team] = 0
P Route A5 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route A5 Airplane Model 5 Proposed Trips[Team] = IF(Route A5 Online = 0, 0, Route A5 Airplane Model 5 Trips)
V Route A5 Airplane Model 5 Actual Trips[Team] = IF(Route A5 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route A5 Airplane Model 5 Trips))
V Route A5 Airplane Model 5 Kms Flown Daily[Team] = Route A5 Airplane Model 5 Actual Trips * Market A Roundtrip Distance

D Route A5 Airplane Model 6 Trips[Team] = 0
P Route A5 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route A5 Airplane Model 6 Proposed Trips[Team] = IF(Route A5 Online = 0, 0, Route A5 Airplane Model 6 Trips)
V Route A5 Airplane Model 6 Actual Trips[Team] = IF(Route A5 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route A5 Airplane Model 6 Trips))
V Route A5 Airplane Model 6 Kms Flown Daily[Team] = Route A5 Airplane Model 6 Actual Trips * Market A Roundtrip Distance

D Route A5 Airplane Model 7 Trips[Team] = 0
P Route A5 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route A5 Airplane Model 7 Proposed Trips[Team] = IF(Route A5 Online = 0, 0, Route A5 Airplane Model 7 Trips)
V Route A5 Airplane Model 7 Actual Trips[Team] = IF(Route A5 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route A5 Airplane Model 7 Trips))
V Route A5 Airplane Model 7 Kms Flown Daily[Team] = Route A5 Airplane Model 7 Actual Trips * Market A Roundtrip Distance

## Route Pricing ##

V Route A5 Price Economy Number Of Teams[Team] = IF(Route A5 Online = 1 & Price Structure = 1, 1, 0)
V Route A5 Price Normal Number Of Teams[Team] = IF(Route A5 Online = 1 & Price Structure = 2, 1, 0)
V Route A5 Price Luxury Number Of Teams[Team] = IF(Route A5 Online = 1 & Price Structure = 3, 1, 0)

V Route A5 Price Sensitivity Economy = 1.001
V Route A5 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route A5 Price Economy Number Of Teams)) / Price Economy) ^ Route A5 Price Sensitivity Economy)
V Route A5 Price Market Share Economy[Team] = (Route A5 Price Attractiveness Economy / ARRAYSUM(Route A5 Price Attractiveness Economy))

V Route A5 Middling of Price[Team] = IF(Route A5 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route A5 Price Normal Number Of Teams)) - 0.12)), 0)
V Route A5 Price Sensitivity Normal = 1.5
V Route A5 Price Attractiveness Normal[Team] = (ARRAYAVG(Route A5 Middling of Price) / Route A5 Middling of Price) ^ Route A5 Price Sensitivity Normal
V Route A5 Price Market Share Normal[Team] = (Route A5 Price Attractiveness Normal / ARRAYSUM(Route A5 Price Attractiveness Normal))

V Route A5 Price Sensitivity Luxury = 1.001
V Route A5 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route A5 Price Luxury Number Of Teams))) ^ Route A5 Price Sensitivity Luxury)
V Route A5 Price Market Share Luxury[Team] = (Route A5 Price Attractiveness Luxury / ARRAYSUM(Route A5 Price Attractiveness Luxury))

V Route A5 Price Overall Market Share[Team] = IF(Price Structure = 1, Route A5 Price Market Share Economy, IF(Price Structure = 2, Route A5 Price Market Share Normal, Route A5 Price Market Share Luxury))

## Route Expenses ##

V Route A5 Opening Expense[Team] = IF(PREVIOUS(Route A5 Online = 0) & Route A5 Online = 1, Route Const Opening New Route Expense, 0) 

V Route A5 Fuel Expenses Airplane Model 1[Team] = Route A5 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route A5 Fuel Expenses Airplane Model 2[Team] = Route A5 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route A5 Fuel Expenses Airplane Model 3[Team] = Route A5 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route A5 Fuel Expenses Airplane Model 4[Team] = Route A5 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route A5 Fuel Expenses Airplane Model 5[Team] = Route A5 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route A5 Fuel Expenses Airplane Model 6[Team] = Route A5 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route A5 Fuel Expenses Airplane Model 7[Team] = Route A5 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route A5 Total Fuel Expenses[Team] = Route A5 Fuel Expenses Airplane Model 1 + Route A5 Fuel Expenses Airplane Model 2 + Route A5 Fuel Expenses Airplane Model 3 + Route A5 Fuel Expenses Airplane Model 4 + Route A5 Fuel Expenses Airplane Model 5 + Route A5 Fuel Expenses Airplane Model 6 + Route A5 Fuel Expenses Airplane Model 7 


##### MARKET B #####

V Market B Roundtrip Distance = 3916
V Market B Demand[3] = {PREVIOUS(Market B Demand[1] * 1.02, 300), PREVIOUS(Market B Demand[2] * 1.02, 1200), PREVIOUS(Market B Demand[3] * 1.02, 650)}

V Market B Total Available Seat Kms Airplane Model 1[Team] = Route B1 Airplane Model 1 Kms Flown Daily + Route B2 Airplane Model 1 Kms Flown Daily + Route B3 Airplane Model 1 Kms Flown Daily + Route B4 Airplane Model 1 Kms Flown Daily + Route B5 Airplane Model 1 Kms Flown Daily
V Market B Total Actual Seat Kms Airplane Model 1[Team] = Market B Total Available Seat Kms Airplane Model 1 * X Reliability Variable
V Market B Total Available Seat Kms Airplane Model 2[Team] = Route B1 Airplane Model 2 Kms Flown Daily + Route B2 Airplane Model 2 Kms Flown Daily + Route B3 Airplane Model 2 Kms Flown Daily + Route B4 Airplane Model 2 Kms Flown Daily + Route B5 Airplane Model 2 Kms Flown Daily
V Market B Total Actual Seat Kms Airplane Model 2[Team] = Market B Total Available Seat Kms Airplane Model 2 * X Reliability Variable
V Market B Total Available Seat Kms Airplane Model 3[Team] = Route B1 Airplane Model 3 Kms Flown Daily + Route B2 Airplane Model 3 Kms Flown Daily + Route B3 Airplane Model 3 Kms Flown Daily + Route B4 Airplane Model 3 Kms Flown Daily + Route B5 Airplane Model 3 Kms Flown Daily
V Market B Total Actual Seat Kms Airplane Model 3[Team] = Market B Total Available Seat Kms Airplane Model 3 * X Reliability Variable
V Market B Total Available Seat Kms Airplane Model 4[Team] = Route B1 Airplane Model 4 Kms Flown Daily + Route B2 Airplane Model 4 Kms Flown Daily + Route B3 Airplane Model 4 Kms Flown Daily + Route B4 Airplane Model 4 Kms Flown Daily + Route B5 Airplane Model 4 Kms Flown Daily
V Market B Total Actual Seat Kms Airplane Model 4[Team] = Market B Total Available Seat Kms Airplane Model 4 * X Reliability Variable
V Market B Total Available Seat Kms Airplane Model 5[Team] = Route B1 Airplane Model 5 Kms Flown Daily + Route B2 Airplane Model 5 Kms Flown Daily + Route B3 Airplane Model 5 Kms Flown Daily + Route B4 Airplane Model 5 Kms Flown Daily + Route B5 Airplane Model 5 Kms Flown Daily
V Market B Total Actual Seat Kms Airplane Model 5[Team] = Market B Total Available Seat Kms Airplane Model 5 * X Reliability Variable
V Market B Total Available Seat Kms Airplane Model 6[Team] = Route B1 Airplane Model 6 Kms Flown Daily + Route B2 Airplane Model 6 Kms Flown Daily + Route B3 Airplane Model 6 Kms Flown Daily + Route B4 Airplane Model 6 Kms Flown Daily + Route B5 Airplane Model 6 Kms Flown Daily
V Market B Total Actual Seat Kms Airplane Model 6[Team] = Market B Total Available Seat Kms Airplane Model 6 * X Reliability Variable
V Market B Total Available Seat Kms Airplane Model 7[Team] = Route B1 Airplane Model 7 Kms Flown Daily + Route B2 Airplane Model 7 Kms Flown Daily + Route B3 Airplane Model 7 Kms Flown Daily + Route B4 Airplane Model 7 Kms Flown Daily + Route B5 Airplane Model 7 Kms Flown Daily
V Market B Total Actual Seat Kms Airplane Model 7[Team] = Market B Total Available Seat Kms Airplane Model 7 * X Reliability Variable

V Market B Opening Expenses[Team] = Route B1 Opening Expense + Route B2 Opening Expense + Route B3 Opening Expense + Route B4 Opening Expense + Route B5 Opening Expense
V Market B Fuel Expenses[Team] = Route B1 Total Fuel Expenses + Route B2 Total Fuel Expenses + Route B3 Total Fuel Expenses + Route B4 Total Fuel Expenses + Route B5 Total Fuel Expenses

V Market B Total Available Seat Kms[Team] = Route B1 Available Seat Kms + Route B2 Available Seat Kms + Route B3 Available Seat Kms + Route B4 Available Seat Kms + Route B5 Available Seat Kms

V Market B Total Revenue Passenger Kms[Team] =  Route B1 Revenue Passenger Kms + Route B2 Revenue Passenger Kms + Route B3 Revenue Passenger Kms + Route B4 Revenue Passenger Kms + Route B5 Revenue Passenger Kms

V Market B Total Planned Daily Flight Distance[Team] = Route B1 Roundtrip Distance Planned + Route B2 Roundtrip Distance Planned + Route B3 Roundtrip Distance Planned + Route B4 Roundtrip Distance Planned + Route B5 Roundtrip Distance Planned

V Market B Final Sales[Team] = (Route B1 Final Sales + Route B2 Final Sales + Route B3 Final Sales + Route B4 Final Sales + Route B5 Final Sales) * Market B Roundtrip Distance

V Airplane 1 Fleet Market B Total Trips[Team] = (Route B1 Airplane Model 1 Proposed Trips + Route B2 Airplane Model 1 Proposed Trips + Route B3 Airplane Model 1 Proposed Trips + Route B4 Airplane Model 1 Proposed Trips + Route B5 Airplane Model 1 Proposed Trips) * Market B Roundtrip Distance
V Airplane 2 Fleet Market B Total Trips[Team] = (Route B1 Airplane Model 2 Proposed Trips + Route B2 Airplane Model 2 Proposed Trips + Route B3 Airplane Model 2 Proposed Trips + Route B4 Airplane Model 2 Proposed Trips + Route B5 Airplane Model 2 Proposed Trips) * Market B Roundtrip Distance
V Airplane 3 Fleet Market B Total Trips[Team] = (Route B1 Airplane Model 3 Proposed Trips + Route B2 Airplane Model 3 Proposed Trips + Route B3 Airplane Model 3 Proposed Trips + Route B4 Airplane Model 3 Proposed Trips + Route B5 Airplane Model 3 Proposed Trips) * Market B Roundtrip Distance
V Airplane 4 Fleet Market B Total Trips[Team] = (Route B1 Airplane Model 4 Proposed Trips + Route B2 Airplane Model 4 Proposed Trips + Route B3 Airplane Model 4 Proposed Trips + Route B4 Airplane Model 4 Proposed Trips + Route B5 Airplane Model 4 Proposed Trips) * Market B Roundtrip Distance
V Airplane 5 Fleet Market B Total Trips[Team] = (Route B1 Airplane Model 5 Proposed Trips + Route B2 Airplane Model 5 Proposed Trips + Route B3 Airplane Model 5 Proposed Trips + Route B4 Airplane Model 5 Proposed Trips + Route B5 Airplane Model 5 Proposed Trips) * Market B Roundtrip Distance
V Airplane 6 Fleet Market B Total Trips[Team] = (Route B1 Airplane Model 6 Proposed Trips + Route B2 Airplane Model 6 Proposed Trips + Route B3 Airplane Model 6 Proposed Trips + Route B4 Airplane Model 6 Proposed Trips + Route B5 Airplane Model 6 Proposed Trips) * Market B Roundtrip Distance
V Airplane 7 Fleet Market B Total Trips[Team] = (Route B1 Airplane Model 7 Proposed Trips + Route B2 Airplane Model 7 Proposed Trips + Route B3 Airplane Model 7 Proposed Trips + Route B4 Airplane Model 7 Proposed Trips + Route B5 Airplane Model 7 Proposed Trips) * Market B Roundtrip Distance


### Route B1 ###

#V Route B1 Roundtrip Distance = 832

V Route B1 Roundtrip Distance Planned[Team] = Market B Roundtrip Distance * IF(Route B1 Online = 1,Route B1 Return Trips, 0)

## Route B1 Establishment ##

#V Route B1 Demand[3] = {PREVIOUS(Route B1 Demand[1] * 1.02, 800), PREVIOUS(Route B1 Demand[2] * 1.02, 1000), PREVIOUS(Route B1 Demand[3] * 1.02, 700)}
V Route B1 Demand For Teams[3] = {Market B Demand[1] + ((SQRT(Market B Demand[1] / 10 * Route B1 Num Of Teams[1])) * 10), Market B Demand[2] + ((SQRT(Market B Demand[2] / 10 * Route B1 Num Of Teams[2])) * 10), Market B Demand[3] + ((SQRT(Market B Demand[3] / 10 * Route B1 Num Of Teams[3])) * 10)}
D Route B1 Online[Team] = 0
P Route B1 Online.ExecuteDecisionImmediately = true

#V Route B1 Opening Expense[Team] = IF(PREVIOUS(Route B1 Online = 0) & Route B1 Online = 1, Route Const Opening New Route Expense, 0) 

V Route B1 Online Economy[Team] = IF(Route B1 Online = 1 & Price Structure = 1, 1, 0)
V Route B1 Online Normal[Team] = IF(Route B1 Online = 1 & Price Structure = 2, 1, 0)
V Route B1 Online Luxury[Team] = IF(Route B1 Online = 1 & Price Structure = 3, 1, 0)

V Route B1 First Quarter Online[Team] = REMEMBER((Route B1 Online = 1) & (PREVIOUS(Route B1 Online) = 0), STEP)
V Route B1 Number Of Quarters Online[Team] = IF(Route B1 Online = 1, STEP - Route B1 First Quarter Online + 1, 0)
V Route B1 Num Of Teams[3] = {ARRAYSUM(Route B1 Online Economy), ARRAYSUM(Route B1 Online Normal), ARRAYSUM(Route B1 Online Luxury)}

#V Route B1 Norm Quarters[Team] = 0 + IF(Route B1 Norm Online = 1, 1, (-1) * Route B1 Norm Quarters Mirror)
#V Route B1 Norm Quarters Mirror[Team] = Route B1 Norm Quarters
#P Route B1 Norm Quarters Mirror.ExecuteDecisionImmediately = false

V Route B1 Attractiveness[Team] = IF(Route B1 Number Of Quarters Online = 1, 1, SQRT(Route B1 Number Of Quarters Online) + Route B1 Number Of Quarters Online)

V Route B1 Attractiveness Economy[Team] = IF(Route B1 Online = 1 & Price Structure = 1, Route B1 Attractiveness, 0)
V Route B1 Attractiveness Normal[Team] = IF(Route B1 Online = 1 & Price Structure = 2, Route B1 Attractiveness, 0)
V Route B1 Attractiveness Luxury[Team] = IF(Route B1 Online = 1 & Price Structure = 3, Route B1 Attractiveness, 0)

V Route B1 Market Share[Team] = (Route B1 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route B1 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route B1 Attractiveness Normal), ARRAYSUM(Route B1 Attractiveness Luxury))))
V Route B1 Total Market Share[Team] = IF(Route B1 Online = 0, 0, (0.5 * Route B1 Market Share ) + (0.2 * Route B1 Return Trips Market Share) + (0.3 * Route B1 Price Overall Market Share))
V Route B1 Market Share For Customers[Team] = Route B1 Total Market Share * (IF(Price Structure = 1, Route B1 Demand For Teams[1], IF(Price Structure = 2, Route B1 Demand For Teams[2], Route B1 Demand For Teams[3])))

V Route B1 Sales[Team] = Route B1 Total Market Share * (IF(Price Structure = 1, Route B1 Demand For Teams[1], IF(Price Structure = 2, Route B1 Demand For Teams[2], Route B1 Demand For Teams[3])))

V Route B1 Final Sales[Team] = IF(Route B1 Sales > Route B1 Seat Supply, Route B1 Seat Supply, Route B1 Sales)

V Route B1 Revenue Passenger Kms[Team] = Route B1 Final Sales * Market B Roundtrip Distance

## Route Trips ##
D Route B1 Return Trips[Team] = 0
P Route B1 Return Trips.ExecuteDecisionImmediately = true
V Route B1 Return Trips Previ[Team] = PREVIOUS(Route B1 Return Trips, 0)
V Route B1 Return Trips Sensitivity = 1.5

V Route B1 Average Number Of Trips = IF(ARRAYSUM(Route B1 Online) = 0, 0, ARRAYSUM(Route B1 Return Trips) / ARRAYSUM(Route B1 Online))
V Route B1 Average Number Of Trips Previ = PREVIOUS(Route B1 Average Number Of Trips, 0)

V Route B1 Return Trips Economy[Team] = IF(Route B1 Online = 1 & Price Structure = 1, Route B1 Return Trips, 0)
V Route B1 Return Trips Normal[Team] = IF(Route B1 Online = 1 & Price Structure = 2, Route B1 Return Trips, 0)
V Route B1 Return Trips Luxury[Team] = IF(Route B1 Online = 1 & Price Structure = 3, Route B1 Return Trips, 0)

V Route B1 Return Trips Attractiveness[Team] = (Route B1 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route B1 Return Trips Economy) / Route B1 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route B1 Return Trips Normal) / Route B1 Num Of Teams[2], ARRAYSUM(Route B1 Return Trips Luxury) / Route B1 Num Of Teams[3]))) ^ Route B1 Return Trips Sensitivity

V Route B1 Return Trips Attractiveness Economy[Team] = IF(Route B1 Online = 1 & Price Structure = 1, Route B1 Return Trips Attractiveness, 0)
V Route B1 Return Trips Attractiveness Normal[Team] = IF(Route B1 Online = 1 & Price Structure = 2, Route B1 Return Trips Attractiveness, 0)
V Route B1 Return Trips Attractiveness Luxury[Team] = IF(Route B1 Online = 1 & Price Structure = 3, Route B1 Return Trips Attractiveness, 0)

V Route B1 Return Trips Market Share[Team] = (Route B1 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route B1 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route B1 Return Trips Attractiveness Normal), ARRAYSUM(Route B1 Return Trips Attractiveness Luxury))))

V Route B1 Seat Supply[Team] = Route B1 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route B1 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route B1 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route B1 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route B1 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route B1 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route B1 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route B1 Available Seat Kms[Team] = Route B1 Seat Supply * Market B Roundtrip Distance

# Route Trips By Plane #

V Route B1 Total Airplane Kms Planned[Team] = Route B1 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route B1 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route B1 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route B1 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route B1 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route B1 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route B1 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route B1 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route B1 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route B1 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route B1 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route B1 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route B1 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route B1 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route B1 Airplane Model 7 Trips)
V Z Route B1 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route B1 Return Trips - Route B1 Total Plane Trips Scheduled

D Route B1 Airplane Model 1 Trips[Team] = 0
P Route B1 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route B1 Airplane Model 1 Proposed Trips[Team] = IF(Route B1 Online = 0, 0, Route B1 Airplane Model 1 Trips)
V Route B1 Airplane Model 1 Actual Trips[Team] = IF(Route B1 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route B1 Airplane Model 1 Trips))
V Route B1 Airplane Model 1 Kms Flown Daily[Team] = Route B1 Airplane Model 1 Actual Trips * Market B Roundtrip Distance

D Route B1 Airplane Model 2 Trips[Team] = 0
P Route B1 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route B1 Airplane Model 2 Proposed Trips[Team] = IF(Route B1 Online = 0, 0, Route B1 Airplane Model 2 Trips)
V Route B1 Airplane Model 2 Actual Trips[Team] = IF(Route B1 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route B1 Airplane Model 2 Trips))
V Route B1 Airplane Model 2 Kms Flown Daily[Team] = Route B1 Airplane Model 2 Actual Trips * Market B Roundtrip Distance

D Route B1 Airplane Model 3 Trips[Team] = 0
P Route B1 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route B1 Airplane Model 3 Proposed Trips[Team] = IF(Route B1 Online = 0, 0, Route B1 Airplane Model 3 Trips)
V Route B1 Airplane Model 3 Actual Trips[Team] = IF(Route B1 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route B1 Airplane Model 3 Trips))
V Route B1 Airplane Model 3 Kms Flown Daily[Team] = Route B1 Airplane Model 3 Actual Trips * Market B Roundtrip Distance

D Route B1 Airplane Model 4 Trips[Team] = 0
P Route B1 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route B1 Airplane Model 4 Proposed Trips[Team] = IF(Route B1 Online = 0, 0, Route B1 Airplane Model 4 Trips)
V Route B1 Airplane Model 4 Actual Trips[Team] = IF(Route B1 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route B1 Airplane Model 4 Trips))
V Route B1 Airplane Model 4 Kms Flown Daily[Team] = Route B1 Airplane Model 4 Actual Trips * Market B Roundtrip Distance

D Route B1 Airplane Model 5 Trips[Team] = 0
P Route B1 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route B1 Airplane Model 5 Proposed Trips[Team] = IF(Route B1 Online = 0, 0, Route B1 Airplane Model 5 Trips)
V Route B1 Airplane Model 5 Actual Trips[Team] = IF(Route B1 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route B1 Airplane Model 5 Trips))
V Route B1 Airplane Model 5 Kms Flown Daily[Team] = Route B1 Airplane Model 5 Actual Trips * Market B Roundtrip Distance

D Route B1 Airplane Model 6 Trips[Team] = 0
P Route B1 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route B1 Airplane Model 6 Proposed Trips[Team] = IF(Route B1 Online = 0, 0, Route B1 Airplane Model 6 Trips)
V Route B1 Airplane Model 6 Actual Trips[Team] = IF(Route B1 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route B1 Airplane Model 6 Trips))
V Route B1 Airplane Model 6 Kms Flown Daily[Team] = Route B1 Airplane Model 6 Actual Trips * Market B Roundtrip Distance

D Route B1 Airplane Model 7 Trips[Team] = 0
P Route B1 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route B1 Airplane Model 7 Proposed Trips[Team] = IF(Route B1 Online = 0, 0, Route B1 Airplane Model 7 Trips)
V Route B1 Airplane Model 7 Actual Trips[Team] = IF(Route B1 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route B1 Airplane Model 7 Trips))
V Route B1 Airplane Model 7 Kms Flown Daily[Team] = Route B1 Airplane Model 7 Actual Trips * Market B Roundtrip Distance


## Route Pricing ##
V Route B1 Price Economy Number Of Teams[Team] = IF(Route B1 Online = 1 & Price Structure = 1, 1, 0)
V Route B1 Price Normal Number Of Teams[Team] = IF(Route B1 Online = 1 & Price Structure = 2, 1, 0)
V Route B1 Price Luxury Number Of Teams[Team] = IF(Route B1 Online = 1 & Price Structure = 3, 1, 0)

V Route B1 Price Sensitivity Economy = 1.001
V Route B1 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route B1 Price Economy Number Of Teams)) / Price Economy) ^ Route B1 Price Sensitivity Economy)
V Route B1 Price Market Share Economy[Team] = (Route B1 Price Attractiveness Economy / ARRAYSUM(Route B1 Price Attractiveness Economy))

V Route B1 Middling of Price[Team] = IF(Route B1 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route B1 Price Normal Number Of Teams)) - 0.12)), 0)
V Route B1 Price Sensitivity Normal = 1.5
V Route B1 Price Attractiveness Normal[Team] = (ARRAYAVG(Route B1 Middling of Price) / Route B1 Middling of Price) ^ Route B1 Price Sensitivity Normal
V Route B1 Price Market Share Normal[Team] = (Route B1 Price Attractiveness Normal / ARRAYSUM(Route B1 Price Attractiveness Normal))

V Route B1 Price Sensitivity Luxury = 1.001
V Route B1 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route B1 Price Luxury Number Of Teams))) ^ Route B1 Price Sensitivity Luxury)
V Route B1 Price Market Share Luxury[Team] = (Route B1 Price Attractiveness Luxury / ARRAYSUM(Route B1 Price Attractiveness Luxury))

V Route B1 Price Overall Market Share[Team] = IF(Price Structure = 1, Route B1 Price Market Share Economy, IF(Price Structure = 2, Route B1 Price Market Share Normal, Route B1 Price Market Share Luxury))

## Route Expenses ##

V Route B1 Opening Expense[Team] = IF(PREVIOUS(Route B1 Online = 0) & Route B1 Online = 1, Route Const Opening New Route Expense, 0) 

V Route B1 Fuel Expenses Airplane Model 1[Team] = Route B1 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route B1 Fuel Expenses Airplane Model 2[Team] = Route B1 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route B1 Fuel Expenses Airplane Model 3[Team] = Route B1 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route B1 Fuel Expenses Airplane Model 4[Team] = Route B1 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route B1 Fuel Expenses Airplane Model 5[Team] = Route B1 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route B1 Fuel Expenses Airplane Model 6[Team] = Route B1 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route B1 Fuel Expenses Airplane Model 7[Team] = Route B1 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route B1 Total Fuel Expenses[Team] = Route B1 Fuel Expenses Airplane Model 1 + Route B1 Fuel Expenses Airplane Model 2 + Route B1 Fuel Expenses Airplane Model 3 + Route B1 Fuel Expenses Airplane Model 4 + Route B1 Fuel Expenses Airplane Model 5 + Route B1 Fuel Expenses Airplane Model 6 + Route B1 Fuel Expenses Airplane Model 7 


### Route B2 ###

V Route B2 Roundtrip Distance Planned[Team] = Market B Roundtrip Distance * IF(Route B2 Online = 1,Route B2 Return Trips, 0)

## Route B2 Establishment ########
V Route B2 Demand For Teams[3] = {Market B Demand[1] + ((SQRT(Market B Demand[1] / 10 * Route B2 Num Of Teams[1])) * 10), Market B Demand[2] + ((SQRT(Market B Demand[2] / 10 * Route B2 Num Of Teams[2])) * 10), Market B Demand[3] + ((SQRT(Market B Demand[3] / 10 * Route B2 Num Of Teams[3])) * 10)}
D Route B2 Online[Team] = 0
P Route B2 Online.ExecuteDecisionImmediately = true

#V Route B2 Opening Expense[Team] = IF(PREVIOUS(Route B2 Online = 0) & Route B2 Online = 1, Route Const Opening New Route Expense, 0) 

V Route B2 Online Economy[Team] = IF(Route B2 Online = 1 & Price Structure = 1, 1, 0)
V Route B2 Online Normal[Team] = IF(Route B2 Online = 1 & Price Structure = 2, 1, 0)
V Route B2 Online Luxury[Team] = IF(Route B2 Online = 1 & Price Structure = 3, 1, 0)

V Route B2 First Quarter Online[Team] = REMEMBER((Route B2 Online = 1) & (PREVIOUS(Route B2 Online) = 0), STEP)
V Route B2 Number Of Quarters Online[Team] = IF(Route B2 Online = 1, STEP - Route B2 First Quarter Online + 1, 0)
V Route B2 Num Of Teams[3] = {ARRAYSUM(Route B2 Online Economy), ARRAYSUM(Route B2 Online Normal), ARRAYSUM(Route B2 Online Luxury)}

V Route B2 Attractiveness[Team] = IF(Route B2 Number Of Quarters Online = 1, 1, SQRT(Route B2 Number Of Quarters Online) + Route B2 Number Of Quarters Online)

V Route B2 Attractiveness Economy[Team] = IF(Route B2 Online = 1 & Price Structure = 1, Route B2 Attractiveness, 0)
V Route B2 Attractiveness Normal[Team] = IF(Route B2 Online = 1 & Price Structure = 2, Route B2 Attractiveness, 0)
V Route B2 Attractiveness Luxury[Team] = IF(Route B2 Online = 1 & Price Structure = 3, Route B2 Attractiveness, 0)

V Route B2 Market Share[Team] = (Route B2 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route B2 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route B2 Attractiveness Normal), ARRAYSUM(Route B2 Attractiveness Luxury))))
V Route B2 Total Market Share[Team] = IF(Route B2 Online = 0, 0, (0.5 * Route B2 Market Share ) + (0.2 * Route B2 Return Trips Market Share) + (0.3 * Route B2 Price Overall Market Share))
V Route B2 Market Share For Customers[Team] = Route B2 Total Market Share * (IF(Price Structure = 1, Route B2 Demand For Teams[1], IF(Price Structure = 2, Route B2 Demand For Teams[2], Route B2 Demand For Teams[3])))

V Route B2 Sales[Team] = Route B2 Total Market Share * (IF(Price Structure = 1, Route B2 Demand For Teams[1], IF(Price Structure = 2, Route B2 Demand For Teams[2], Route B2 Demand For Teams[3])))

V Route B2 Final Sales[Team] = IF(Route B2 Sales > Route B2 Seat Supply, Route B2 Seat Supply, Route B2 Sales)

V Route B2 Revenue Passenger Kms[Team] = Route B2 Final Sales * Market B Roundtrip Distance

# Route Trips
D Route B2 Return Trips[Team] = 0
P Route B2 Return Trips.ExecuteDecisionImmediately = true
V Route B2 Return Trips Previ[Team] = PREVIOUS(Route B2 Return Trips, 0)
V Route B2 Return Trips Sensitivity = 1.5

V Route B2 Average Number Of Trips = IF(ARRAYSUM(Route B2 Online) = 0, 0, ARRAYSUM(Route B2 Return Trips) / ARRAYSUM(Route B2 Online))
V Route B2 Average Number Of Trips Previ = PREVIOUS(Route B2 Average Number Of Trips, 0)

V Route B2 Return Trips Economy[Team] = IF(Route B2 Online = 1 & Price Structure = 1, Route B2 Return Trips, 0)
V Route B2 Return Trips Normal[Team] = IF(Route B2 Online = 1 & Price Structure = 2, Route B2 Return Trips, 0)
V Route B2 Return Trips Luxury[Team] = IF(Route B2 Online = 1 & Price Structure = 3, Route B2 Return Trips, 0)

V Route B2 Return Trips Attractiveness[Team] = (Route B2 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route B2 Return Trips Economy) / Route B2 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route B2 Return Trips Normal) / Route B2 Num Of Teams[2], ARRAYSUM(Route B2 Return Trips Luxury) / Route B2 Num Of Teams[3]))) ^ Route B2 Return Trips Sensitivity

V Route B2 Return Trips Attractiveness Economy[Team] = IF(Route B2 Online = 1 & Price Structure = 1, Route B2 Return Trips Attractiveness, 0)
V Route B2 Return Trips Attractiveness Normal[Team] = IF(Route B2 Online = 1 & Price Structure = 2, Route B2 Return Trips Attractiveness, 0)
V Route B2 Return Trips Attractiveness Luxury[Team] = IF(Route B2 Online = 1 & Price Structure = 3, Route B2 Return Trips Attractiveness, 0)

V Route B2 Return Trips Market Share[Team] = (Route B2 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route B2 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route B2 Return Trips Attractiveness Normal), ARRAYSUM(Route B2 Return Trips Attractiveness Luxury))))

V Route B2 Seat Supply[Team] = Route B2 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route B2 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route B2 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route B2 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route B2 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route B2 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route B2 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route B2 Available Seat Kms[Team] = Route B2 Seat Supply * Market B Roundtrip Distance

# Route Trips By Plane #

V Route B2 Total Airplane Kms Planned[Team] = Route B2 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route B2 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route B2 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route B2 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route B2 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route B2 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route B2 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route B2 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route B2 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route B2 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route B2 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route B2 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route B2 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route B2 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route B2 Airplane Model 7 Trips)
V Z Route B2 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route B2 Return Trips - Route B2 Total Plane Trips Scheduled

D Route B2 Airplane Model 1 Trips[Team] = 0
P Route B2 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route B2 Airplane Model 1 Proposed Trips[Team] = IF(Route B2 Online = 0, 0, Route B2 Airplane Model 1 Trips)
V Route B2 Airplane Model 1 Actual Trips[Team] = IF(Route B2 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route B2 Airplane Model 1 Trips))
V Route B2 Airplane Model 1 Kms Flown Daily[Team] = Route B2 Airplane Model 1 Actual Trips * Market B Roundtrip Distance

D Route B2 Airplane Model 2 Trips[Team] = 0
P Route B2 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route B2 Airplane Model 2 Proposed Trips[Team] = IF(Route B2 Online = 0, 0, Route B2 Airplane Model 2 Trips)
V Route B2 Airplane Model 2 Actual Trips[Team] = IF(Route B2 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route B2 Airplane Model 2 Trips))
V Route B2 Airplane Model 2 Kms Flown Daily[Team] = Route B2 Airplane Model 2 Actual Trips * Market B Roundtrip Distance

D Route B2 Airplane Model 3 Trips[Team] = 0
P Route B2 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route B2 Airplane Model 3 Proposed Trips[Team] = IF(Route B2 Online = 0, 0, Route B2 Airplane Model 3 Trips)
V Route B2 Airplane Model 3 Actual Trips[Team] = IF(Route B2 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route B2 Airplane Model 3 Trips))
V Route B2 Airplane Model 3 Kms Flown Daily[Team] = Route B2 Airplane Model 3 Actual Trips * Market B Roundtrip Distance

D Route B2 Airplane Model 4 Trips[Team] = 0
P Route B2 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route B2 Airplane Model 4 Proposed Trips[Team] = IF(Route B2 Online = 0, 0, Route B2 Airplane Model 4 Trips)
V Route B2 Airplane Model 4 Actual Trips[Team] = IF(Route B2 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route B2 Airplane Model 4 Trips))
V Route B2 Airplane Model 4 Kms Flown Daily[Team] = Route B2 Airplane Model 4 Actual Trips * Market B Roundtrip Distance

D Route B2 Airplane Model 5 Trips[Team] = 0
P Route B2 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route B2 Airplane Model 5 Proposed Trips[Team] = IF(Route B2 Online = 0, 0, Route B2 Airplane Model 5 Trips)
V Route B2 Airplane Model 5 Actual Trips[Team] = IF(Route B2 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route B2 Airplane Model 5 Trips))
V Route B2 Airplane Model 5 Kms Flown Daily[Team] = Route B2 Airplane Model 5 Actual Trips * Market B Roundtrip Distance

D Route B2 Airplane Model 6 Trips[Team] = 0
P Route B2 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route B2 Airplane Model 6 Proposed Trips[Team] = IF(Route B2 Online = 0, 0, Route B2 Airplane Model 6 Trips)
V Route B2 Airplane Model 6 Actual Trips[Team] = IF(Route B2 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route B2 Airplane Model 6 Trips))
V Route B2 Airplane Model 6 Kms Flown Daily[Team] = Route B2 Airplane Model 6 Actual Trips * Market B Roundtrip Distance

D Route B2 Airplane Model 7 Trips[Team] = 0
P Route B2 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route B2 Airplane Model 7 Proposed Trips[Team] = IF(Route B2 Online = 0, 0, Route B2 Airplane Model 7 Trips)
V Route B2 Airplane Model 7 Actual Trips[Team] = IF(Route B2 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route B2 Airplane Model 7 Trips))
V Route B2 Airplane Model 7 Kms Flown Daily[Team] = Route B2 Airplane Model 7 Actual Trips * Market B Roundtrip Distance


## Route Pricing ##

V Route B2 Price Economy Number Of Teams[Team] = IF(Route B2 Online = 1 & Price Structure = 1, 1, 0)
V Route B2 Price Normal Number Of Teams[Team] = IF(Route B2 Online = 1 & Price Structure = 2, 1, 0)
V Route B2 Price Luxury Number Of Teams[Team] = IF(Route B2 Online = 1 & Price Structure = 3, 1, 0)

V Route B2 Price Sensitivity Economy = 1.001
V Route B2 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route B2 Price Economy Number Of Teams)) / Price Economy) ^ Route B2 Price Sensitivity Economy)
V Route B2 Price Market Share Economy[Team] = (Route B2 Price Attractiveness Economy / ARRAYSUM(Route B2 Price Attractiveness Economy))

V Route B2 Middling of Price[Team] = IF(Route B2 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route B2 Price Normal Number Of Teams)) - 0.12)), 0)
V Route B2 Price Sensitivity Normal = 1.5
V Route B2 Price Attractiveness Normal[Team] = (ARRAYAVG(Route B2 Middling of Price) / Route B2 Middling of Price) ^ Route B2 Price Sensitivity Normal
V Route B2 Price Market Share Normal[Team] = (Route B2 Price Attractiveness Normal / ARRAYSUM(Route B2 Price Attractiveness Normal))

V Route B2 Price Sensitivity Luxury = 1.001
V Route B2 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route B2 Price Luxury Number Of Teams))) ^ Route B2 Price Sensitivity Luxury)
V Route B2 Price Market Share Luxury[Team] = (Route B2 Price Attractiveness Luxury / ARRAYSUM(Route B2 Price Attractiveness Luxury))

V Route B2 Price Overall Market Share[Team] = IF(Price Structure = 1, Route B2 Price Market Share Economy, IF(Price Structure = 2, Route B2 Price Market Share Normal, Route B2 Price Market Share Luxury))

## Route Expenses ##

V Route B2 Opening Expense[Team] = IF(PREVIOUS(Route B2 Online = 0) & Route B2 Online = 1, Route Const Opening New Route Expense, 0) 

V Route B2 Fuel Expenses Airplane Model 1[Team] = Route B2 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route B2 Fuel Expenses Airplane Model 2[Team] = Route B2 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route B2 Fuel Expenses Airplane Model 3[Team] = Route B2 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route B2 Fuel Expenses Airplane Model 4[Team] = Route B2 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route B2 Fuel Expenses Airplane Model 5[Team] = Route B2 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route B2 Fuel Expenses Airplane Model 6[Team] = Route B2 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route B2 Fuel Expenses Airplane Model 7[Team] = Route B2 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route B2 Total Fuel Expenses[Team] = Route B2 Fuel Expenses Airplane Model 1 + Route B2 Fuel Expenses Airplane Model 2 + Route B2 Fuel Expenses Airplane Model 3 + Route B2 Fuel Expenses Airplane Model 4 + Route B2 Fuel Expenses Airplane Model 5 + Route B2 Fuel Expenses Airplane Model 6 + Route B2 Fuel Expenses Airplane Model 7 


### Route B3 ###

V Route B3 Roundtrip Distance Planned[Team] = Market B Roundtrip Distance * IF(Route B3 Online = 1,Route B3 Return Trips, 0)

## Route B3 Establishment ########
V Route B3 Demand For Teams[3] = {Market B Demand[1] + ((SQRT(Market B Demand[1] / 10 * Route B3 Num Of Teams[1])) * 10), Market B Demand[2] + ((SQRT(Market B Demand[2] / 10 * Route B3 Num Of Teams[2])) * 10), Market B Demand[3] + ((SQRT(Market B Demand[3] / 10 * Route B3 Num Of Teams[3])) * 10)}
D Route B3 Online[Team] = 0
P Route B3 Online.ExecuteDecisionImmediately = true

#V Route B3 Opening Expense[Team] = IF(PREVIOUS(Route B3 Online = 0) & Route B3 Online = 1, Route Const Opening New Route Expense, 0) 

V Route B3 Online Economy[Team] = IF(Route B3 Online = 1 & Price Structure = 1, 1, 0)
V Route B3 Online Normal[Team] = IF(Route B3 Online = 1 & Price Structure = 2, 1, 0)
V Route B3 Online Luxury[Team] = IF(Route B3 Online = 1 & Price Structure = 3, 1, 0)

V Route B3 First Quarter Online[Team] = REMEMBER((Route B3 Online = 1) & (PREVIOUS(Route B3 Online) = 0), STEP)
V Route B3 Number Of Quarters Online[Team] = IF(Route B3 Online = 1, STEP - Route B3 First Quarter Online + 1, 0)
V Route B3 Num Of Teams[3] = {ARRAYSUM(Route B3 Online Economy), ARRAYSUM(Route B3 Online Normal), ARRAYSUM(Route B3 Online Luxury)}

V Route B3 Attractiveness[Team] = IF(Route B3 Number Of Quarters Online = 1, 1, SQRT(Route B3 Number Of Quarters Online) + Route B3 Number Of Quarters Online)

V Route B3 Attractiveness Economy[Team] = IF(Route B3 Online = 1 & Price Structure = 1, Route B3 Attractiveness, 0)
V Route B3 Attractiveness Normal[Team] = IF(Route B3 Online = 1 & Price Structure = 2, Route B3 Attractiveness, 0)
V Route B3 Attractiveness Luxury[Team] = IF(Route B3 Online = 1 & Price Structure = 3, Route B3 Attractiveness, 0)

V Route B3 Market Share[Team] = (Route B3 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route B3 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route B3 Attractiveness Normal), ARRAYSUM(Route B3 Attractiveness Luxury))))
V Route B3 Total Market Share[Team] = IF(Route B3 Online = 0, 0, (0.5 * Route B3 Market Share ) + (0.2 * Route B3 Return Trips Market Share) + (0.3 * Route B3 Price Overall Market Share))
V Route B3 Market Share For Customers[Team] = Route B3 Total Market Share * (IF(Price Structure = 1, Route B3 Demand For Teams[1], IF(Price Structure = 2, Route B3 Demand For Teams[2], Route B3 Demand For Teams[3])))

V Route B3 Sales[Team] = Route B3 Total Market Share * (IF(Price Structure = 1, Route B3 Demand For Teams[1], IF(Price Structure = 2, Route B3 Demand For Teams[2], Route B3 Demand For Teams[3])))

V Route B3 Final Sales[Team] = IF(Route B3 Sales > Route B3 Seat Supply, Route B3 Seat Supply, Route B3 Sales)

V Route B3 Revenue Passenger Kms[Team] = Route B3 Final Sales * Market B Roundtrip Distance

# Route Trips
D Route B3 Return Trips[Team] = 0
P Route B3 Return Trips.ExecuteDecisionImmediately = true
V Route B3 Return Trips Previ[Team] = PREVIOUS(Route B3 Return Trips, 0)
V Route B3 Return Trips Sensitivity = 1.5

V Route B3 Average Number Of Trips = IF(ARRAYSUM(Route B3 Online) = 0, 0, ARRAYSUM(Route B3 Return Trips) / ARRAYSUM(Route B3 Online))
V Route B3 Average Number Of Trips Previ = PREVIOUS(Route B3 Average Number Of Trips, 0)

V Route B3 Return Trips Economy[Team] = IF(Route B3 Online = 1 & Price Structure = 1, Route B3 Return Trips, 0)
V Route B3 Return Trips Normal[Team] = IF(Route B3 Online = 1 & Price Structure = 2, Route B3 Return Trips, 0)
V Route B3 Return Trips Luxury[Team] = IF(Route B3 Online = 1 & Price Structure = 3, Route B3 Return Trips, 0)

V Route B3 Return Trips Attractiveness[Team] = (Route B3 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route B3 Return Trips Economy) / Route B3 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route B3 Return Trips Normal) / Route B3 Num Of Teams[2], ARRAYSUM(Route B3 Return Trips Luxury) / Route B3 Num Of Teams[3]))) ^ Route B3 Return Trips Sensitivity

V Route B3 Return Trips Attractiveness Economy[Team] = IF(Route B3 Online = 1 & Price Structure = 1, Route B3 Return Trips Attractiveness, 0)
V Route B3 Return Trips Attractiveness Normal[Team] = IF(Route B3 Online = 1 & Price Structure = 2, Route B3 Return Trips Attractiveness, 0)
V Route B3 Return Trips Attractiveness Luxury[Team] = IF(Route B3 Online = 1 & Price Structure = 3, Route B3 Return Trips Attractiveness, 0)

V Route B3 Return Trips Market Share[Team] = (Route B3 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route B3 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route B3 Return Trips Attractiveness Normal), ARRAYSUM(Route B3 Return Trips Attractiveness Luxury))))

V Route B3 Seat Supply[Team] = Route B3 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route B3 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route B3 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route B3 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route B3 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route B3 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route B3 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route B3 Available Seat Kms[Team] = Route B3 Seat Supply * Market B Roundtrip Distance

# Route Trips By Plane #

V Route B3 Total Airplane Kms Planned[Team] = Route B3 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route B3 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route B3 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route B3 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route B3 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route B3 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route B3 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route B3 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route B3 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route B3 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route B3 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route B3 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route B3 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route B3 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route B3 Airplane Model 7 Trips)
V Z Route B3 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route B3 Return Trips - Route B3 Total Plane Trips Scheduled

D Route B3 Airplane Model 1 Trips[Team] = 0
P Route B3 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route B3 Airplane Model 1 Proposed Trips[Team] = IF(Route B3 Online = 0, 0, Route B3 Airplane Model 1 Trips)
V Route B3 Airplane Model 1 Actual Trips[Team] = IF(Route B3 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route B3 Airplane Model 1 Trips))
V Route B3 Airplane Model 1 Kms Flown Daily[Team] = Route B3 Airplane Model 1 Actual Trips * Market B Roundtrip Distance

D Route B3 Airplane Model 2 Trips[Team] = 0
P Route B3 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route B3 Airplane Model 2 Proposed Trips[Team] = IF(Route B3 Online = 0, 0, Route B3 Airplane Model 2 Trips)
V Route B3 Airplane Model 2 Actual Trips[Team] = IF(Route B3 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route B3 Airplane Model 2 Trips))
V Route B3 Airplane Model 2 Kms Flown Daily[Team] = Route B3 Airplane Model 2 Actual Trips * Market B Roundtrip Distance

D Route B3 Airplane Model 3 Trips[Team] = 0
P Route B3 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route B3 Airplane Model 3 Proposed Trips[Team] = IF(Route B3 Online = 0, 0, Route B3 Airplane Model 3 Trips)
V Route B3 Airplane Model 3 Actual Trips[Team] = IF(Route B3 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route B3 Airplane Model 3 Trips))
V Route B3 Airplane Model 3 Kms Flown Daily[Team] = Route B3 Airplane Model 3 Actual Trips * Market B Roundtrip Distance

D Route B3 Airplane Model 4 Trips[Team] = 0
P Route B3 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route B3 Airplane Model 4 Proposed Trips[Team] = IF(Route B3 Online = 0, 0, Route B3 Airplane Model 4 Trips)
V Route B3 Airplane Model 4 Actual Trips[Team] = IF(Route B3 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route B3 Airplane Model 4 Trips))
V Route B3 Airplane Model 4 Kms Flown Daily[Team] = Route B3 Airplane Model 4 Actual Trips * Market B Roundtrip Distance

D Route B3 Airplane Model 5 Trips[Team] = 0
P Route B3 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route B3 Airplane Model 5 Proposed Trips[Team] = IF(Route B3 Online = 0, 0, Route B3 Airplane Model 5 Trips)
V Route B3 Airplane Model 5 Actual Trips[Team] = IF(Route B3 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route B3 Airplane Model 5 Trips))
V Route B3 Airplane Model 5 Kms Flown Daily[Team] = Route B3 Airplane Model 5 Actual Trips * Market B Roundtrip Distance

D Route B3 Airplane Model 6 Trips[Team] = 0
P Route B3 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route B3 Airplane Model 6 Proposed Trips[Team] = IF(Route B3 Online = 0, 0, Route B3 Airplane Model 6 Trips)
V Route B3 Airplane Model 6 Actual Trips[Team] = IF(Route B3 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route B3 Airplane Model 6 Trips))
V Route B3 Airplane Model 6 Kms Flown Daily[Team] = Route B3 Airplane Model 6 Actual Trips * Market B Roundtrip Distance

D Route B3 Airplane Model 7 Trips[Team] = 0
P Route B3 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route B3 Airplane Model 7 Proposed Trips[Team] = IF(Route B3 Online = 0, 0, Route B3 Airplane Model 7 Trips)
V Route B3 Airplane Model 7 Actual Trips[Team] = IF(Route B3 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route B3 Airplane Model 7 Trips))
V Route B3 Airplane Model 7 Kms Flown Daily[Team] = Route B3 Airplane Model 7 Actual Trips * Market B Roundtrip Distance


## Route Pricing ##

V Route B3 Price Economy Number Of Teams[Team] = IF(Route B3 Online = 1 & Price Structure = 1, 1, 0)
V Route B3 Price Normal Number Of Teams[Team] = IF(Route B3 Online = 1 & Price Structure = 2, 1, 0)
V Route B3 Price Luxury Number Of Teams[Team] = IF(Route B3 Online = 1 & Price Structure = 3, 1, 0)

V Route B3 Price Sensitivity Economy = 1.001
V Route B3 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route B3 Price Economy Number Of Teams)) / Price Economy) ^ Route B3 Price Sensitivity Economy)
V Route B3 Price Market Share Economy[Team] = (Route B3 Price Attractiveness Economy / ARRAYSUM(Route B3 Price Attractiveness Economy))

V Route B3 Middling of Price[Team] = IF(Route B3 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route B3 Price Normal Number Of Teams)) - 0.12)), 0)
V Route B3 Price Sensitivity Normal = 1.5
V Route B3 Price Attractiveness Normal[Team] = (ARRAYAVG(Route B3 Middling of Price) / Route B3 Middling of Price) ^ Route B3 Price Sensitivity Normal
V Route B3 Price Market Share Normal[Team] = (Route B3 Price Attractiveness Normal / ARRAYSUM(Route B3 Price Attractiveness Normal))

V Route B3 Price Sensitivity Luxury = 1.001
V Route B3 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route B3 Price Luxury Number Of Teams))) ^ Route B3 Price Sensitivity Luxury)
V Route B3 Price Market Share Luxury[Team] = (Route B3 Price Attractiveness Luxury / ARRAYSUM(Route B3 Price Attractiveness Luxury))

V Route B3 Price Overall Market Share[Team] = IF(Price Structure = 1, Route B3 Price Market Share Economy, IF(Price Structure = 2, Route B3 Price Market Share Normal, Route B3 Price Market Share Luxury))

## Route Expenses ##

V Route B3 Opening Expense[Team] = IF(PREVIOUS(Route B3 Online = 0) & Route B3 Online = 1, Route Const Opening New Route Expense, 0) 

V Route B3 Fuel Expenses Airplane Model 1[Team] = Route B3 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route B3 Fuel Expenses Airplane Model 2[Team] = Route B3 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route B3 Fuel Expenses Airplane Model 3[Team] = Route B3 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route B3 Fuel Expenses Airplane Model 4[Team] = Route B3 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route B3 Fuel Expenses Airplane Model 5[Team] = Route B3 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route B3 Fuel Expenses Airplane Model 6[Team] = Route B3 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route B3 Fuel Expenses Airplane Model 7[Team] = Route B3 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route B3 Total Fuel Expenses[Team] = Route B3 Fuel Expenses Airplane Model 1 + Route B3 Fuel Expenses Airplane Model 2 + Route B3 Fuel Expenses Airplane Model 3 + Route B3 Fuel Expenses Airplane Model 4 + Route B3 Fuel Expenses Airplane Model 5 + Route B3 Fuel Expenses Airplane Model 6 + Route B3 Fuel Expenses Airplane Model 7 


### Route B4 ###

V Route B4 Roundtrip Distance Planned[Team] = Market B Roundtrip Distance * IF(Route B1 Online = 1,Route B1 Return Trips, 0)

## Route B4 Establishment ########
V Route B4 Demand For Teams[3] = {Market B Demand[1] + ((SQRT(Market B Demand[1] / 10 * Route B4 Num Of Teams[1])) * 10), Market B Demand[2] + ((SQRT(Market B Demand[2] / 10 * Route B4 Num Of Teams[2])) * 10), Market B Demand[3] + ((SQRT(Market B Demand[3] / 10 * Route B4 Num Of Teams[3])) * 10)}
D Route B4 Online[Team] = 0
P Route B4 Online.ExecuteDecisionImmediately = true

#V Route B4 Opening Expense[Team] = IF(PREVIOUS(Route B4 Online = 0) & Route B4 Online = 1, Route Const Opening New Route Expense, 0) 

V Route B4 Online Economy[Team] = IF(Route B4 Online = 1 & Price Structure = 1, 1, 0)
V Route B4 Online Normal[Team] = IF(Route B4 Online = 1 & Price Structure = 2, 1, 0)
V Route B4 Online Luxury[Team] = IF(Route B4 Online = 1 & Price Structure = 3, 1, 0)

V Route B4 First Quarter Online[Team] = REMEMBER((Route B4 Online = 1) & (PREVIOUS(Route B4 Online) = 0), STEP)
V Route B4 Number Of Quarters Online[Team] = IF(Route B4 Online = 1, STEP - Route B4 First Quarter Online + 1, 0)
V Route B4 Num Of Teams[3] = {ARRAYSUM(Route B4 Online Economy), ARRAYSUM(Route B4 Online Normal), ARRAYSUM(Route B4 Online Luxury)}

V Route B4 Attractiveness[Team] = IF(Route B4 Number Of Quarters Online = 1, 1, SQRT(Route B4 Number Of Quarters Online) + Route B4 Number Of Quarters Online)

V Route B4 Attractiveness Economy[Team] = IF(Route B4 Online = 1 & Price Structure = 1, Route B4 Attractiveness, 0)
V Route B4 Attractiveness Normal[Team] = IF(Route B4 Online = 1 & Price Structure = 2, Route B4 Attractiveness, 0)
V Route B4 Attractiveness Luxury[Team] = IF(Route B4 Online = 1 & Price Structure = 3, Route B4 Attractiveness, 0)

V Route B4 Market Share[Team] = (Route B4 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route B4 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route B4 Attractiveness Normal), ARRAYSUM(Route B4 Attractiveness Luxury))))
V Route B4 Total Market Share[Team] = IF(Route B4 Online = 0, 0, (0.5 * Route B4 Market Share ) + (0.2 * Route B4 Return Trips Market Share) + (0.3 * Route B4 Price Overall Market Share))
V Route B4 Market Share For Customers[Team] = Route B4 Total Market Share * (IF(Price Structure = 1, Route B4 Demand For Teams[1], IF(Price Structure = 2, Route B4 Demand For Teams[2], Route B4 Demand For Teams[3])))

V Route B4 Sales[Team] = Route B4 Total Market Share * (IF(Price Structure = 1, Route B4 Demand For Teams[1], IF(Price Structure = 2, Route B4 Demand For Teams[2], Route B4 Demand For Teams[3])))

V Route B4 Final Sales[Team] = IF(Route B4 Sales > Route B4 Seat Supply, Route B4 Seat Supply, Route B4 Sales)

V Route B4 Revenue Passenger Kms[Team] = Route B4 Final Sales * Market B Roundtrip Distance

# Route Trips
D Route B4 Return Trips[Team] = 0
P Route B4 Return Trips.ExecuteDecisionImmediately = true
V Route B4 Return Trips Previ[Team] = PREVIOUS(Route B4 Return Trips, 0)
V Route B4 Return Trips Sensitivity = 1.5

V Route B4 Average Number Of Trips = IF(ARRAYSUM(Route B4 Online) = 0, 0, ARRAYSUM(Route B4 Return Trips) / ARRAYSUM(Route B4 Online))
V Route B4 Average Number Of Trips Previ = PREVIOUS(Route B4 Average Number Of Trips, 0)

V Route B4 Return Trips Economy[Team] = IF(Route B4 Online = 1 & Price Structure = 1, Route B4 Return Trips, 0)
V Route B4 Return Trips Normal[Team] = IF(Route B4 Online = 1 & Price Structure = 2, Route B4 Return Trips, 0)
V Route B4 Return Trips Luxury[Team] = IF(Route B4 Online = 1 & Price Structure = 3, Route B4 Return Trips, 0)

V Route B4 Return Trips Attractiveness[Team] = (Route B4 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route B4 Return Trips Economy) / Route B4 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route B4 Return Trips Normal) / Route B4 Num Of Teams[2], ARRAYSUM(Route B4 Return Trips Luxury) / Route B4 Num Of Teams[3]))) ^ Route B4 Return Trips Sensitivity

V Route B4 Return Trips Attractiveness Economy[Team] = IF(Route B4 Online = 1 & Price Structure = 1, Route B4 Return Trips Attractiveness, 0)
V Route B4 Return Trips Attractiveness Normal[Team] = IF(Route B4 Online = 1 & Price Structure = 2, Route B4 Return Trips Attractiveness, 0)
V Route B4 Return Trips Attractiveness Luxury[Team] = IF(Route B4 Online = 1 & Price Structure = 3, Route B4 Return Trips Attractiveness, 0)

V Route B4 Return Trips Market Share[Team] = (Route B4 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route B4 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route B4 Return Trips Attractiveness Normal), ARRAYSUM(Route B4 Return Trips Attractiveness Luxury))))

V Route B4 Seat Supply[Team] = Route B4 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route B4 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route B4 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route B4 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route B4 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route B4 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route B4 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route B4 Available Seat Kms[Team] = Route B4 Seat Supply * Market B Roundtrip Distance

# Route Trips By Plane #

V Route B4 Total Airplane Kms Planned[Team] = Route B4 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route B4 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route B4 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route B4 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route B4 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route B4 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route B4 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route B4 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route B4 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route B4 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route B4 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route B4 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route B4 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route B4 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route B4 Airplane Model 7 Trips)
V Z Route B4 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route B4 Return Trips - Route B4 Total Plane Trips Scheduled

D Route B4 Airplane Model 1 Trips[Team] = 0
P Route B4 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route B4 Airplane Model 1 Proposed Trips[Team] = IF(Route B4 Online = 0, 0, Route B4 Airplane Model 1 Trips)
V Route B4 Airplane Model 1 Actual Trips[Team] = IF(Route B4 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route B4 Airplane Model 1 Trips))
V Route B4 Airplane Model 1 Kms Flown Daily[Team] = Route B4 Airplane Model 1 Actual Trips * Market B Roundtrip Distance

D Route B4 Airplane Model 2 Trips[Team] = 0
P Route B4 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route B4 Airplane Model 2 Proposed Trips[Team] = IF(Route B4 Online = 0, 0, Route B4 Airplane Model 2 Trips)
V Route B4 Airplane Model 2 Actual Trips[Team] = IF(Route B4 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route B4 Airplane Model 2 Trips))
V Route B4 Airplane Model 2 Kms Flown Daily[Team] = Route B4 Airplane Model 2 Actual Trips * Market B Roundtrip Distance

D Route B4 Airplane Model 3 Trips[Team] = 0
P Route B4 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route B4 Airplane Model 3 Proposed Trips[Team] = IF(Route B4 Online = 0, 0, Route B4 Airplane Model 3 Trips)
V Route B4 Airplane Model 3 Actual Trips[Team] = IF(Route B4 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route B4 Airplane Model 3 Trips))
V Route B4 Airplane Model 3 Kms Flown Daily[Team] = Route B4 Airplane Model 3 Actual Trips * Market B Roundtrip Distance

D Route B4 Airplane Model 4 Trips[Team] = 0
P Route B4 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route B4 Airplane Model 4 Proposed Trips[Team] = IF(Route B4 Online = 0, 0, Route B4 Airplane Model 4 Trips)
V Route B4 Airplane Model 4 Actual Trips[Team] = IF(Route B4 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route B4 Airplane Model 4 Trips))
V Route B4 Airplane Model 4 Kms Flown Daily[Team] = Route B4 Airplane Model 4 Actual Trips * Market B Roundtrip Distance

D Route B4 Airplane Model 5 Trips[Team] = 0
P Route B4 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route B4 Airplane Model 5 Proposed Trips[Team] = IF(Route B4 Online = 0, 0, Route B4 Airplane Model 5 Trips)
V Route B4 Airplane Model 5 Actual Trips[Team] = IF(Route B4 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route B4 Airplane Model 5 Trips))
V Route B4 Airplane Model 5 Kms Flown Daily[Team] = Route B4 Airplane Model 5 Actual Trips * Market B Roundtrip Distance

D Route B4 Airplane Model 6 Trips[Team] = 0
P Route B4 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route B4 Airplane Model 6 Proposed Trips[Team] = IF(Route B4 Online = 0, 0, Route B4 Airplane Model 6 Trips)
V Route B4 Airplane Model 6 Actual Trips[Team] = IF(Route B4 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route B4 Airplane Model 6 Trips))
V Route B4 Airplane Model 6 Kms Flown Daily[Team] = Route B4 Airplane Model 6 Actual Trips * Market B Roundtrip Distance

D Route B4 Airplane Model 7 Trips[Team] = 0
P Route B4 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route B4 Airplane Model 7 Proposed Trips[Team] = IF(Route B4 Online = 0, 0, Route B4 Airplane Model 7 Trips)
V Route B4 Airplane Model 7 Actual Trips[Team] = IF(Route B4 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route B4 Airplane Model 7 Trips))
V Route B4 Airplane Model 7 Kms Flown Daily[Team] = Route B4 Airplane Model 7 Actual Trips * Market B Roundtrip Distance


## Route Pricing ##

V Route B4 Price Economy Number Of Teams[Team] = IF(Route B4 Online = 1 & Price Structure = 1, 1, 0)
V Route B4 Price Normal Number Of Teams[Team] = IF(Route B4 Online = 1 & Price Structure = 2, 1, 0)
V Route B4 Price Luxury Number Of Teams[Team] = IF(Route B4 Online = 1 & Price Structure = 3, 1, 0)

V Route B4 Price Sensitivity Economy = 1.001
V Route B4 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route B4 Price Economy Number Of Teams)) / Price Economy) ^ Route B4 Price Sensitivity Economy)
V Route B4 Price Market Share Economy[Team] = (Route B4 Price Attractiveness Economy / ARRAYSUM(Route B4 Price Attractiveness Economy))

V Route B4 Middling of Price[Team] = IF(Route B4 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route B4 Price Normal Number Of Teams)) - 0.12)), 0)
V Route B4 Price Sensitivity Normal = 1.5
V Route B4 Price Attractiveness Normal[Team] = (ARRAYAVG(Route B4 Middling of Price) / Route B4 Middling of Price) ^ Route B4 Price Sensitivity Normal
V Route B4 Price Market Share Normal[Team] = (Route B4 Price Attractiveness Normal / ARRAYSUM(Route B4 Price Attractiveness Normal))

V Route B4 Price Sensitivity Luxury = 1.001
V Route B4 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route B4 Price Luxury Number Of Teams))) ^ Route B4 Price Sensitivity Luxury)
V Route B4 Price Market Share Luxury[Team] = (Route B4 Price Attractiveness Luxury / ARRAYSUM(Route B4 Price Attractiveness Luxury))

V Route B4 Price Overall Market Share[Team] = IF(Price Structure = 1, Route B4 Price Market Share Economy, IF(Price Structure = 2, Route B4 Price Market Share Normal, Route B4 Price Market Share Luxury))

## Route Expenses ##

V Route B4 Opening Expense[Team] = IF(PREVIOUS(Route B4 Online = 0) & Route B4 Online = 1, Route Const Opening New Route Expense, 0) 

V Route B4 Fuel Expenses Airplane Model 1[Team] = Route B4 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route B4 Fuel Expenses Airplane Model 2[Team] = Route B4 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route B4 Fuel Expenses Airplane Model 3[Team] = Route B4 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route B4 Fuel Expenses Airplane Model 4[Team] = Route B4 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route B4 Fuel Expenses Airplane Model 5[Team] = Route B4 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route B4 Fuel Expenses Airplane Model 6[Team] = Route B4 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route B4 Fuel Expenses Airplane Model 7[Team] = Route B4 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route B4 Total Fuel Expenses[Team] = Route B4 Fuel Expenses Airplane Model 1 + Route B4 Fuel Expenses Airplane Model 2 + Route B4 Fuel Expenses Airplane Model 3 + Route B4 Fuel Expenses Airplane Model 4 + Route B4 Fuel Expenses Airplane Model 5 + Route B4 Fuel Expenses Airplane Model 6 + Route B4 Fuel Expenses Airplane Model 7 


### Route B5 ###

V Route B5 Roundtrip Distance Planned[Team] = Market B Roundtrip Distance * IF(Route B5 Online = 1,Route B5 Return Trips, 0)

## Route B5 Establishment ########
V Route B5 Demand For Teams[3] = {Market B Demand[1] + ((SQRT(Market B Demand[1] / 10 * Route B5 Num Of Teams[1])) * 10), Market B Demand[2] + ((SQRT(Market B Demand[2] / 10 * Route B5 Num Of Teams[2])) * 10), Market B Demand[3] + ((SQRT(Market B Demand[3] / 10 * Route B5 Num Of Teams[3])) * 10)}
D Route B5 Online[Team] = 0
P Route B5 Online.ExecuteDecisionImmediately = true

#V Route B5 Opening Expense[Team] = IF(PREVIOUS(Route B5 Online = 0) & Route B5 Online = 1, Route Const Opening New Route Expense, 0) 

V Route B5 Online Economy[Team] = IF(Route B5 Online = 1 & Price Structure = 1, 1, 0)
V Route B5 Online Normal[Team] = IF(Route B5 Online = 1 & Price Structure = 2, 1, 0)
V Route B5 Online Luxury[Team] = IF(Route B5 Online = 1 & Price Structure = 3, 1, 0)

V Route B5 First Quarter Online[Team] = REMEMBER((Route B5 Online = 1) & (PREVIOUS(Route B5 Online) = 0), STEP)
V Route B5 Number Of Quarters Online[Team] = IF(Route B5 Online = 1, STEP - Route B5 First Quarter Online + 1, 0)
V Route B5 Num Of Teams[3] = {ARRAYSUM(Route B5 Online Economy), ARRAYSUM(Route B5 Online Normal), ARRAYSUM(Route B5 Online Luxury)}

V Route B5 Attractiveness[Team] = IF(Route B5 Number Of Quarters Online = 1, 1, SQRT(Route B5 Number Of Quarters Online) + Route B5 Number Of Quarters Online)

V Route B5 Attractiveness Economy[Team] = IF(Route B5 Online = 1 & Price Structure = 1, Route B5 Attractiveness, 0)
V Route B5 Attractiveness Normal[Team] = IF(Route B5 Online = 1 & Price Structure = 2, Route B5 Attractiveness, 0)
V Route B5 Attractiveness Luxury[Team] = IF(Route B5 Online = 1 & Price Structure = 3, Route B5 Attractiveness, 0)

V Route B5 Market Share[Team] = (Route B5 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route B5 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route B5 Attractiveness Normal), ARRAYSUM(Route B5 Attractiveness Luxury))))
V Route B5 Total Market Share[Team] = IF(Route B5 Online = 0, 0, (0.5 * Route B5 Market Share ) + (0.2 * Route B5 Return Trips Market Share) + (0.3 * Route B5 Price Overall Market Share))
V Route B5 Market Share For Customers[Team] = Route B5 Total Market Share * (IF(Price Structure = 1, Route B5 Demand For Teams[1], IF(Price Structure = 2, Route B5 Demand For Teams[2], Route B5 Demand For Teams[3])))

V Route B5 Sales[Team] = Route B5 Total Market Share * (IF(Price Structure = 1, Route B5 Demand For Teams[1], IF(Price Structure = 2, Route B5 Demand For Teams[2], Route B5 Demand For Teams[3])))

V Route B5 Final Sales[Team] = IF(Route B5 Sales > Route B5 Seat Supply, Route B5 Seat Supply, Route B5 Sales)

V Route B5 Revenue Passenger Kms[Team] = Route B5 Final Sales * Market B Roundtrip Distance

# Route Trips
D Route B5 Return Trips[Team] = 0
V Route B5 Return Trips Previ[Team] = PREVIOUS(Route B5 Return Trips, 0)
P Route B5 Return Trips.ExecuteDecisionImmediately = true
V Route B5 Return Trips Sensitivity = 1.5

V Route B5 Average Number Of Trips = IF(ARRAYSUM(Route B5 Online) = 0, 0, ARRAYSUM(Route B5 Return Trips) / ARRAYSUM(Route B5 Online))
V Route B5 Average Number Of Trips Previ = PREVIOUS(Route B5 Average Number Of Trips, 0)

V Route B5 Return Trips Economy[Team] = IF(Route B5 Online = 1 & Price Structure = 1, Route B5 Return Trips, 0)
V Route B5 Return Trips Normal[Team] = IF(Route B5 Online = 1 & Price Structure = 2, Route B5 Return Trips, 0)
V Route B5 Return Trips Luxury[Team] = IF(Route B5 Online = 1 & Price Structure = 3, Route B5 Return Trips, 0)

V Route B5 Return Trips Attractiveness[Team] = (Route B5 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route B5 Return Trips Economy) / Route B5 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route B5 Return Trips Normal) / Route B5 Num Of Teams[2], ARRAYSUM(Route B5 Return Trips Luxury) / Route B5 Num Of Teams[3]))) ^ Route B5 Return Trips Sensitivity

V Route B5 Return Trips Attractiveness Economy[Team] = IF(Route B5 Online = 1 & Price Structure = 1, Route B5 Return Trips Attractiveness, 0)
V Route B5 Return Trips Attractiveness Normal[Team] = IF(Route B5 Online = 1 & Price Structure = 2, Route B5 Return Trips Attractiveness, 0)
V Route B5 Return Trips Attractiveness Luxury[Team] = IF(Route B5 Online = 1 & Price Structure = 3, Route B5 Return Trips Attractiveness, 0)

V Route B5 Return Trips Market Share[Team] = (Route B5 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route B5 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route B5 Return Trips Attractiveness Normal), ARRAYSUM(Route B5 Return Trips Attractiveness Luxury))))

V Route B5 Seat Supply[Team] = Route B5 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route B5 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route B5 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route B5 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route B5 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route B5 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route B5 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route B5 Available Seat Kms[Team] = Route B5 Seat Supply * Market B Roundtrip Distance

# Route Trips By Plane #

V Route B5 Total Airplane Kms Planned[Team] = Route B5 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route B5 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms

V Route B5 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route B5 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route B5 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route B5 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route B5 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route B5 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route B5 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route B5 Airplane Model 7 Trips)
V Z Route B5 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route B5 Return Trips - Route B5 Total Plane Trips Scheduled

D Route B5 Airplane Model 1 Trips[Team] = 0
P Route B5 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route B5 Airplane Model 1 Proposed Trips[Team] = IF(Route B5 Online = 0, 0, Route B5 Airplane Model 1 Trips)
V Route B5 Airplane Model 1 Actual Trips[Team] = IF(Route B5 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route B5 Airplane Model 1 Trips))
V Route B5 Airplane Model 1 Kms Flown Daily[Team] = Route B5 Airplane Model 1 Actual Trips * Market B Roundtrip Distance

D Route B5 Airplane Model 2 Trips[Team] = 0
P Route B5 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route B5 Airplane Model 2 Proposed Trips[Team] = IF(Route B5 Online = 0, 0, Route B5 Airplane Model 2 Trips)
V Route B5 Airplane Model 2 Actual Trips[Team] = IF(Route B5 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route B5 Airplane Model 2 Trips))
V Route B5 Airplane Model 2 Kms Flown Daily[Team] = Route B5 Airplane Model 2 Actual Trips * Market B Roundtrip Distance

D Route B5 Airplane Model 3 Trips[Team] = 0
P Route B5 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route B5 Airplane Model 3 Proposed Trips[Team] = IF(Route B5 Online = 0, 0, Route B5 Airplane Model 3 Trips)
V Route B5 Airplane Model 3 Actual Trips[Team] = IF(Route B5 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route B5 Airplane Model 3 Trips))
V Route B5 Airplane Model 3 Kms Flown Daily[Team] = Route B5 Airplane Model 3 Actual Trips * Market B Roundtrip Distance

D Route B5 Airplane Model 4 Trips[Team] = 0
P Route B5 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route B5 Airplane Model 4 Proposed Trips[Team] = IF(Route B5 Online = 0, 0, Route B5 Airplane Model 4 Trips)
V Route B5 Airplane Model 4 Actual Trips[Team] = IF(Route B5 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route B5 Airplane Model 4 Trips))
V Route B5 Airplane Model 4 Kms Flown Daily[Team] = Route B5 Airplane Model 4 Actual Trips * Market B Roundtrip Distance

D Route B5 Airplane Model 5 Trips[Team] = 0
P Route B5 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route B5 Airplane Model 5 Proposed Trips[Team] = IF(Route B5 Online = 0, 0, Route B5 Airplane Model 5 Trips)
V Route B5 Airplane Model 5 Actual Trips[Team] = IF(Route B5 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route B5 Airplane Model 5 Trips))
V Route B5 Airplane Model 5 Kms Flown Daily[Team] = Route B5 Airplane Model 5 Actual Trips * Market B Roundtrip Distance

D Route B5 Airplane Model 6 Trips[Team] = 0
P Route B5 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route B5 Airplane Model 6 Proposed Trips[Team] = IF(Route B5 Online = 0, 0, Route B5 Airplane Model 6 Trips)
V Route B5 Airplane Model 6 Actual Trips[Team] = IF(Route B5 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route B5 Airplane Model 6 Trips))
V Route B5 Airplane Model 6 Kms Flown Daily[Team] = Route B5 Airplane Model 6 Actual Trips * Market B Roundtrip Distance

D Route B5 Airplane Model 7 Trips[Team] = 0
P Route B5 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route B5 Airplane Model 7 Proposed Trips[Team] = IF(Route B5 Online = 0, 0, Route B5 Airplane Model 7 Trips)
V Route B5 Airplane Model 7 Actual Trips[Team] = IF(Route B5 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route B5 Airplane Model 7 Trips))
V Route B5 Airplane Model 7 Kms Flown Daily[Team] = Route B5 Airplane Model 7 Actual Trips * Market B Roundtrip Distance


## Route Pricing ##

V Route B5 Price Economy Number Of Teams[Team] = IF(Route B5 Online = 1 & Price Structure = 1, 1, 0)
V Route B5 Price Normal Number Of Teams[Team] = IF(Route B5 Online = 1 & Price Structure = 2, 1, 0)
V Route B5 Price Luxury Number Of Teams[Team] = IF(Route B5 Online = 1 & Price Structure = 3, 1, 0)

V Route B5 Price Sensitivity Economy = 1.001
V Route B5 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route B5 Price Economy Number Of Teams)) / Price Economy) ^ Route B5 Price Sensitivity Economy)
V Route B5 Price Market Share Economy[Team] = (Route B5 Price Attractiveness Economy / ARRAYSUM(Route B5 Price Attractiveness Economy))

V Route B5 Middling of Price[Team] = IF(Route B5 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route B5 Price Normal Number Of Teams)) - 0.12)), 0)
V Route B5 Price Sensitivity Normal = 1.5
V Route B5 Price Attractiveness Normal[Team] = (ARRAYAVG(Route B5 Middling of Price) / Route B5 Middling of Price) ^ Route B5 Price Sensitivity Normal
V Route B5 Price Market Share Normal[Team] = (Route B5 Price Attractiveness Normal / ARRAYSUM(Route B5 Price Attractiveness Normal))

V Route B5 Price Sensitivity Luxury = 1.001
V Route B5 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route B5 Price Luxury Number Of Teams))) ^ Route B5 Price Sensitivity Luxury)
V Route B5 Price Market Share Luxury[Team] = (Route B5 Price Attractiveness Luxury / ARRAYSUM(Route B5 Price Attractiveness Luxury))

V Route B5 Price Overall Market Share[Team] = IF(Price Structure = 1, Route B5 Price Market Share Economy, IF(Price Structure = 2, Route B5 Price Market Share Normal, Route B5 Price Market Share Luxury))

## Route Expenses ##

V Route B5 Opening Expense[Team] = IF(PREVIOUS(Route B5 Online = 0) & Route B5 Online = 1, Route Const Opening New Route Expense, 0) 

V Route B5 Fuel Expenses Airplane Model 1[Team] = Route B5 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route B5 Fuel Expenses Airplane Model 2[Team] = Route B5 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route B5 Fuel Expenses Airplane Model 3[Team] = Route B5 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route B5 Fuel Expenses Airplane Model 4[Team] = Route B5 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route B5 Fuel Expenses Airplane Model 5[Team] = Route B5 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route B5 Fuel Expenses Airplane Model 6[Team] = Route B5 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route B5 Fuel Expenses Airplane Model 7[Team] = Route B5 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route B5 Total Fuel Expenses[Team] = Route B5 Fuel Expenses Airplane Model 1 + Route B5 Fuel Expenses Airplane Model 2 + Route B5 Fuel Expenses Airplane Model 3 + Route B5 Fuel Expenses Airplane Model 4 + Route B5 Fuel Expenses Airplane Model 5 + Route B5 Fuel Expenses Airplane Model 6 + Route B5 Fuel Expenses Airplane Model 7 


##### MARKET C #####

V Market C Roundtrip Distance = 3366
V Market C Demand[3] = {PREVIOUS(Market C Demand[1] * 1.02, 800), PREVIOUS(Market C Demand[2] * 1.02, 1250), PREVIOUS(Market C Demand[3] * 1.02, 275)}

V Market C Total Available Seat Kms Airplane Model 1[Team] = Route C1 Airplane Model 1 Kms Flown Daily + Route C2 Airplane Model 1 Kms Flown Daily + Route C3 Airplane Model 1 Kms Flown Daily + Route C4 Airplane Model 1 Kms Flown Daily + Route C5 Airplane Model 1 Kms Flown Daily
V Market C Total Actual Seat Kms Airplane Model 1[Team] = Market C Total Available Seat Kms Airplane Model 1 * X Reliability Variable
V Market C Total Available Seat Kms Airplane Model 2[Team] = Route C1 Airplane Model 2 Kms Flown Daily + Route C2 Airplane Model 2 Kms Flown Daily + Route C3 Airplane Model 2 Kms Flown Daily + Route C4 Airplane Model 2 Kms Flown Daily + Route C5 Airplane Model 2 Kms Flown Daily
V Market C Total Actual Seat Kms Airplane Model 2[Team] = Market C Total Available Seat Kms Airplane Model 2 * X Reliability Variable
V Market C Total Available Seat Kms Airplane Model 3[Team] = Route C1 Airplane Model 3 Kms Flown Daily + Route C2 Airplane Model 3 Kms Flown Daily + Route C3 Airplane Model 3 Kms Flown Daily + Route C4 Airplane Model 3 Kms Flown Daily + Route C5 Airplane Model 3 Kms Flown Daily
V Market C Total Actual Seat Kms Airplane Model 3[Team] = Market C Total Available Seat Kms Airplane Model 3 * X Reliability Variable
V Market C Total Available Seat Kms Airplane Model 4[Team] = Route C1 Airplane Model 4 Kms Flown Daily + Route C2 Airplane Model 4 Kms Flown Daily + Route C3 Airplane Model 4 Kms Flown Daily + Route C4 Airplane Model 4 Kms Flown Daily + Route C5 Airplane Model 4 Kms Flown Daily
V Market C Total Actual Seat Kms Airplane Model 4[Team] = Market C Total Available Seat Kms Airplane Model 4 * X Reliability Variable
V Market C Total Available Seat Kms Airplane Model 5[Team] = Route C1 Airplane Model 5 Kms Flown Daily + Route C2 Airplane Model 5 Kms Flown Daily + Route C3 Airplane Model 5 Kms Flown Daily + Route C4 Airplane Model 5 Kms Flown Daily + Route C5 Airplane Model 5 Kms Flown Daily
V Market C Total Actual Seat Kms Airplane Model 5[Team] = Market C Total Available Seat Kms Airplane Model 5 * X Reliability Variable
V Market C Total Available Seat Kms Airplane Model 6[Team] = Route C1 Airplane Model 6 Kms Flown Daily + Route C2 Airplane Model 6 Kms Flown Daily + Route C3 Airplane Model 6 Kms Flown Daily + Route C4 Airplane Model 6 Kms Flown Daily + Route C5 Airplane Model 6 Kms Flown Daily
V Market C Total Actual Seat Kms Airplane Model 6[Team] = Market C Total Available Seat Kms Airplane Model 6 * X Reliability Variable
V Market C Total Available Seat Kms Airplane Model 7[Team] = Route C1 Airplane Model 7 Kms Flown Daily + Route C2 Airplane Model 7 Kms Flown Daily + Route C3 Airplane Model 7 Kms Flown Daily + Route C4 Airplane Model 7 Kms Flown Daily + Route C5 Airplane Model 7 Kms Flown Daily
V Market C Total Actual Seat Kms Airplane Model 7[Team] = Market C Total Available Seat Kms Airplane Model 7 * X Reliability Variable

V Market C Opening Expenses[Team] = Route C1 Opening Expense + Route C2 Opening Expense + Route C3 Opening Expense + Route C4 Opening Expense + Route C5 Opening Expense
V Market C Fuel Expenses[Team] = Route C1 Total Fuel Expenses + Route C2 Total Fuel Expenses + Route C3 Total Fuel Expenses + Route C4 Total Fuel Expenses + Route C5 Total Fuel Expenses

V Market C Total Available Seat Kms[Team] = Route C1 Available Seat Kms + Route C2 Available Seat Kms + Route C3 Available Seat Kms + Route C4 Available Seat Kms + Route C5 Available Seat Kms

V Market C Total Revenue Passenger Kms[Team] =  Route C1 Revenue Passenger Kms + Route C2 Revenue Passenger Kms + Route C3 Revenue Passenger Kms + Route C4 Revenue Passenger Kms + Route C5 Revenue Passenger Kms

V Market C Total Planned Daily Flight Distance[Team] = Route C1 Roundtrip Distance Planned + Route C2 Roundtrip Distance Planned + Route C3 Roundtrip Distance Planned + Route C4 Roundtrip Distance Planned + Route C5 Roundtrip Distance Planned

V Market C Final Sales[Team] = (Route C1 Final Sales + Route C2 Final Sales + Route C3 Final Sales + Route C4 Final Sales + Route C5 Final Sales) * Market C Roundtrip Distance

V Airplane 1 Fleet Market C Total Trips[Team] = (Route C1 Airplane Model 1 Proposed Trips + Route C2 Airplane Model 1 Proposed Trips + Route C3 Airplane Model 1 Proposed Trips + Route C4 Airplane Model 1 Proposed Trips + Route C5 Airplane Model 1 Proposed Trips) * Market C Roundtrip Distance
V Airplane 2 Fleet Market C Total Trips[Team] = (Route C1 Airplane Model 2 Proposed Trips + Route C2 Airplane Model 2 Proposed Trips + Route C3 Airplane Model 2 Proposed Trips + Route C4 Airplane Model 2 Proposed Trips + Route C5 Airplane Model 2 Proposed Trips) * Market C Roundtrip Distance
V Airplane 3 Fleet Market C Total Trips[Team] = (Route C1 Airplane Model 3 Proposed Trips + Route C2 Airplane Model 3 Proposed Trips + Route C3 Airplane Model 3 Proposed Trips + Route C4 Airplane Model 3 Proposed Trips + Route C5 Airplane Model 3 Proposed Trips) * Market C Roundtrip Distance
V Airplane 4 Fleet Market C Total Trips[Team] = (Route C1 Airplane Model 4 Proposed Trips + Route C2 Airplane Model 4 Proposed Trips + Route C3 Airplane Model 4 Proposed Trips + Route C4 Airplane Model 4 Proposed Trips + Route C5 Airplane Model 4 Proposed Trips) * Market C Roundtrip Distance
V Airplane 5 Fleet Market C Total Trips[Team] = (Route C1 Airplane Model 5 Proposed Trips + Route C2 Airplane Model 5 Proposed Trips + Route C3 Airplane Model 5 Proposed Trips + Route C4 Airplane Model 5 Proposed Trips + Route C5 Airplane Model 5 Proposed Trips) * Market C Roundtrip Distance
V Airplane 6 Fleet Market C Total Trips[Team] = (Route C1 Airplane Model 6 Proposed Trips + Route C2 Airplane Model 6 Proposed Trips + Route C3 Airplane Model 6 Proposed Trips + Route C4 Airplane Model 6 Proposed Trips + Route C5 Airplane Model 6 Proposed Trips) * Market C Roundtrip Distance
V Airplane 7 Fleet Market C Total Trips[Team] = (Route C1 Airplane Model 7 Proposed Trips + Route C2 Airplane Model 7 Proposed Trips + Route C3 Airplane Model 7 Proposed Trips + Route C4 Airplane Model 7 Proposed Trips + Route C5 Airplane Model 7 Proposed Trips) * Market C Roundtrip Distance


### Route C1 ###

#V Route C1 Roundtrip Distance = 832

V Route C1 Roundtrip Distance Planned[Team] = Market C Roundtrip Distance * IF(Route C1 Online = 1,Route C1 Return Trips, 0)

## Route C1 Establishment ##

#V Route C1 Demand[3] = {PREVIOUS(Route C1 Demand[1] * 1.02, 800), PREVIOUS(Route C1 Demand[2] * 1.02, 1000), PREVIOUS(Route C1 Demand[3] * 1.02, 700)}
V Route C1 Demand For Teams[3] = {Market C Demand[1] + ((SQRT(Market C Demand[1] / 10 * Route C1 Num Of Teams[1])) * 10), Market C Demand[2] + ((SQRT(Market C Demand[2] / 10 * Route C1 Num Of Teams[2])) * 10), Market C Demand[3] + ((SQRT(Market C Demand[3] / 10 * Route C1 Num Of Teams[3])) * 10)}
D Route C1 Online[Team] = 0
P Route C1 Online.ExecuteDecisionImmediately = true

#V Route C1 Opening Expense[Team] = IF(PREVIOUS(Route C1 Online = 0) & Route C1 Online = 1, Route Const Opening New Route Expense, 0) 

V Route C1 Online Economy[Team] = IF(Route C1 Online = 1 & Price Structure = 1, 1, 0)
V Route C1 Online Normal[Team] = IF(Route C1 Online = 1 & Price Structure = 2, 1, 0)
V Route C1 Online Luxury[Team] = IF(Route C1 Online = 1 & Price Structure = 3, 1, 0)

V Route C1 First Quarter Online[Team] = REMEMBER((Route C1 Online = 1) & (PREVIOUS(Route C1 Online) = 0), STEP)
V Route C1 Number Of Quarters Online[Team] = IF(Route C1 Online = 1, STEP - Route C1 First Quarter Online + 1, 0)
V Route C1 Num Of Teams[3] = {ARRAYSUM(Route C1 Online Economy), ARRAYSUM(Route C1 Online Normal), ARRAYSUM(Route C1 Online Luxury)}

#V Route C1 Norm Quarters[Team] = 0 + IF(Route C1 Norm Online = 1, 1, (-1) * Route C1 Norm Quarters Mirror)
#V Route C1 Norm Quarters Mirror[Team] = Route C1 Norm Quarters
#P Route C1 Norm Quarters Mirror.ExecuteDecisionImmediately = false

V Route C1 Attractiveness[Team] = IF(Route C1 Number Of Quarters Online = 1, 1, SQRT(Route C1 Number Of Quarters Online) + Route C1 Number Of Quarters Online)

V Route C1 Attractiveness Economy[Team] = IF(Route C1 Online = 1 & Price Structure = 1, Route C1 Attractiveness, 0)
V Route C1 Attractiveness Normal[Team] = IF(Route C1 Online = 1 & Price Structure = 2, Route C1 Attractiveness, 0)
V Route C1 Attractiveness Luxury[Team] = IF(Route C1 Online = 1 & Price Structure = 3, Route C1 Attractiveness, 0)

V Route C1 Market Share[Team] = (Route C1 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route C1 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route C1 Attractiveness Normal), ARRAYSUM(Route C1 Attractiveness Luxury))))
V Route C1 Total Market Share[Team] = IF(Route C1 Online = 0, 0, (0.5 * Route C1 Market Share ) + (0.2 * Route C1 Return Trips Market Share) + (0.3 * Route C1 Price Overall Market Share))
V Route C1 Market Share For Customers[Team] = Route C1 Total Market Share * (IF(Price Structure = 1, Route C1 Demand For Teams[1], IF(Price Structure = 2, Route C1 Demand For Teams[2], Route C1 Demand For Teams[3])))

V Route C1 Sales[Team] = Route C1 Total Market Share * (IF(Price Structure = 1, Route C1 Demand For Teams[1], IF(Price Structure = 2, Route C1 Demand For Teams[2], Route C1 Demand For Teams[3])))

V Route C1 Final Sales[Team] = IF(Route C1 Sales > Route C1 Seat Supply, Route C1 Seat Supply, Route C1 Sales)

V Route C1 Revenue Passenger Kms[Team] = Route C1 Final Sales * Market C Roundtrip Distance

## Route Trips ##
D Route C1 Return Trips[Team] = 0
P Route C1 Return Trips.ExecuteDecisionImmediately = true
V Route C1 Return Trips Previ[Team] = PREVIOUS(Route C1 Return Trips, 0)
V Route C1 Return Trips Sensitivity = 1.5

V Route C1 Average Number Of Trips = IF(ARRAYSUM(Route C1 Online) = 0, 0, ARRAYSUM(Route C1 Return Trips) / ARRAYSUM(Route C1 Online))
V Route C1 Average Number Of Trips Previ = PREVIOUS(Route C1 Average Number Of Trips, 0)

V Route C1 Return Trips Economy[Team] = IF(Route C1 Online = 1 & Price Structure = 1, Route C1 Return Trips, 0)
V Route C1 Return Trips Normal[Team] = IF(Route C1 Online = 1 & Price Structure = 2, Route C1 Return Trips, 0)
V Route C1 Return Trips Luxury[Team] = IF(Route C1 Online = 1 & Price Structure = 3, Route C1 Return Trips, 0)

V Route C1 Return Trips Attractiveness[Team] = (Route C1 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route C1 Return Trips Economy) / Route C1 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route C1 Return Trips Normal) / Route C1 Num Of Teams[2], ARRAYSUM(Route C1 Return Trips Luxury) / Route C1 Num Of Teams[3]))) ^ Route C1 Return Trips Sensitivity

V Route C1 Return Trips Attractiveness Economy[Team] = IF(Route C1 Online = 1 & Price Structure = 1, Route C1 Return Trips Attractiveness, 0)
V Route C1 Return Trips Attractiveness Normal[Team] = IF(Route C1 Online = 1 & Price Structure = 2, Route C1 Return Trips Attractiveness, 0)
V Route C1 Return Trips Attractiveness Luxury[Team] = IF(Route C1 Online = 1 & Price Structure = 3, Route C1 Return Trips Attractiveness, 0)

V Route C1 Return Trips Market Share[Team] = (Route C1 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route C1 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route C1 Return Trips Attractiveness Normal), ARRAYSUM(Route C1 Return Trips Attractiveness Luxury))))

V Route C1 Seat Supply[Team] = Route C1 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route C1 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route C1 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route C1 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route C1 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route C1 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route C1 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route C1 Available Seat Kms[Team] = Route C1 Seat Supply * Market C Roundtrip Distance

# Route Trips By Plane #

V Route C1 Total Airplane Kms Planned[Team] = Route C1 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route C1 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route C1 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route C1 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route C1 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route C1 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route C1 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route C1 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route C1 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route C1 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route C1 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route C1 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route C1 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route C1 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route C1 Airplane Model 7 Trips)
V Z Route C1 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route C1 Return Trips - Route C1 Total Plane Trips Scheduled

D Route C1 Airplane Model 1 Trips[Team] = 0
P Route C1 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route C1 Airplane Model 1 Proposed Trips[Team] = IF(Route C1 Online = 0, 0, Route C1 Airplane Model 1 Trips)
V Route C1 Airplane Model 1 Actual Trips[Team] = IF(Route C1 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route C1 Airplane Model 1 Trips))
V Route C1 Airplane Model 1 Kms Flown Daily[Team] = Route C1 Airplane Model 1 Actual Trips * Market C Roundtrip Distance

D Route C1 Airplane Model 2 Trips[Team] = 0
P Route C1 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route C1 Airplane Model 2 Proposed Trips[Team] = IF(Route C1 Online = 0, 0, Route C1 Airplane Model 2 Trips)
V Route C1 Airplane Model 2 Actual Trips[Team] = IF(Route C1 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route C1 Airplane Model 2 Trips))
V Route C1 Airplane Model 2 Kms Flown Daily[Team] = Route C1 Airplane Model 2 Actual Trips * Market C Roundtrip Distance

D Route C1 Airplane Model 3 Trips[Team] = 0
P Route C1 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route C1 Airplane Model 3 Proposed Trips[Team] = IF(Route C1 Online = 0, 0, Route C1 Airplane Model 3 Trips)
V Route C1 Airplane Model 3 Actual Trips[Team] = IF(Route C1 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route C1 Airplane Model 3 Trips))
V Route C1 Airplane Model 3 Kms Flown Daily[Team] = Route C1 Airplane Model 3 Actual Trips * Market C Roundtrip Distance

D Route C1 Airplane Model 4 Trips[Team] = 0
P Route C1 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route C1 Airplane Model 4 Proposed Trips[Team] = IF(Route C1 Online = 0, 0, Route C1 Airplane Model 4 Trips)
V Route C1 Airplane Model 4 Actual Trips[Team] = IF(Route C1 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route C1 Airplane Model 4 Trips))
V Route C1 Airplane Model 4 Kms Flown Daily[Team] = Route C1 Airplane Model 4 Actual Trips * Market C Roundtrip Distance

D Route C1 Airplane Model 5 Trips[Team] = 0
P Route C1 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route C1 Airplane Model 5 Proposed Trips[Team] = IF(Route C1 Online = 0, 0, Route C1 Airplane Model 5 Trips)
V Route C1 Airplane Model 5 Actual Trips[Team] = IF(Route C1 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route C1 Airplane Model 5 Trips))
V Route C1 Airplane Model 5 Kms Flown Daily[Team] = Route C1 Airplane Model 5 Actual Trips * Market C Roundtrip Distance

D Route C1 Airplane Model 6 Trips[Team] = 0
P Route C1 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route C1 Airplane Model 6 Proposed Trips[Team] = IF(Route C1 Online = 0, 0, Route C1 Airplane Model 6 Trips)
V Route C1 Airplane Model 6 Actual Trips[Team] = IF(Route C1 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route C1 Airplane Model 6 Trips))
V Route C1 Airplane Model 6 Kms Flown Daily[Team] = Route C1 Airplane Model 6 Actual Trips * Market C Roundtrip Distance

D Route C1 Airplane Model 7 Trips[Team] = 0
P Route C1 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route C1 Airplane Model 7 Proposed Trips[Team] = IF(Route C1 Online = 0, 0, Route C1 Airplane Model 7 Trips)
V Route C1 Airplane Model 7 Actual Trips[Team] = IF(Route C1 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route C1 Airplane Model 7 Trips))
V Route C1 Airplane Model 7 Kms Flown Daily[Team] = Route C1 Airplane Model 7 Actual Trips * Market C Roundtrip Distance


## Route Pricing ##
V Route C1 Price Economy Number Of Teams[Team] = IF(Route C1 Online = 1 & Price Structure = 1, 1, 0)
V Route C1 Price Normal Number Of Teams[Team] = IF(Route C1 Online = 1 & Price Structure = 2, 1, 0)
V Route C1 Price Luxury Number Of Teams[Team] = IF(Route C1 Online = 1 & Price Structure = 3, 1, 0)

V Route C1 Price Sensitivity Economy = 1.001
V Route C1 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route C1 Price Economy Number Of Teams)) / Price Economy) ^ Route C1 Price Sensitivity Economy)
V Route C1 Price Market Share Economy[Team] = (Route C1 Price Attractiveness Economy / ARRAYSUM(Route C1 Price Attractiveness Economy))

V Route C1 Middling of Price[Team] = IF(Route C1 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route C1 Price Normal Number Of Teams)) - 0.12)), 0)
V Route C1 Price Sensitivity Normal = 1.5
V Route C1 Price Attractiveness Normal[Team] = (ARRAYAVG(Route C1 Middling of Price) / Route C1 Middling of Price) ^ Route C1 Price Sensitivity Normal
V Route C1 Price Market Share Normal[Team] = (Route C1 Price Attractiveness Normal / ARRAYSUM(Route C1 Price Attractiveness Normal))

V Route C1 Price Sensitivity Luxury = 1.001
V Route C1 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route C1 Price Luxury Number Of Teams))) ^ Route C1 Price Sensitivity Luxury)
V Route C1 Price Market Share Luxury[Team] = (Route C1 Price Attractiveness Luxury / ARRAYSUM(Route C1 Price Attractiveness Luxury))

V Route C1 Price Overall Market Share[Team] = IF(Price Structure = 1, Route C1 Price Market Share Economy, IF(Price Structure = 2, Route C1 Price Market Share Normal, Route C1 Price Market Share Luxury))

## Route Expenses1 ##

V Route C1 Opening Expense[Team] = IF(PREVIOUS(Route C1 Online = 0) & Route C1 Online = 1, Route Const Opening New Route Expense, 0) 

V Route C1 Fuel Expenses Airplane Model 1[Team] = Route C1 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route C1 Fuel Expenses Airplane Model 2[Team] = Route C1 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route C1 Fuel Expenses Airplane Model 3[Team] = Route C1 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route C1 Fuel Expenses Airplane Model 4[Team] = Route C1 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route C1 Fuel Expenses Airplane Model 5[Team] = Route C1 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route C1 Fuel Expenses Airplane Model 6[Team] = Route C1 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route C1 Fuel Expenses Airplane Model 7[Team] = Route C1 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route C1 Total Fuel Expenses[Team] = Route C1 Fuel Expenses Airplane Model 1 + Route C1 Fuel Expenses Airplane Model 2 + Route C1 Fuel Expenses Airplane Model 3 + Route C1 Fuel Expenses Airplane Model 4 + Route C1 Fuel Expenses Airplane Model 5 + Route C1 Fuel Expenses Airplane Model 6 + Route C1 Fuel Expenses Airplane Model 7 


### Route C2 ###

V Route C2 Roundtrip Distance Planned[Team] = Market C Roundtrip Distance * Route C2 Return Trips

## Route C2 Establishment ########
V Route C2 Demand For Teams[3] = {Market C Demand[1] + ((SQRT(Market C Demand[1] / 10 * Route C2 Num Of Teams[1])) * 10), Market C Demand[2] + ((SQRT(Market C Demand[2] / 10 * Route C2 Num Of Teams[2])) * 10), Market C Demand[3] + ((SQRT(Market C Demand[3] / 10 * Route C2 Num Of Teams[3])) * 10)}
D Route C2 Online[Team] = 0
P Route C2 Online.ExecuteDecisionImmediately = true

#V Route C2 Opening Expense[Team] = IF(PREVIOUS(Route C2 Online = 0) & Route C2 Online = 1, Route Const Opening New Route Expense, 0) 

V Route C2 Online Economy[Team] = IF(Route C2 Online = 1 & Price Structure = 1, 1, 0)
V Route C2 Online Normal[Team] = IF(Route C2 Online = 1 & Price Structure = 2, 1, 0)
V Route C2 Online Luxury[Team] = IF(Route C2 Online = 1 & Price Structure = 3, 1, 0)

V Route C2 First Quarter Online[Team] = REMEMBER((Route C2 Online = 1) & (PREVIOUS(Route C2 Online) = 0), STEP)
V Route C2 Number Of Quarters Online[Team] = IF(Route C2 Online = 1, STEP - Route C2 First Quarter Online + 1, 0)
V Route C2 Num Of Teams[3] = {ARRAYSUM(Route C2 Online Economy), ARRAYSUM(Route C2 Online Normal), ARRAYSUM(Route C2 Online Luxury)}

V Route C2 Attractiveness[Team] = IF(Route C2 Number Of Quarters Online = 1, 1, SQRT(Route C2 Number Of Quarters Online) + Route C2 Number Of Quarters Online)

V Route C2 Attractiveness Economy[Team] = IF(Route C2 Online = 1 & Price Structure = 1, Route C2 Attractiveness, 0)
V Route C2 Attractiveness Normal[Team] = IF(Route C2 Online = 1 & Price Structure = 2, Route C2 Attractiveness, 0)
V Route C2 Attractiveness Luxury[Team] = IF(Route C2 Online = 1 & Price Structure = 3, Route C2 Attractiveness, 0)

V Route C2 Market Share[Team] = (Route C2 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route C2 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route C2 Attractiveness Normal), ARRAYSUM(Route C2 Attractiveness Luxury))))
V Route C2 Total Market Share[Team] = IF(Route C2 Online = 0, 0, (0.5 * Route C2 Market Share ) + (0.2 * Route C2 Return Trips Market Share) + (0.3 * Route C2 Price Overall Market Share))
V Route C2 Market Share For Customers[Team] = Route C2 Total Market Share * (IF(Price Structure = 1, Route C2 Demand For Teams[1], IF(Price Structure = 2, Route C2 Demand For Teams[2], Route C2 Demand For Teams[3])))

V Route C2 Sales[Team] = Route C2 Total Market Share * (IF(Price Structure = 1, Route C2 Demand For Teams[1], IF(Price Structure = 2, Route C2 Demand For Teams[2], Route C2 Demand For Teams[3])))

V Route C2 Final Sales[Team] = IF(Route C2 Sales > Route C2 Seat Supply, Route C2 Seat Supply, Route C2 Sales)

V Route C2 Revenue Passenger Kms[Team] = Route C2 Final Sales * Market C Roundtrip Distance

# Route Trips
D Route C2 Return Trips[Team] = 0
P Route C2 Return Trips.ExecuteDecisionImmediately = true
V Route C2 Return Trips Previ[Team] = PREVIOUS(Route C2 Return Trips, 0)
V Route C2 Return Trips Sensitivity = 1.5

V Route C2 Average Number Of Trips = IF(ARRAYSUM(Route C2 Online) = 0, 0, ARRAYSUM(Route C2 Return Trips) / ARRAYSUM(Route C2 Online))
V Route C2 Average Number Of Trips Previ = PREVIOUS(Route C2 Average Number Of Trips, 0)

V Route C2 Return Trips Economy[Team] = IF(Route C2 Online = 1 & Price Structure = 1, Route C2 Return Trips, 0)
V Route C2 Return Trips Normal[Team] = IF(Route C2 Online = 1 & Price Structure = 2, Route C2 Return Trips, 0)
V Route C2 Return Trips Luxury[Team] = IF(Route C2 Online = 1 & Price Structure = 3, Route C2 Return Trips, 0)

V Route C2 Return Trips Attractiveness[Team] = (Route C2 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route C2 Return Trips Economy) / Route C2 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route C2 Return Trips Normal) / Route C2 Num Of Teams[2], ARRAYSUM(Route C2 Return Trips Luxury) / Route C2 Num Of Teams[3]))) ^ Route C2 Return Trips Sensitivity

V Route C2 Return Trips Attractiveness Economy[Team] = IF(Route C2 Online = 1 & Price Structure = 1, Route C2 Return Trips Attractiveness, 0)
V Route C2 Return Trips Attractiveness Normal[Team] = IF(Route C2 Online = 1 & Price Structure = 2, Route C2 Return Trips Attractiveness, 0)
V Route C2 Return Trips Attractiveness Luxury[Team] = IF(Route C2 Online = 1 & Price Structure = 3, Route C2 Return Trips Attractiveness, 0)

V Route C2 Return Trips Market Share[Team] = (Route C2 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route C2 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route C2 Return Trips Attractiveness Normal), ARRAYSUM(Route C2 Return Trips Attractiveness Luxury))))

V Route C2 Seat Supply[Team] = Route C2 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route C2 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route C2 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route C2 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route C2 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route C2 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route C2 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route C2 Available Seat Kms[Team] = Route C2 Seat Supply * Market C Roundtrip Distance

# Route Trips By Plane #

V Route C2 Total Airplane Kms Planned[Team] = Route C2 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route C2 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route C2 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route C2 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route C2 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route C2 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route C2 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route C2 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route C2 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route C2 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route C2 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route C2 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route C2 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route C2 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route C2 Airplane Model 7 Trips)
V Z Route C2 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route C2 Return Trips - Route C2 Total Plane Trips Scheduled

D Route C2 Airplane Model 1 Trips[Team] = 0
P Route C2 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route C2 Airplane Model 1 Proposed Trips[Team] = IF(Route C2 Online = 0, 0, Route C2 Airplane Model 1 Trips)
V Route C2 Airplane Model 1 Actual Trips[Team] = IF(Route C2 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route C2 Airplane Model 1 Trips))
V Route C2 Airplane Model 1 Kms Flown Daily[Team] = Route C2 Airplane Model 1 Actual Trips * Market C Roundtrip Distance

D Route C2 Airplane Model 2 Trips[Team] = 0
P Route C2 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route C2 Airplane Model 2 Proposed Trips[Team] = IF(Route C2 Online = 0, 0, Route C2 Airplane Model 2 Trips)
V Route C2 Airplane Model 2 Actual Trips[Team] = IF(Route C2 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route C2 Airplane Model 2 Trips))
V Route C2 Airplane Model 2 Kms Flown Daily[Team] = Route C2 Airplane Model 2 Actual Trips * Market C Roundtrip Distance

D Route C2 Airplane Model 3 Trips[Team] = 0
P Route C2 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route C2 Airplane Model 3 Proposed Trips[Team] = IF(Route C2 Online = 0, 0, Route C2 Airplane Model 3 Trips)
V Route C2 Airplane Model 3 Actual Trips[Team] = IF(Route C2 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route C2 Airplane Model 3 Trips))
V Route C2 Airplane Model 3 Kms Flown Daily[Team] = Route C2 Airplane Model 3 Actual Trips * Market C Roundtrip Distance

D Route C2 Airplane Model 4 Trips[Team] = 0
P Route C2 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route C2 Airplane Model 4 Proposed Trips[Team] = IF(Route C2 Online = 0, 0, Route C2 Airplane Model 4 Trips)
V Route C2 Airplane Model 4 Actual Trips[Team] = IF(Route C2 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route C2 Airplane Model 4 Trips))
V Route C2 Airplane Model 4 Kms Flown Daily[Team] = Route C2 Airplane Model 4 Actual Trips * Market C Roundtrip Distance

D Route C2 Airplane Model 5 Trips[Team] = 0
P Route C2 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route C2 Airplane Model 5 Proposed Trips[Team] = IF(Route C2 Online = 0, 0, Route C2 Airplane Model 5 Trips)
V Route C2 Airplane Model 5 Actual Trips[Team] = IF(Route C2 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route C2 Airplane Model 5 Trips))
V Route C2 Airplane Model 5 Kms Flown Daily[Team] = Route C2 Airplane Model 5 Actual Trips * Market C Roundtrip Distance

D Route C2 Airplane Model 6 Trips[Team] = 0
P Route C2 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route C2 Airplane Model 6 Proposed Trips[Team] = IF(Route C2 Online = 0, 0, Route C2 Airplane Model 6 Trips)
V Route C2 Airplane Model 6 Actual Trips[Team] = IF(Route C2 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route C2 Airplane Model 6 Trips))
V Route C2 Airplane Model 6 Kms Flown Daily[Team] = Route C2 Airplane Model 6 Actual Trips * Market C Roundtrip Distance

D Route C2 Airplane Model 7 Trips[Team] = 0
P Route C2 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route C2 Airplane Model 7 Proposed Trips[Team] = IF(Route C2 Online = 0, 0, Route C2 Airplane Model 7 Trips)
V Route C2 Airplane Model 7 Actual Trips[Team] = IF(Route C2 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route C2 Airplane Model 7 Trips))
V Route C2 Airplane Model 7 Kms Flown Daily[Team] = Route C2 Airplane Model 7 Actual Trips * Market C Roundtrip Distance


## Route Pricing ##

V Route C2 Price Economy Number Of Teams[Team] = IF(Route C2 Online = 1 & Price Structure = 1, 1, 0)
V Route C2 Price Normal Number Of Teams[Team] = IF(Route C2 Online = 1 & Price Structure = 2, 1, 0)
V Route C2 Price Luxury Number Of Teams[Team] = IF(Route C2 Online = 1 & Price Structure = 3, 1, 0)

V Route C2 Price Sensitivity Economy = 1.001
V Route C2 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route C2 Price Economy Number Of Teams)) / Price Economy) ^ Route C2 Price Sensitivity Economy)
V Route C2 Price Market Share Economy[Team] = (Route C2 Price Attractiveness Economy / ARRAYSUM(Route C2 Price Attractiveness Economy))

V Route C2 Middling of Price[Team] = IF(Route C2 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route C2 Price Normal Number Of Teams)) - 0.12)), 0)
V Route C2 Price Sensitivity Normal = 1.5
V Route C2 Price Attractiveness Normal[Team] = (ARRAYAVG(Route C2 Middling of Price) / Route C2 Middling of Price) ^ Route C2 Price Sensitivity Normal
V Route C2 Price Market Share Normal[Team] = (Route C2 Price Attractiveness Normal / ARRAYSUM(Route C2 Price Attractiveness Normal))

V Route C2 Price Sensitivity Luxury = 1.001
V Route C2 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route C2 Price Luxury Number Of Teams))) ^ Route C2 Price Sensitivity Luxury)
V Route C2 Price Market Share Luxury[Team] = (Route C2 Price Attractiveness Luxury / ARRAYSUM(Route C2 Price Attractiveness Luxury))

V Route C2 Price Overall Market Share[Team] = IF(Price Structure = 1, Route C2 Price Market Share Economy, IF(Price Structure = 2, Route C2 Price Market Share Normal, Route C2 Price Market Share Luxury))

## Route Expenses2 ##

V Route C2 Opening Expense[Team] = IF(PREVIOUS(Route C2 Online = 0) & Route C2 Online = 1, Route Const Opening New Route Expense, 0) 

V Route C2 Fuel Expenses Airplane Model 1[Team] = Route C2 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route C2 Fuel Expenses Airplane Model 2[Team] = Route C2 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route C2 Fuel Expenses Airplane Model 3[Team] = Route C2 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route C2 Fuel Expenses Airplane Model 4[Team] = Route C2 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route C2 Fuel Expenses Airplane Model 5[Team] = Route C2 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route C2 Fuel Expenses Airplane Model 6[Team] = Route C2 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route C2 Fuel Expenses Airplane Model 7[Team] = Route C2 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route C2 Total Fuel Expenses[Team] = Route C2 Fuel Expenses Airplane Model 1 + Route C2 Fuel Expenses Airplane Model 2 + Route C2 Fuel Expenses Airplane Model 3 + Route C2 Fuel Expenses Airplane Model 4 + Route C2 Fuel Expenses Airplane Model 5 + Route C2 Fuel Expenses Airplane Model 6 + Route C2 Fuel Expenses Airplane Model 7 


### Route C3 ###

V Route C3 Roundtrip Distance Planned[Team] = Market C Roundtrip Distance * Route C3 Return Trips

## Route C3 Establishment ########
V Route C3 Demand For Teams[3] = {Market C Demand[1] + ((SQRT(Market C Demand[1] / 10 * Route C3 Num Of Teams[1])) * 10), Market C Demand[2] + ((SQRT(Market C Demand[2] / 10 * Route C3 Num Of Teams[2])) * 10), Market C Demand[3] + ((SQRT(Market C Demand[3] / 10 * Route C3 Num Of Teams[3])) * 10)}
D Route C3 Online[Team] = 0
P Route C3 Online.ExecuteDecisionImmediately = true

# Route C3 Opening Expense[Team] = IF(PREVIOUS(Route C3 Online = 0) & Route C3 Online = 1, Route Const Opening New Route Expense, 0) 

V Route C3 Online Economy[Team] = IF(Route C3 Online = 1 & Price Structure = 1, 1, 0)
V Route C3 Online Normal[Team] = IF(Route C3 Online = 1 & Price Structure = 2, 1, 0)
V Route C3 Online Luxury[Team] = IF(Route C3 Online = 1 & Price Structure = 3, 1, 0)

V Route C3 First Quarter Online[Team] = REMEMBER((Route C3 Online = 1) & (PREVIOUS(Route C3 Online) = 0), STEP)
V Route C3 Number Of Quarters Online[Team] = IF(Route C3 Online = 1, STEP - Route C3 First Quarter Online + 1, 0)
V Route C3 Num Of Teams[3] = {ARRAYSUM(Route C3 Online Economy), ARRAYSUM(Route C3 Online Normal), ARRAYSUM(Route C3 Online Luxury)}

V Route C3 Attractiveness[Team] = IF(Route C3 Number Of Quarters Online = 1, 1, SQRT(Route C3 Number Of Quarters Online) + Route C3 Number Of Quarters Online)

V Route C3 Attractiveness Economy[Team] = IF(Route C3 Online = 1 & Price Structure = 1, Route C3 Attractiveness, 0)
V Route C3 Attractiveness Normal[Team] = IF(Route C3 Online = 1 & Price Structure = 2, Route C3 Attractiveness, 0)
V Route C3 Attractiveness Luxury[Team] = IF(Route C3 Online = 1 & Price Structure = 3, Route C3 Attractiveness, 0)

V Route C3 Market Share[Team] = (Route C3 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route C3 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route C3 Attractiveness Normal), ARRAYSUM(Route C3 Attractiveness Luxury))))
V Route C3 Total Market Share[Team] = IF(Route C3 Online = 0, 0, (0.5 * Route C3 Market Share ) + (0.2 * Route C3 Return Trips Market Share) + (0.3 * Route C3 Price Overall Market Share))
V Route C3 Market Share For Customers[Team] = Route C3 Total Market Share * (IF(Price Structure = 1, Route C3 Demand For Teams[1], IF(Price Structure = 2, Route C3 Demand For Teams[2], Route C3 Demand For Teams[3])))

V Route C3 Sales[Team] = Route C3 Total Market Share * (IF(Price Structure = 1, Route C3 Demand For Teams[1], IF(Price Structure = 2, Route C3 Demand For Teams[2], Route C3 Demand For Teams[3])))

V Route C3 Final Sales[Team] = IF(Route C3 Sales > Route C3 Seat Supply, Route C3 Seat Supply, Route C3 Sales)

V Route C3 Revenue Passenger Kms[Team] = Route C3 Final Sales * Market C Roundtrip Distance

# Route Trips
D Route C3 Return Trips[Team] = 0
P Route C3 Return Trips.ExecuteDecisionImmediately = true
V Route C3 Return Trips Previ[Team] = PREVIOUS(Route C3 Return Trips, 0)
V Route C3 Return Trips Sensitivity = 1.5

V Route C3 Average Number Of Trips = IF(ARRAYSUM(Route C3 Online) = 0, 0, ARRAYSUM(Route C3 Return Trips) / ARRAYSUM(Route C3 Online))
V Route C3 Average Number Of Trips Previ = PREVIOUS(Route C3 Average Number Of Trips, 0)

V Route C3 Return Trips Economy[Team] = IF(Route C3 Online = 1 & Price Structure = 1, Route C3 Return Trips, 0)
V Route C3 Return Trips Normal[Team] = IF(Route C3 Online = 1 & Price Structure = 2, Route C3 Return Trips, 0)
V Route C3 Return Trips Luxury[Team] = IF(Route C3 Online = 1 & Price Structure = 3, Route C3 Return Trips, 0)

V Route C3 Return Trips Attractiveness[Team] = (Route C3 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route C3 Return Trips Economy) / Route C3 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route C3 Return Trips Normal) / Route C3 Num Of Teams[2], ARRAYSUM(Route C3 Return Trips Luxury) / Route C3 Num Of Teams[3]))) ^ Route C3 Return Trips Sensitivity

V Route C3 Return Trips Attractiveness Economy[Team] = IF(Route C3 Online = 1 & Price Structure = 1, Route C3 Return Trips Attractiveness, 0)
V Route C3 Return Trips Attractiveness Normal[Team] = IF(Route C3 Online = 1 & Price Structure = 2, Route C3 Return Trips Attractiveness, 0)
V Route C3 Return Trips Attractiveness Luxury[Team] = IF(Route C3 Online = 1 & Price Structure = 3, Route C3 Return Trips Attractiveness, 0)

V Route C3 Return Trips Market Share[Team] = (Route C3 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route C3 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route C3 Return Trips Attractiveness Normal), ARRAYSUM(Route C3 Return Trips Attractiveness Luxury))))

V Route C3 Seat Supply[Team] = Route C3 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route C3 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route C3 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route C3 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route C3 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route C3 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route C3 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route C3 Available Seat Kms[Team] = Route C3 Seat Supply * Market C Roundtrip Distance

# Route Trips By Plane #

V Route C3 Total Airplane Kms Planned[Team] = Route C3 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route C3 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route C3 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route C3 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route C3 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route C3 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route C3 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route C3 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route C3 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route C3 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route C3 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route C3 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route C3 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route C3 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route C3 Airplane Model 7 Trips)
V Z Route C3 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route C3 Return Trips - Route C3 Total Plane Trips Scheduled

D Route C3 Airplane Model 1 Trips[Team] = 0
P Route C3 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route C3 Airplane Model 1 Proposed Trips[Team] = IF(Route C3 Online = 0, 0, Route C3 Airplane Model 1 Trips)
V Route C3 Airplane Model 1 Actual Trips[Team] = IF(Route C3 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route C3 Airplane Model 1 Trips))
V Route C3 Airplane Model 1 Kms Flown Daily[Team] = Route C3 Airplane Model 1 Actual Trips * Market C Roundtrip Distance

D Route C3 Airplane Model 2 Trips[Team] = 0
P Route C3 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route C3 Airplane Model 2 Proposed Trips[Team] = IF(Route C3 Online = 0, 0, Route C3 Airplane Model 2 Trips)
V Route C3 Airplane Model 2 Actual Trips[Team] = IF(Route C3 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route C3 Airplane Model 2 Trips))
V Route C3 Airplane Model 2 Kms Flown Daily[Team] = Route C3 Airplane Model 2 Actual Trips * Market C Roundtrip Distance

D Route C3 Airplane Model 3 Trips[Team] = 0
P Route C3 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route C3 Airplane Model 3 Proposed Trips[Team] = IF(Route C3 Online = 0, 0, Route C3 Airplane Model 3 Trips)
V Route C3 Airplane Model 3 Actual Trips[Team] = IF(Route C3 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route C3 Airplane Model 3 Trips))
V Route C3 Airplane Model 3 Kms Flown Daily[Team] = Route C3 Airplane Model 3 Actual Trips * Market C Roundtrip Distance

D Route C3 Airplane Model 4 Trips[Team] = 0
P Route C3 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route C3 Airplane Model 4 Proposed Trips[Team] = IF(Route C3 Online = 0, 0, Route C3 Airplane Model 4 Trips)
V Route C3 Airplane Model 4 Actual Trips[Team] = IF(Route C3 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route C3 Airplane Model 4 Trips))
V Route C3 Airplane Model 4 Kms Flown Daily[Team] = Route C3 Airplane Model 4 Actual Trips * Market C Roundtrip Distance

D Route C3 Airplane Model 5 Trips[Team] = 0
P Route C3 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route C3 Airplane Model 5 Proposed Trips[Team] = IF(Route C3 Online = 0, 0, Route C3 Airplane Model 5 Trips)
V Route C3 Airplane Model 5 Actual Trips[Team] = IF(Route C3 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route C3 Airplane Model 5 Trips))
V Route C3 Airplane Model 5 Kms Flown Daily[Team] = Route C3 Airplane Model 5 Actual Trips * Market C Roundtrip Distance

D Route C3 Airplane Model 6 Trips[Team] = 0
P Route C3 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route C3 Airplane Model 6 Proposed Trips[Team] = IF(Route C3 Online = 0, 0, Route C3 Airplane Model 6 Trips)
V Route C3 Airplane Model 6 Actual Trips[Team] = IF(Route C3 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route C3 Airplane Model 6 Trips))
V Route C3 Airplane Model 6 Kms Flown Daily[Team] = Route C3 Airplane Model 6 Actual Trips * Market C Roundtrip Distance

D Route C3 Airplane Model 7 Trips[Team] = 0
P Route C3 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route C3 Airplane Model 7 Proposed Trips[Team] = IF(Route C3 Online = 0, 0, Route C3 Airplane Model 7 Trips)
V Route C3 Airplane Model 7 Actual Trips[Team] = IF(Route C3 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route C3 Airplane Model 7 Trips))
V Route C3 Airplane Model 7 Kms Flown Daily[Team] = Route C3 Airplane Model 7 Actual Trips * Market C Roundtrip Distance


## Route Pricing ##

V Route C3 Price Economy Number Of Teams[Team] = IF(Route C3 Online = 1 & Price Structure = 1, 1, 0)
V Route C3 Price Normal Number Of Teams[Team] = IF(Route C3 Online = 1 & Price Structure = 2, 1, 0)
V Route C3 Price Luxury Number Of Teams[Team] = IF(Route C3 Online = 1 & Price Structure = 3, 1, 0)

V Route C3 Price Sensitivity Economy = 1.001
V Route C3 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route C3 Price Economy Number Of Teams)) / Price Economy) ^ Route C3 Price Sensitivity Economy)
V Route C3 Price Market Share Economy[Team] = (Route C3 Price Attractiveness Economy / ARRAYSUM(Route C3 Price Attractiveness Economy))

V Route C3 Middling of Price[Team] = IF(Route C3 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route C3 Price Normal Number Of Teams)) - 0.12)), 0)
V Route C3 Price Sensitivity Normal = 1.5
V Route C3 Price Attractiveness Normal[Team] = (ARRAYAVG(Route C3 Middling of Price) / Route C3 Middling of Price) ^ Route C3 Price Sensitivity Normal
V Route C3 Price Market Share Normal[Team] = (Route C3 Price Attractiveness Normal / ARRAYSUM(Route C3 Price Attractiveness Normal))

V Route C3 Price Sensitivity Luxury = 1.001
V Route C3 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route C3 Price Luxury Number Of Teams))) ^ Route C3 Price Sensitivity Luxury)
V Route C3 Price Market Share Luxury[Team] = (Route C3 Price Attractiveness Luxury / ARRAYSUM(Route C3 Price Attractiveness Luxury))

V Route C3 Price Overall Market Share[Team] = IF(Price Structure = 1, Route C3 Price Market Share Economy, IF(Price Structure = 2, Route C3 Price Market Share Normal, Route C3 Price Market Share Luxury))

## Route Expenses3 ##

V Route C3 Opening Expense[Team] = IF(PREVIOUS(Route C3 Online = 0) & Route C3 Online = 1, Route Const Opening New Route Expense, 0) 

V Route C3 Fuel Expenses Airplane Model 1[Team] = Route C3 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route C3 Fuel Expenses Airplane Model 2[Team] = Route C3 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route C3 Fuel Expenses Airplane Model 3[Team] = Route C3 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route C3 Fuel Expenses Airplane Model 4[Team] = Route C3 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route C3 Fuel Expenses Airplane Model 5[Team] = Route C3 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route C3 Fuel Expenses Airplane Model 6[Team] = Route C3 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route C3 Fuel Expenses Airplane Model 7[Team] = Route C3 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route C3 Total Fuel Expenses[Team] = Route C3 Fuel Expenses Airplane Model 1 + Route C3 Fuel Expenses Airplane Model 2 + Route C3 Fuel Expenses Airplane Model 3 + Route C3 Fuel Expenses Airplane Model 4 + Route C3 Fuel Expenses Airplane Model 5 + Route C3 Fuel Expenses Airplane Model 6 + Route C3 Fuel Expenses Airplane Model 7 


### Route C4 ###

V Route C4 Roundtrip Distance Planned[Team] = Market C Roundtrip Distance * Route C4 Return Trips

## Route C4 Establishment ########
V Route C4 Demand For Teams[3] = {Market C Demand[1] + ((SQRT(Market C Demand[1] / 10 * Route C4 Num Of Teams[1])) * 10), Market C Demand[2] + ((SQRT(Market C Demand[2] / 10 * Route C4 Num Of Teams[2])) * 10), Market C Demand[3] + ((SQRT(Market C Demand[3] / 10 * Route C4 Num Of Teams[3])) * 10)}
D Route C4 Online[Team] = 0
P Route C4 Online.ExecuteDecisionImmediately = true

#V Route C4 Opening Expense[Team] = IF(PREVIOUS(Route C4 Online = 0) & Route C4 Online = 1, Route Const Opening New Route Expense, 0) 

V Route C4 Online Economy[Team] = IF(Route C4 Online = 1 & Price Structure = 1, 1, 0)
V Route C4 Online Normal[Team] = IF(Route C4 Online = 1 & Price Structure = 2, 1, 0)
V Route C4 Online Luxury[Team] = IF(Route C4 Online = 1 & Price Structure = 3, 1, 0)

V Route C4 First Quarter Online[Team] = REMEMBER((Route C4 Online = 1) & (PREVIOUS(Route C4 Online) = 0), STEP)
V Route C4 Number Of Quarters Online[Team] = IF(Route C4 Online = 1, STEP - Route C4 First Quarter Online + 1, 0)
V Route C4 Num Of Teams[3] = {ARRAYSUM(Route C4 Online Economy), ARRAYSUM(Route C4 Online Normal), ARRAYSUM(Route C4 Online Luxury)}

V Route C4 Attractiveness[Team] = IF(Route C4 Number Of Quarters Online = 1, 1, SQRT(Route C4 Number Of Quarters Online) + Route C4 Number Of Quarters Online)

V Route C4 Attractiveness Economy[Team] = IF(Route C4 Online = 1 & Price Structure = 1, Route C4 Attractiveness, 0)
V Route C4 Attractiveness Normal[Team] = IF(Route C4 Online = 1 & Price Structure = 2, Route C4 Attractiveness, 0)
V Route C4 Attractiveness Luxury[Team] = IF(Route C4 Online = 1 & Price Structure = 3, Route C4 Attractiveness, 0)

V Route C4 Market Share[Team] = (Route C4 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route C4 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route C4 Attractiveness Normal), ARRAYSUM(Route C4 Attractiveness Luxury))))
V Route C4 Total Market Share[Team] = IF(Route C4 Online = 0, 0, (0.5 * Route C4 Market Share ) + (0.2 * Route C4 Return Trips Market Share) + (0.3 * Route C4 Price Overall Market Share))
V Route C4 Market Share For Customers[Team] = Route C4 Total Market Share * (IF(Price Structure = 1, Route C4 Demand For Teams[1], IF(Price Structure = 2, Route C4 Demand For Teams[2], Route C4 Demand For Teams[3])))

V Route C4 Sales[Team] = Route C4 Total Market Share * (IF(Price Structure = 1, Route C4 Demand For Teams[1], IF(Price Structure = 2, Route C4 Demand For Teams[2], Route C4 Demand For Teams[3])))

V Route C4 Final Sales[Team] = IF(Route C4 Sales > Route C4 Seat Supply, Route C4 Seat Supply, Route C4 Sales)

V Route C4 Revenue Passenger Kms[Team] = Route C4 Final Sales * Market C Roundtrip Distance

# Route Trips
D Route C4 Return Trips[Team] = 0
P Route C4 Return Trips.ExecuteDecisionImmediately = true
V Route C4 Return Trips Previ[Team] = PREVIOUS(Route C4 Return Trips, 0)
V Route C4 Return Trips Sensitivity = 1.5

V Route C4 Average Number Of Trips = IF(ARRAYSUM(Route C4 Online) = 0, 0, ARRAYSUM(Route C4 Return Trips) / ARRAYSUM(Route C4 Online))
V Route C4 Average Number Of Trips Previ = PREVIOUS(Route C4 Average Number Of Trips, 0)

V Route C4 Return Trips Economy[Team] = IF(Route C4 Online = 1 & Price Structure = 1, Route C4 Return Trips, 0)
V Route C4 Return Trips Normal[Team] = IF(Route C4 Online = 1 & Price Structure = 2, Route C4 Return Trips, 0)
V Route C4 Return Trips Luxury[Team] = IF(Route C4 Online = 1 & Price Structure = 3, Route C4 Return Trips, 0)

V Route C4 Return Trips Attractiveness[Team] = (Route C4 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route C4 Return Trips Economy) / Route C4 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route C4 Return Trips Normal) / Route C4 Num Of Teams[2], ARRAYSUM(Route C4 Return Trips Luxury) / Route C4 Num Of Teams[3]))) ^ Route C4 Return Trips Sensitivity

V Route C4 Return Trips Attractiveness Economy[Team] = IF(Route C4 Online = 1 & Price Structure = 1, Route C4 Return Trips Attractiveness, 0)
V Route C4 Return Trips Attractiveness Normal[Team] = IF(Route C4 Online = 1 & Price Structure = 2, Route C4 Return Trips Attractiveness, 0)
V Route C4 Return Trips Attractiveness Luxury[Team] = IF(Route C4 Online = 1 & Price Structure = 3, Route C4 Return Trips Attractiveness, 0)

V Route C4 Return Trips Market Share[Team] = (Route C4 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route C4 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route C4 Return Trips Attractiveness Normal), ARRAYSUM(Route C4 Return Trips Attractiveness Luxury))))

V Route C4 Seat Supply[Team] = Route C4 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route C4 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route C4 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route C4 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route C4 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route C4 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route C4 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route C4 Available Seat Kms[Team] = Route C4 Seat Supply * Market C Roundtrip Distance

# Route Trips By Plane #

V Route C4 Total Airplane Kms Planned[Team] = Route C4 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route C4 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route C4 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route C4 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route C4 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route C4 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route C4 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route C4 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route C4 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route C4 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route C4 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route C4 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route C4 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route C4 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route C4 Airplane Model 7 Trips)
V Z Route C4 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route C4 Return Trips - Route C4 Total Plane Trips Scheduled

D Route C4 Airplane Model 1 Trips[Team] = 0
P Route C4 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route C4 Airplane Model 1 Proposed Trips[Team] = IF(Route C4 Online = 0, 0, Route C4 Airplane Model 1 Trips)
V Route C4 Airplane Model 1 Actual Trips[Team] = IF(Route C4 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route C4 Airplane Model 1 Trips))
V Route C4 Airplane Model 1 Kms Flown Daily[Team] = Route C4 Airplane Model 1 Actual Trips * Market C Roundtrip Distance

D Route C4 Airplane Model 2 Trips[Team] = 0
P Route C4 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route C4 Airplane Model 2 Proposed Trips[Team] = IF(Route C4 Online = 0, 0, Route C4 Airplane Model 2 Trips)
V Route C4 Airplane Model 2 Actual Trips[Team] = IF(Route C4 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route C4 Airplane Model 2 Trips))
V Route C4 Airplane Model 2 Kms Flown Daily[Team] = Route C4 Airplane Model 2 Actual Trips * Market C Roundtrip Distance

D Route C4 Airplane Model 3 Trips[Team] = 0
P Route C4 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route C4 Airplane Model 3 Proposed Trips[Team] = IF(Route C4 Online = 0, 0, Route C4 Airplane Model 3 Trips)
V Route C4 Airplane Model 3 Actual Trips[Team] = IF(Route C4 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route C4 Airplane Model 3 Trips))
V Route C4 Airplane Model 3 Kms Flown Daily[Team] = Route C4 Airplane Model 3 Actual Trips * Market C Roundtrip Distance

D Route C4 Airplane Model 4 Trips[Team] = 0
P Route C4 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route C4 Airplane Model 4 Proposed Trips[Team] = IF(Route C4 Online = 0, 0, Route C4 Airplane Model 4 Trips)
V Route C4 Airplane Model 4 Actual Trips[Team] = IF(Route C4 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route C4 Airplane Model 4 Trips))
V Route C4 Airplane Model 4 Kms Flown Daily[Team] = Route C4 Airplane Model 4 Actual Trips * Market C Roundtrip Distance

D Route C4 Airplane Model 5 Trips[Team] = 0
P Route C4 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route C4 Airplane Model 5 Proposed Trips[Team] = IF(Route C4 Online = 0, 0, Route C4 Airplane Model 5 Trips)
V Route C4 Airplane Model 5 Actual Trips[Team] = IF(Route C4 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route C4 Airplane Model 5 Trips))
V Route C4 Airplane Model 5 Kms Flown Daily[Team] = Route C4 Airplane Model 5 Actual Trips * Market C Roundtrip Distance

D Route C4 Airplane Model 6 Trips[Team] = 0
P Route C4 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route C4 Airplane Model 6 Proposed Trips[Team] = IF(Route C4 Online = 0, 0, Route C4 Airplane Model 6 Trips)
V Route C4 Airplane Model 6 Actual Trips[Team] = IF(Route C4 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route C4 Airplane Model 6 Trips))
V Route C4 Airplane Model 6 Kms Flown Daily[Team] = Route C4 Airplane Model 6 Actual Trips * Market C Roundtrip Distance

D Route C4 Airplane Model 7 Trips[Team] = 0
P Route C4 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route C4 Airplane Model 7 Proposed Trips[Team] = IF(Route C4 Online = 0, 0, Route C4 Airplane Model 7 Trips)
V Route C4 Airplane Model 7 Actual Trips[Team] = IF(Route C4 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route C4 Airplane Model 7 Trips))
V Route C4 Airplane Model 7 Kms Flown Daily[Team] = Route C4 Airplane Model 7 Actual Trips * Market C Roundtrip Distance


## Route Pricing ##

V Route C4 Price Economy Number Of Teams[Team] = IF(Route C4 Online = 1 & Price Structure = 1, 1, 0)
V Route C4 Price Normal Number Of Teams[Team] = IF(Route C4 Online = 1 & Price Structure = 2, 1, 0)
V Route C4 Price Luxury Number Of Teams[Team] = IF(Route C4 Online = 1 & Price Structure = 3, 1, 0)

V Route C4 Price Sensitivity Economy = 1.001
V Route C4 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route C4 Price Economy Number Of Teams)) / Price Economy) ^ Route C4 Price Sensitivity Economy)
V Route C4 Price Market Share Economy[Team] = (Route C4 Price Attractiveness Economy / ARRAYSUM(Route C4 Price Attractiveness Economy))

V Route C4 Middling of Price[Team] = IF(Route C4 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route C4 Price Normal Number Of Teams)) - 0.12)), 0)
V Route C4 Price Sensitivity Normal = 1.5
V Route C4 Price Attractiveness Normal[Team] = (ARRAYAVG(Route C4 Middling of Price) / Route C4 Middling of Price) ^ Route C4 Price Sensitivity Normal
V Route C4 Price Market Share Normal[Team] = (Route C4 Price Attractiveness Normal / ARRAYSUM(Route C4 Price Attractiveness Normal))

V Route C4 Price Sensitivity Luxury = 1.001
V Route C4 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route C4 Price Luxury Number Of Teams))) ^ Route C4 Price Sensitivity Luxury)
V Route C4 Price Market Share Luxury[Team] = (Route C4 Price Attractiveness Luxury / ARRAYSUM(Route C4 Price Attractiveness Luxury))

V Route C4 Price Overall Market Share[Team] = IF(Price Structure = 1, Route C4 Price Market Share Economy, IF(Price Structure = 2, Route C4 Price Market Share Normal, Route C4 Price Market Share Luxury))

## Route Expenses4##

V Route C4 Opening Expense[Team] = IF(PREVIOUS(Route C4 Online = 0) & Route C4 Online = 1, Route Const Opening New Route Expense, 0) 

V Route C4 Fuel Expenses Airplane Model 1[Team] = Route C4 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route C4 Fuel Expenses Airplane Model 2[Team] = Route C4 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route C4 Fuel Expenses Airplane Model 3[Team] = Route C4 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route C4 Fuel Expenses Airplane Model 4[Team] = Route C4 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route C4 Fuel Expenses Airplane Model 5[Team] = Route C4 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route C4 Fuel Expenses Airplane Model 6[Team] = Route C4 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route C4 Fuel Expenses Airplane Model 7[Team] = Route C4 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route C4 Total Fuel Expenses[Team] = Route C4 Fuel Expenses Airplane Model 1 + Route C4 Fuel Expenses Airplane Model 2 + Route C4 Fuel Expenses Airplane Model 3 + Route C4 Fuel Expenses Airplane Model 4 + Route C4 Fuel Expenses Airplane Model 5 + Route C4 Fuel Expenses Airplane Model 6 + Route C4 Fuel Expenses Airplane Model 7 


### Route C5 ###

V Route C5 Roundtrip Distance Planned[Team] = Market C Roundtrip Distance * Route C5 Return Trips

## Route C5 Establishment ########
V Route C5 Demand For Teams[3] = {Market C Demand[1] + ((SQRT(Market C Demand[1] / 10 * Route C5 Num Of Teams[1])) * 10), Market C Demand[2] + ((SQRT(Market C Demand[2] / 10 * Route C5 Num Of Teams[2])) * 10), Market C Demand[3] + ((SQRT(Market C Demand[3] / 10 * Route C5 Num Of Teams[3])) * 10)}
D Route C5 Online[Team] = 0
P Route C5 Online.ExecuteDecisionImmediately = true

#V Route C5 Opening Expense[Team] = IF(PREVIOUS(Route C5 Online = 0) & Route C5 Online = 1, Route Const Opening New Route Expense, 0) 

V Route C5 Online Economy[Team] = IF(Route C5 Online = 1 & Price Structure = 1, 1, 0)
V Route C5 Online Normal[Team] = IF(Route C5 Online = 1 & Price Structure = 2, 1, 0)
V Route C5 Online Luxury[Team] = IF(Route C5 Online = 1 & Price Structure = 3, 1, 0)

V Route C5 First Quarter Online[Team] = REMEMBER((Route C5 Online = 1) & (PREVIOUS(Route C5 Online) = 0), STEP)
V Route C5 Number Of Quarters Online[Team] = IF(Route C5 Online = 1, STEP - Route C5 First Quarter Online + 1, 0)
V Route C5 Num Of Teams[3] = {ARRAYSUM(Route C5 Online Economy), ARRAYSUM(Route C5 Online Normal), ARRAYSUM(Route C5 Online Luxury)}

V Route C5 Attractiveness[Team] = IF(Route C5 Number Of Quarters Online = 1, 1, SQRT(Route C5 Number Of Quarters Online) + Route C5 Number Of Quarters Online)

V Route C5 Attractiveness Economy[Team] = IF(Route C5 Online = 1 & Price Structure = 1, Route C5 Attractiveness, 0)
V Route C5 Attractiveness Normal[Team] = IF(Route C5 Online = 1 & Price Structure = 2, Route C5 Attractiveness, 0)
V Route C5 Attractiveness Luxury[Team] = IF(Route C5 Online = 1 & Price Structure = 3, Route C5 Attractiveness, 0)

V Route C5 Market Share[Team] = (Route C5 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route C5 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route C5 Attractiveness Normal), ARRAYSUM(Route C5 Attractiveness Luxury))))
V Route C5 Total Market Share[Team] = IF(Route C5 Online = 0, 0, (0.5 * Route C5 Market Share ) + (0.2 * Route C5 Return Trips Market Share) + (0.3 * Route C5 Price Overall Market Share))
V Route C5 Market Share For Customers[Team] = Route C5 Total Market Share * (IF(Price Structure = 1, Route C5 Demand For Teams[1], IF(Price Structure = 2, Route C5 Demand For Teams[2], Route C5 Demand For Teams[3])))

V Route C5 Sales[Team] = Route C5 Total Market Share * (IF(Price Structure = 1, Route C5 Demand For Teams[1], IF(Price Structure = 2, Route C5 Demand For Teams[2], Route C5 Demand For Teams[3])))

V Route C5 Final Sales[Team] = IF(Route C5 Sales > Route C5 Seat Supply, Route C5 Seat Supply, Route C5 Sales)

V Route C5 Revenue Passenger Kms[Team] = Route C5 Final Sales * Market C Roundtrip Distance

# Route Trips
D Route C5 Return Trips[Team] = 0
P Route C5 Return Trips.ExecuteDecisionImmediately = true
V Route C5 Return Trips Previ[Team] = PREVIOUS(Route C5 Return Trips, 0)
V Route C5 Return Trips Sensitivity = 1.5

V Route C5 Average Number Of Trips = IF(ARRAYSUM(Route C5 Online) = 0, 0, ARRAYSUM(Route C5 Return Trips) / ARRAYSUM(Route C5 Online))
V Route C5 Average Number Of Trips Previ = PREVIOUS(Route C5 Average Number Of Trips, 0)

V Route C5 Return Trips Economy[Team] = IF(Route C5 Online = 1 & Price Structure = 1, Route C5 Return Trips, 0)
V Route C5 Return Trips Normal[Team] = IF(Route C5 Online = 1 & Price Structure = 2, Route C5 Return Trips, 0)
V Route C5 Return Trips Luxury[Team] = IF(Route C5 Online = 1 & Price Structure = 3, Route C5 Return Trips, 0)

V Route C5 Return Trips Attractiveness[Team] = (Route C5 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route C5 Return Trips Economy) / Route C5 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route C5 Return Trips Normal) / Route C5 Num Of Teams[2], ARRAYSUM(Route C5 Return Trips Luxury) / Route C5 Num Of Teams[3]))) ^ Route C5 Return Trips Sensitivity

V Route C5 Return Trips Attractiveness Economy[Team] = IF(Route C5 Online = 1 & Price Structure = 1, Route C5 Return Trips Attractiveness, 0)
V Route C5 Return Trips Attractiveness Normal[Team] = IF(Route C5 Online = 1 & Price Structure = 2, Route C5 Return Trips Attractiveness, 0)
V Route C5 Return Trips Attractiveness Luxury[Team] = IF(Route C5 Online = 1 & Price Structure = 3, Route C5 Return Trips Attractiveness, 0)

V Route C5 Return Trips Market Share[Team] = (Route C5 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route C5 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route C5 Return Trips Attractiveness Normal), ARRAYSUM(Route C5 Return Trips Attractiveness Luxury))))

V Route C5 Seat Supply[Team] = Route C5 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route C5 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route C5 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route C5 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route C5 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route C5 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route C5 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route C5 Available Seat Kms[Team] = Route C5 Seat Supply * Market C Roundtrip Distance

# Route Trips By Plane #

V Route C5 Total Airplane Kms Planned[Team] = Route C5 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route C5 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route C5 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route C5 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route C5 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route C5 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route C5 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route C5 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route C5 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route C5 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route C5 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route C5 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route C5 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route C5 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route C5 Airplane Model 7 Trips)
V Z Route C5 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route C5 Return Trips - Route C5 Total Plane Trips Scheduled

D Route C5 Airplane Model 1 Trips[Team] = 0
P Route C5 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route C5 Airplane Model 1 Proposed Trips[Team] = IF(Route C5 Online = 0, 0, Route C5 Airplane Model 1 Trips)
V Route C5 Airplane Model 1 Actual Trips[Team] = IF(Route C5 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route C5 Airplane Model 1 Trips))
V Route C5 Airplane Model 1 Kms Flown Daily[Team] = Route C5 Airplane Model 1 Actual Trips * Market C Roundtrip Distance

D Route C5 Airplane Model 2 Trips[Team] = 0
P Route C5 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route C5 Airplane Model 2 Proposed Trips[Team] = IF(Route C5 Online = 0, 0, Route C5 Airplane Model 2 Trips)
V Route C5 Airplane Model 2 Actual Trips[Team] = IF(Route C5 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route C5 Airplane Model 2 Trips))
V Route C5 Airplane Model 2 Kms Flown Daily[Team] = Route C5 Airplane Model 2 Actual Trips * Market C Roundtrip Distance

D Route C5 Airplane Model 3 Trips[Team] = 0
P Route C5 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route C5 Airplane Model 3 Proposed Trips[Team] = IF(Route C5 Online = 0, 0, Route C5 Airplane Model 3 Trips)
V Route C5 Airplane Model 3 Actual Trips[Team] = IF(Route C5 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route C5 Airplane Model 3 Trips))
V Route C5 Airplane Model 3 Kms Flown Daily[Team] = Route C5 Airplane Model 3 Actual Trips * Market C Roundtrip Distance

D Route C5 Airplane Model 4 Trips[Team] = 0
P Route C5 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route C5 Airplane Model 4 Proposed Trips[Team] = IF(Route C5 Online = 0, 0, Route C5 Airplane Model 4 Trips)
V Route C5 Airplane Model 4 Actual Trips[Team] = IF(Route C5 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route C5 Airplane Model 4 Trips))
V Route C5 Airplane Model 4 Kms Flown Daily[Team] = Route C5 Airplane Model 4 Actual Trips * Market C Roundtrip Distance

D Route C5 Airplane Model 5 Trips[Team] = 0
P Route C5 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route C5 Airplane Model 5 Proposed Trips[Team] = IF(Route C5 Online = 0, 0, Route C5 Airplane Model 5 Trips)
V Route C5 Airplane Model 5 Actual Trips[Team] = IF(Route C5 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route C5 Airplane Model 5 Trips))
V Route C5 Airplane Model 5 Kms Flown Daily[Team] = Route C5 Airplane Model 5 Actual Trips * Market C Roundtrip Distance

D Route C5 Airplane Model 6 Trips[Team] = 0
P Route C5 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route C5 Airplane Model 6 Proposed Trips[Team] = IF(Route C5 Online = 0, 0, Route C5 Airplane Model 6 Trips)
V Route C5 Airplane Model 6 Actual Trips[Team] = IF(Route C5 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route C5 Airplane Model 6 Trips))
V Route C5 Airplane Model 6 Kms Flown Daily[Team] = Route C5 Airplane Model 6 Actual Trips * Market C Roundtrip Distance

D Route C5 Airplane Model 7 Trips[Team] = 0
P Route C5 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route C5 Airplane Model 7 Proposed Trips[Team] = IF(Route C5 Online = 0, 0, Route C5 Airplane Model 7 Trips)
V Route C5 Airplane Model 7 Actual Trips[Team] = IF(Route C5 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route C5 Airplane Model 7 Trips))
V Route C5 Airplane Model 7 Kms Flown Daily[Team] = Route C5 Airplane Model 7 Actual Trips * Market C Roundtrip Distance


## Route Pricing ##

V Route C5 Price Economy Number Of Teams[Team] = IF(Route C5 Online = 1 & Price Structure = 1, 1, 0)
V Route C5 Price Normal Number Of Teams[Team] = IF(Route C5 Online = 1 & Price Structure = 2, 1, 0)
V Route C5 Price Luxury Number Of Teams[Team] = IF(Route C5 Online = 1 & Price Structure = 3, 1, 0)

V Route C5 Price Sensitivity Economy = 1.001
V Route C5 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route C5 Price Economy Number Of Teams)) / Price Economy) ^ Route C5 Price Sensitivity Economy)
V Route C5 Price Market Share Economy[Team] = (Route C5 Price Attractiveness Economy / ARRAYSUM(Route C5 Price Attractiveness Economy))

V Route C5 Middling of Price[Team] = IF(Route C5 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route C5 Price Normal Number Of Teams)) - 0.12)), 0)
V Route C5 Price Sensitivity Normal = 1.5
V Route C5 Price Attractiveness Normal[Team] = (ARRAYAVG(Route C5 Middling of Price) / Route C5 Middling of Price) ^ Route C5 Price Sensitivity Normal
V Route C5 Price Market Share Normal[Team] = (Route C5 Price Attractiveness Normal / ARRAYSUM(Route C5 Price Attractiveness Normal))

V Route C5 Price Sensitivity Luxury = 1.001
V Route C5 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route C5 Price Luxury Number Of Teams))) ^ Route C5 Price Sensitivity Luxury)
V Route C5 Price Market Share Luxury[Team] = (Route C5 Price Attractiveness Luxury / ARRAYSUM(Route C5 Price Attractiveness Luxury))

V Route C5 Price Overall Market Share[Team] = IF(Price Structure = 1, Route C5 Price Market Share Economy, IF(Price Structure = 2, Route C5 Price Market Share Normal, Route C5 Price Market Share Luxury))

## Route Expenses5##

V Route C5 Opening Expense[Team] = IF(PREVIOUS(Route C5 Online = 0) & Route C5 Online = 1, Route Const Opening New Route Expense, 0) 

V Route C5 Fuel Expenses Airplane Model 1[Team] = Route C5 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route C5 Fuel Expenses Airplane Model 2[Team] = Route C5 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route C5 Fuel Expenses Airplane Model 3[Team] = Route C5 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route C5 Fuel Expenses Airplane Model 4[Team] = Route C5 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route C5 Fuel Expenses Airplane Model 5[Team] = Route C5 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route C5 Fuel Expenses Airplane Model 6[Team] = Route C5 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route C5 Fuel Expenses Airplane Model 7[Team] = Route C5 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route C5 Total Fuel Expenses[Team] = Route C5 Fuel Expenses Airplane Model 1 + Route C5 Fuel Expenses Airplane Model 2 + Route C5 Fuel Expenses Airplane Model 3 + Route C5 Fuel Expenses Airplane Model 4 + Route C5 Fuel Expenses Airplane Model 5 + Route C5 Fuel Expenses Airplane Model 6 + Route C5 Fuel Expenses Airplane Model 7 


##### MARKET D #####

V Market D Roundtrip Distance = 7606
V Market D Demand[3] = {PREVIOUS(Market D Demand[1] * 1.02, 550), PREVIOUS(Market D Demand[2] * 1.02, 1250), PREVIOUS(Market D Demand[3] * 1.02, 500)}

V Market D Total Available Seat Kms Airplane Model 1[Team] = Route D1 Airplane Model 1 Kms Flown Daily + Route D2 Airplane Model 1 Kms Flown Daily + Route D3 Airplane Model 1 Kms Flown Daily + Route D4 Airplane Model 1 Kms Flown Daily + Route D5 Airplane Model 1 Kms Flown Daily
V Market D Total Actual Seat Kms Airplane Model 1[Team] = Market D Total Available Seat Kms Airplane Model 1 * X Reliability Variable
V Market D Total Available Seat Kms Airplane Model 2[Team] = Route D1 Airplane Model 2 Kms Flown Daily + Route D2 Airplane Model 2 Kms Flown Daily + Route D3 Airplane Model 2 Kms Flown Daily + Route D4 Airplane Model 2 Kms Flown Daily + Route D5 Airplane Model 2 Kms Flown Daily
V Market D Total Actual Seat Kms Airplane Model 2[Team] = Market D Total Available Seat Kms Airplane Model 2 * X Reliability Variable
V Market D Total Available Seat Kms Airplane Model 3[Team] = Route D1 Airplane Model 3 Kms Flown Daily + Route D2 Airplane Model 3 Kms Flown Daily + Route D3 Airplane Model 3 Kms Flown Daily + Route D4 Airplane Model 3 Kms Flown Daily + Route D5 Airplane Model 3 Kms Flown Daily
V Market D Total Actual Seat Kms Airplane Model 3[Team] = Market D Total Available Seat Kms Airplane Model 3 * X Reliability Variable
V Market D Total Available Seat Kms Airplane Model 4[Team] = Route D1 Airplane Model 4 Kms Flown Daily + Route D2 Airplane Model 4 Kms Flown Daily + Route D3 Airplane Model 4 Kms Flown Daily + Route D4 Airplane Model 4 Kms Flown Daily + Route D5 Airplane Model 4 Kms Flown Daily
V Market D Total Actual Seat Kms Airplane Model 4[Team] = Market D Total Available Seat Kms Airplane Model 4 * X Reliability Variable
V Market D Total Available Seat Kms Airplane Model 5[Team] = Route D1 Airplane Model 5 Kms Flown Daily + Route D2 Airplane Model 5 Kms Flown Daily + Route D3 Airplane Model 5 Kms Flown Daily + Route D4 Airplane Model 5 Kms Flown Daily + Route D5 Airplane Model 5 Kms Flown Daily
V Market D Total Actual Seat Kms Airplane Model 5[Team] = Market D Total Available Seat Kms Airplane Model 5 * X Reliability Variable
V Market D Total Available Seat Kms Airplane Model 6[Team] = Route D1 Airplane Model 6 Kms Flown Daily + Route D2 Airplane Model 6 Kms Flown Daily + Route D3 Airplane Model 6 Kms Flown Daily + Route D4 Airplane Model 6 Kms Flown Daily + Route D5 Airplane Model 6 Kms Flown Daily
V Market D Total Actual Seat Kms Airplane Model 6[Team] = Market D Total Available Seat Kms Airplane Model 6 * X Reliability Variable
V Market D Total Available Seat Kms Airplane Model 7[Team] = Route D1 Airplane Model 7 Kms Flown Daily + Route D2 Airplane Model 7 Kms Flown Daily + Route D3 Airplane Model 7 Kms Flown Daily + Route D4 Airplane Model 7 Kms Flown Daily + Route D5 Airplane Model 7 Kms Flown Daily
V Market D Total Actual Seat Kms Airplane Model 7[Team] = Market D Total Available Seat Kms Airplane Model 7 * X Reliability Variable

V Market D Opening Expenses[Team] = Route D1 Opening Expense + Route D2 Opening Expense + Route D3 Opening Expense + Route D4 Opening Expense + Route D5 Opening Expense
V Market D Fuel Expenses[Team] = Route D1 Total Fuel Expenses + Route D2 Total Fuel Expenses + Route D3 Total Fuel Expenses + Route D4 Total Fuel Expenses + Route D5 Total Fuel Expenses

V Market D Total Available Seat Kms[Team] = Route D1 Available Seat Kms + Route D2 Available Seat Kms + Route D3 Available Seat Kms + Route D4 Available Seat Kms + Route D5 Available Seat Kms

V Market D Total Revenue Passenger Kms[Team] =  Route D1 Revenue Passenger Kms + Route D2 Revenue Passenger Kms + Route D3 Revenue Passenger Kms + Route D4 Revenue Passenger Kms + Route D5 Revenue Passenger Kms

V Market D Total Planned Daily Flight Distance[Team] = Route D1 Roundtrip Distance Planned + Route D2 Roundtrip Distance Planned + Route D3 Roundtrip Distance Planned + Route D4 Roundtrip Distance Planned + Route D5 Roundtrip Distance Planned

V Market D Final Sales[Team] = (Route D1 Final Sales + Route D2 Final Sales + Route D3 Final Sales + Route D4 Final Sales + Route D5 Final Sales) * Market D Roundtrip Distance

V Airplane 1 Fleet Market D Total Trips[Team] = (Route D1 Airplane Model 1 Proposed Trips + Route D2 Airplane Model 1 Proposed Trips + Route D3 Airplane Model 1 Proposed Trips + Route D4 Airplane Model 1 Proposed Trips + Route D5 Airplane Model 1 Proposed Trips) * Market D Roundtrip Distance
V Airplane 2 Fleet Market D Total Trips[Team] = (Route D1 Airplane Model 2 Proposed Trips + Route D2 Airplane Model 2 Proposed Trips + Route D3 Airplane Model 2 Proposed Trips + Route D4 Airplane Model 2 Proposed Trips + Route D5 Airplane Model 2 Proposed Trips) * Market D Roundtrip Distance
V Airplane 3 Fleet Market D Total Trips[Team] = (Route D1 Airplane Model 3 Proposed Trips + Route D2 Airplane Model 3 Proposed Trips + Route D3 Airplane Model 3 Proposed Trips + Route D4 Airplane Model 3 Proposed Trips + Route D5 Airplane Model 3 Proposed Trips) * Market D Roundtrip Distance
V Airplane 4 Fleet Market D Total Trips[Team] = (Route D1 Airplane Model 4 Proposed Trips + Route D2 Airplane Model 4 Proposed Trips + Route D3 Airplane Model 4 Proposed Trips + Route D4 Airplane Model 4 Proposed Trips + Route D5 Airplane Model 4 Proposed Trips) * Market D Roundtrip Distance
V Airplane 5 Fleet Market D Total Trips[Team] = (Route D1 Airplane Model 5 Proposed Trips + Route D2 Airplane Model 5 Proposed Trips + Route D3 Airplane Model 5 Proposed Trips + Route D4 Airplane Model 5 Proposed Trips + Route D5 Airplane Model 5 Proposed Trips) * Market D Roundtrip Distance
V Airplane 6 Fleet Market D Total Trips[Team] = (Route D1 Airplane Model 6 Proposed Trips + Route D2 Airplane Model 6 Proposed Trips + Route D3 Airplane Model 6 Proposed Trips + Route D4 Airplane Model 6 Proposed Trips + Route D5 Airplane Model 6 Proposed Trips) * Market D Roundtrip Distance
V Airplane 7 Fleet Market D Total Trips[Team] = (Route D1 Airplane Model 7 Proposed Trips + Route D2 Airplane Model 7 Proposed Trips + Route D3 Airplane Model 7 Proposed Trips + Route D4 Airplane Model 7 Proposed Trips + Route D5 Airplane Model 7 Proposed Trips) * Market D Roundtrip Distance


### Route D1 ###

#V Route D1 Roundtrip Distance = 832

V Route D1 Roundtrip Distance Planned[Team] = Market D Roundtrip Distance * Route D1 Return Trips

## Route D1 Establishment ##

#V Route D1 Demand[3] = {PREVIOUS(Route D1 Demand[1] * 1.02, 800), PREVIOUS(Route D1 Demand[2] * 1.02, 1000), PREVIOUS(Route D1 Demand[3] * 1.02, 700)}
V Route D1 Demand For Teams[3] = {Market D Demand[1] + ((SQRT(Market D Demand[1] / 10 * Route D1 Num Of Teams[1])) * 10), Market D Demand[2] + ((SQRT(Market D Demand[2] / 10 * Route D1 Num Of Teams[2])) * 10), Market D Demand[3] + ((SQRT(Market D Demand[3] / 10 * Route D1 Num Of Teams[3])) * 10)}
D Route D1 Online[Team] = 0
P Route D1 Online.ExecuteDecisionImmediately = true

#V Route D1 Opening Expense[Team] = IF(PREVIOUS(Route D1 Online = 0) & Route D1 Online = 1, Route Const Opening New Route Expense, 0) 

V Route D1 Online Economy[Team] = IF(Route D1 Online = 1 & Price Structure = 1, 1, 0)
V Route D1 Online Normal[Team] = IF(Route D1 Online = 1 & Price Structure = 2, 1, 0)
V Route D1 Online Luxury[Team] = IF(Route D1 Online = 1 & Price Structure = 3, 1, 0)

V Route D1 First Quarter Online[Team] = REMEMBER((Route D1 Online = 1) & (PREVIOUS(Route D1 Online) = 0), STEP)
V Route D1 Number Of Quarters Online[Team] = IF(Route D1 Online = 1, STEP - Route D1 First Quarter Online + 1, 0)
V Route D1 Num Of Teams[3] = {ARRAYSUM(Route D1 Online Economy), ARRAYSUM(Route D1 Online Normal), ARRAYSUM(Route D1 Online Luxury)}

#V Route D1 Norm Quarters[Team] = 0 + IF(Route D1 Norm Online = 1, 1, (-1) * Route D1 Norm Quarters Mirror)
#V Route D1 Norm Quarters Mirror[Team] = Route D1 Norm Quarters
#P Route D1 Norm Quarters Mirror.ExecuteDecisionImmediately = false

V Route D1 Attractiveness[Team] = IF(Route D1 Number Of Quarters Online = 1, 1, SQRT(Route D1 Number Of Quarters Online) + Route D1 Number Of Quarters Online)

V Route D1 Attractiveness Economy[Team] = IF(Route D1 Online = 1 & Price Structure = 1, Route D1 Attractiveness, 0)
V Route D1 Attractiveness Normal[Team] = IF(Route D1 Online = 1 & Price Structure = 2, Route D1 Attractiveness, 0)
V Route D1 Attractiveness Luxury[Team] = IF(Route D1 Online = 1 & Price Structure = 3, Route D1 Attractiveness, 0)

V Route D1 Market Share[Team] = (Route D1 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route D1 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route D1 Attractiveness Normal), ARRAYSUM(Route D1 Attractiveness Luxury))))
V Route D1 Total Market Share[Team] = IF(Route D1 Online = 0, 0, (0.5 * Route D1 Market Share ) + (0.2 * Route D1 Return Trips Market Share) + (0.3 * Route D1 Price Overall Market Share))
V Route D1 Market Share For Customers[Team] = Route D1 Total Market Share * (IF(Price Structure = 1, Route D1 Demand For Teams[1], IF(Price Structure = 2, Route D1 Demand For Teams[2], Route D1 Demand For Teams[3])))

V Route D1 Sales[Team] = Route D1 Total Market Share * (IF(Price Structure = 1, Route D1 Demand For Teams[1], IF(Price Structure = 2, Route D1 Demand For Teams[2], Route D1 Demand For Teams[3])))

V Route D1 Final Sales[Team] = IF(Route D1 Sales > Route D1 Seat Supply, Route D1 Seat Supply, Route D1 Sales)

V Route D1 Revenue Passenger Kms[Team] = Route D1 Final Sales * Market D Roundtrip Distance

## Route Trips ##
D Route D1 Return Trips[Team] = 0
P Route D1 Return Trips.ExecuteDecisionImmediately = true
V Route D1 Return Trips Previ[Team] = PREVIOUS(Route D1 Return Trips, 0)
V Route D1 Return Trips Sensitivity = 1.5

V Route D1 Average Number Of Trips = IF(ARRAYSUM(Route D1 Online) = 0, 0, ARRAYSUM(Route D1 Return Trips) / ARRAYSUM(Route D1 Online))
V Route D1 Average Number Of Trips Previ = PREVIOUS(Route D1 Average Number Of Trips, 0)

V Route D1 Return Trips Economy[Team] = IF(Route D1 Online = 1 & Price Structure = 1, Route D1 Return Trips, 0)
V Route D1 Return Trips Normal[Team] = IF(Route D1 Online = 1 & Price Structure = 2, Route D1 Return Trips, 0)
V Route D1 Return Trips Luxury[Team] = IF(Route D1 Online = 1 & Price Structure = 3, Route D1 Return Trips, 0)

V Route D1 Return Trips Attractiveness[Team] = (Route D1 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route D1 Return Trips Economy) / Route D1 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route D1 Return Trips Normal) / Route D1 Num Of Teams[2], ARRAYSUM(Route D1 Return Trips Luxury) / Route D1 Num Of Teams[3]))) ^ Route D1 Return Trips Sensitivity

V Route D1 Return Trips Attractiveness Economy[Team] = IF(Route D1 Online = 1 & Price Structure = 1, Route D1 Return Trips Attractiveness, 0)
V Route D1 Return Trips Attractiveness Normal[Team] = IF(Route D1 Online = 1 & Price Structure = 2, Route D1 Return Trips Attractiveness, 0)
V Route D1 Return Trips Attractiveness Luxury[Team] = IF(Route D1 Online = 1 & Price Structure = 3, Route D1 Return Trips Attractiveness, 0)

V Route D1 Return Trips Market Share[Team] = (Route D1 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route D1 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route D1 Return Trips Attractiveness Normal), ARRAYSUM(Route D1 Return Trips Attractiveness Luxury))))

V Route D1 Seat Supply[Team] = Route D1 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route D1 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route D1 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route D1 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route D1 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route D1 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route D1 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route D1 Available Seat Kms[Team] = Route D1 Seat Supply * Market D Roundtrip Distance

# Route Trips By Plane #

V Route D1 Total Airplane Kms Planned[Team] = Route D1 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route D1 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route D1 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route D1 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route D1 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route D1 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route D1 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route D1 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route D1 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route D1 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route D1 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route D1 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route D1 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route D1 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route D1 Airplane Model 7 Trips)
V Z Route D1 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route D1 Return Trips - Route D1 Total Plane Trips Scheduled

D Route D1 Airplane Model 1 Trips[Team] = 0
P Route D1 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route D1 Airplane Model 1 Proposed Trips[Team] = IF(Route D1 Online = 0, 0, Route D1 Airplane Model 1 Trips)
V Route D1 Airplane Model 1 Actual Trips[Team] = IF(Route D1 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route D1 Airplane Model 1 Trips))
V Route D1 Airplane Model 1 Kms Flown Daily[Team] = Route D1 Airplane Model 1 Actual Trips * Market D Roundtrip Distance

D Route D1 Airplane Model 2 Trips[Team] = 0
P Route D1 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route D1 Airplane Model 2 Proposed Trips[Team] = IF(Route D1 Online = 0, 0, Route D1 Airplane Model 2 Trips)
V Route D1 Airplane Model 2 Actual Trips[Team] = IF(Route D1 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route D1 Airplane Model 2 Trips))
V Route D1 Airplane Model 2 Kms Flown Daily[Team] = Route D1 Airplane Model 2 Actual Trips * Market D Roundtrip Distance

D Route D1 Airplane Model 3 Trips[Team] = 0
P Route D1 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route D1 Airplane Model 3 Proposed Trips[Team] = IF(Route D1 Online = 0, 0, Route D1 Airplane Model 3 Trips)
V Route D1 Airplane Model 3 Actual Trips[Team] = IF(Route D1 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route D1 Airplane Model 3 Trips))
V Route D1 Airplane Model 3 Kms Flown Daily[Team] = Route D1 Airplane Model 3 Actual Trips * Market D Roundtrip Distance

D Route D1 Airplane Model 4 Trips[Team] = 0
P Route D1 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route D1 Airplane Model 4 Proposed Trips[Team] = IF(Route D1 Online = 0, 0, Route D1 Airplane Model 4 Trips)
V Route D1 Airplane Model 4 Actual Trips[Team] = IF(Route D1 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route D1 Airplane Model 4 Trips))
V Route D1 Airplane Model 4 Kms Flown Daily[Team] = Route D1 Airplane Model 4 Actual Trips * Market D Roundtrip Distance

D Route D1 Airplane Model 5 Trips[Team] = 0
P Route D1 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route D1 Airplane Model 5 Proposed Trips[Team] = IF(Route D1 Online = 0, 0, Route D1 Airplane Model 5 Trips)
V Route D1 Airplane Model 5 Actual Trips[Team] = IF(Route D1 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route D1 Airplane Model 5 Trips))
V Route D1 Airplane Model 5 Kms Flown Daily[Team] = Route D1 Airplane Model 5 Actual Trips * Market D Roundtrip Distance

D Route D1 Airplane Model 6 Trips[Team] = 0
P Route D1 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route D1 Airplane Model 6 Proposed Trips[Team] = IF(Route D1 Online = 0, 0, Route D1 Airplane Model 6 Trips)
V Route D1 Airplane Model 6 Actual Trips[Team] = IF(Route D1 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route D1 Airplane Model 6 Trips))
V Route D1 Airplane Model 6 Kms Flown Daily[Team] = Route D1 Airplane Model 6 Actual Trips * Market D Roundtrip Distance

D Route D1 Airplane Model 7 Trips[Team] = 0
P Route D1 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route D1 Airplane Model 7 Proposed Trips[Team] = IF(Route D1 Online = 0, 0, Route D1 Airplane Model 7 Trips)
V Route D1 Airplane Model 7 Actual Trips[Team] = IF(Route D1 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route D1 Airplane Model 7 Trips))
V Route D1 Airplane Model 7 Kms Flown Daily[Team] = Route D1 Airplane Model 7 Actual Trips * Market D Roundtrip Distance


## Route Pricing ##
V Route D1 Price Economy Number Of Teams[Team] = IF(Route D1 Online = 1 & Price Structure = 1, 1, 0)
V Route D1 Price Normal Number Of Teams[Team] = IF(Route D1 Online = 1 & Price Structure = 2, 1, 0)
V Route D1 Price Luxury Number Of Teams[Team] = IF(Route D1 Online = 1 & Price Structure = 3, 1, 0)

V Route D1 Price Sensitivity Economy = 1.001
V Route D1 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route D1 Price Economy Number Of Teams)) / Price Economy) ^ Route D1 Price Sensitivity Economy)
V Route D1 Price Market Share Economy[Team] = (Route D1 Price Attractiveness Economy / ARRAYSUM(Route D1 Price Attractiveness Economy))

V Route D1 Middling of Price[Team] = IF(Route D1 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route D1 Price Normal Number Of Teams)) - 0.12)), 0)
V Route D1 Price Sensitivity Normal = 1.5
V Route D1 Price Attractiveness Normal[Team] = (ARRAYAVG(Route D1 Middling of Price) / Route D1 Middling of Price) ^ Route D1 Price Sensitivity Normal
V Route D1 Price Market Share Normal[Team] = (Route D1 Price Attractiveness Normal / ARRAYSUM(Route D1 Price Attractiveness Normal))

V Route D1 Price Sensitivity Luxury = 1.001
V Route D1 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route D1 Price Luxury Number Of Teams))) ^ Route D1 Price Sensitivity Luxury)
V Route D1 Price Market Share Luxury[Team] = (Route D1 Price Attractiveness Luxury / ARRAYSUM(Route D1 Price Attractiveness Luxury))

V Route D1 Price Overall Market Share[Team] = IF(Price Structure = 1, Route D1 Price Market Share Economy, IF(Price Structure = 2, Route D1 Price Market Share Normal, Route D1 Price Market Share Luxury))

## Route Expenses1 ##

V Route D1 Opening Expense[Team] = IF(PREVIOUS(Route D1 Online = 0) & Route D1 Online = 1, Route Const Opening New Route Expense, 0) 

V Route D1 Fuel Expenses Airplane Model 1[Team] = Route D1 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route D1 Fuel Expenses Airplane Model 2[Team] = Route D1 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route D1 Fuel Expenses Airplane Model 3[Team] = Route D1 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route D1 Fuel Expenses Airplane Model 4[Team] = Route D1 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route D1 Fuel Expenses Airplane Model 5[Team] = Route D1 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route D1 Fuel Expenses Airplane Model 6[Team] = Route D1 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route D1 Fuel Expenses Airplane Model 7[Team] = Route D1 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route D1 Total Fuel Expenses[Team] = Route D1 Fuel Expenses Airplane Model 1 + Route D1 Fuel Expenses Airplane Model 2 + Route D1 Fuel Expenses Airplane Model 3 + Route D1 Fuel Expenses Airplane Model 4 + Route D1 Fuel Expenses Airplane Model 5 + Route D1 Fuel Expenses Airplane Model 6 + Route D1 Fuel Expenses Airplane Model 7 


### Route D2 ###

V Route D2 Roundtrip Distance Planned[Team] = Market D Roundtrip Distance * Route D2 Return Trips

## Route D2 Establishment ########
V Route D2 Demand For Teams[3] = {Market D Demand[1] + ((SQRT(Market D Demand[1] / 10 * Route D2 Num Of Teams[1])) * 10), Market D Demand[2] + ((SQRT(Market D Demand[2] / 10 * Route D2 Num Of Teams[2])) * 10), Market D Demand[3] + ((SQRT(Market D Demand[3] / 10 * Route D2 Num Of Teams[3])) * 10)}
D Route D2 Online[Team] = 0
P Route D2 Online.ExecuteDecisionImmediately = true

#V Route D2 Opening Expense[Team] = IF(PREVIOUS(Route D2 Online = 0) & Route D2 Online = 1, Route Const Opening New Route Expense, 0) 

V Route D2 Online Economy[Team] = IF(Route D2 Online = 1 & Price Structure = 1, 1, 0)
V Route D2 Online Normal[Team] = IF(Route D2 Online = 1 & Price Structure = 2, 1, 0)
V Route D2 Online Luxury[Team] = IF(Route D2 Online = 1 & Price Structure = 3, 1, 0)

V Route D2 First Quarter Online[Team] = REMEMBER((Route D2 Online = 1) & (PREVIOUS(Route D2 Online) = 0), STEP)
V Route D2 Number Of Quarters Online[Team] = IF(Route D2 Online = 1, STEP - Route D2 First Quarter Online + 1, 0)
V Route D2 Num Of Teams[3] = {ARRAYSUM(Route D2 Online Economy), ARRAYSUM(Route D2 Online Normal), ARRAYSUM(Route D2 Online Luxury)}

V Route D2 Attractiveness[Team] = IF(Route D2 Number Of Quarters Online = 1, 1, SQRT(Route D2 Number Of Quarters Online) + Route D2 Number Of Quarters Online)

V Route D2 Attractiveness Economy[Team] = IF(Route D2 Online = 1 & Price Structure = 1, Route D2 Attractiveness, 0)
V Route D2 Attractiveness Normal[Team] = IF(Route D2 Online = 1 & Price Structure = 2, Route D2 Attractiveness, 0)
V Route D2 Attractiveness Luxury[Team] = IF(Route D2 Online = 1 & Price Structure = 3, Route D2 Attractiveness, 0)

V Route D2 Market Share[Team] = (Route D2 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route D2 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route D2 Attractiveness Normal), ARRAYSUM(Route D2 Attractiveness Luxury))))
V Route D2 Total Market Share[Team] = IF(Route D2 Online = 0, 0, (0.5 * Route D2 Market Share ) + (0.2 * Route D2 Return Trips Market Share) + (0.3 * Route D2 Price Overall Market Share))
V Route D2 Market Share For Customers[Team] = Route D2 Total Market Share * (IF(Price Structure = 1, Route D2 Demand For Teams[1], IF(Price Structure = 2, Route D2 Demand For Teams[2], Route D2 Demand For Teams[3])))

V Route D2 Sales[Team] = Route D2 Total Market Share * (IF(Price Structure = 1, Route D2 Demand For Teams[1], IF(Price Structure = 2, Route D2 Demand For Teams[2], Route D2 Demand For Teams[3])))

V Route D2 Final Sales[Team] = IF(Route D2 Sales > Route D2 Seat Supply, Route D2 Seat Supply, Route D2 Sales)

V Route D2 Revenue Passenger Kms[Team] = Route D2 Final Sales * Market D Roundtrip Distance

# Route Trips
D Route D2 Return Trips[Team] = 0
P Route D2 Return Trips.ExecuteDecisionImmediately = true
V Route D2 Return Trips Previ[Team] = PREVIOUS(Route D2 Return Trips, 0)
V Route D2 Return Trips Sensitivity = 1.5

V Route D2 Average Number Of Trips = IF(ARRAYSUM(Route D2 Online) = 0, 0, ARRAYSUM(Route D2 Return Trips) / ARRAYSUM(Route D2 Online))
V Route D2 Average Number Of Trips Previ = PREVIOUS(Route D2 Average Number Of Trips, 0)

V Route D2 Return Trips Economy[Team] = IF(Route D2 Online = 1 & Price Structure = 1, Route D2 Return Trips, 0)
V Route D2 Return Trips Normal[Team] = IF(Route D2 Online = 1 & Price Structure = 2, Route D2 Return Trips, 0)
V Route D2 Return Trips Luxury[Team] = IF(Route D2 Online = 1 & Price Structure = 3, Route D2 Return Trips, 0)

V Route D2 Return Trips Attractiveness[Team] = (Route D2 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route D2 Return Trips Economy) / Route D2 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route D2 Return Trips Normal) / Route D2 Num Of Teams[2], ARRAYSUM(Route D2 Return Trips Luxury) / Route D2 Num Of Teams[3]))) ^ Route D2 Return Trips Sensitivity

V Route D2 Return Trips Attractiveness Economy[Team] = IF(Route D2 Online = 1 & Price Structure = 1, Route D2 Return Trips Attractiveness, 0)
V Route D2 Return Trips Attractiveness Normal[Team] = IF(Route D2 Online = 1 & Price Structure = 2, Route D2 Return Trips Attractiveness, 0)
V Route D2 Return Trips Attractiveness Luxury[Team] = IF(Route D2 Online = 1 & Price Structure = 3, Route D2 Return Trips Attractiveness, 0)

V Route D2 Return Trips Market Share[Team] = (Route D2 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route D2 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route D2 Return Trips Attractiveness Normal), ARRAYSUM(Route D2 Return Trips Attractiveness Luxury))))

V Route D2 Seat Supply[Team] = Route D2 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route D2 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route D2 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route D2 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route D2 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route D2 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route D2 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route D2 Available Seat Kms[Team] = Route D2 Seat Supply * Market D Roundtrip Distance

# Route Trips By Plane #

V Route D2 Total Airplane Kms Planned[Team] = Route D2 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route D2 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route D2 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route D2 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route D2 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route D2 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route D2 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route D2 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route D2 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route D2 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route D2 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route D2 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route D2 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route D2 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route D2 Airplane Model 7 Trips)
V Z Route D2 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route D2 Return Trips - Route D2 Total Plane Trips Scheduled

D Route D2 Airplane Model 1 Trips[Team] = 0
P Route D2 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route D2 Airplane Model 1 Proposed Trips[Team] = IF(Route D2 Online = 0, 0, Route D2 Airplane Model 1 Trips)
V Route D2 Airplane Model 1 Actual Trips[Team] = IF(Route D2 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route D2 Airplane Model 1 Trips))
V Route D2 Airplane Model 1 Kms Flown Daily[Team] = Route D2 Airplane Model 1 Actual Trips * Market D Roundtrip Distance

D Route D2 Airplane Model 2 Trips[Team] = 0
P Route D2 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route D2 Airplane Model 2 Proposed Trips[Team] = IF(Route D2 Online = 0, 0, Route D2 Airplane Model 2 Trips)
V Route D2 Airplane Model 2 Actual Trips[Team] = IF(Route D2 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route D2 Airplane Model 2 Trips))
V Route D2 Airplane Model 2 Kms Flown Daily[Team] = Route D2 Airplane Model 2 Actual Trips * Market D Roundtrip Distance

D Route D2 Airplane Model 3 Trips[Team] = 0
P Route D2 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route D2 Airplane Model 3 Proposed Trips[Team] = IF(Route D2 Online = 0, 0, Route D2 Airplane Model 3 Trips)
V Route D2 Airplane Model 3 Actual Trips[Team] = IF(Route D2 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route D2 Airplane Model 3 Trips))
V Route D2 Airplane Model 3 Kms Flown Daily[Team] = Route D2 Airplane Model 3 Actual Trips * Market D Roundtrip Distance

D Route D2 Airplane Model 4 Trips[Team] = 0
P Route D2 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route D2 Airplane Model 4 Proposed Trips[Team] = IF(Route D2 Online = 0, 0, Route D2 Airplane Model 4 Trips)
V Route D2 Airplane Model 4 Actual Trips[Team] = IF(Route D2 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route D2 Airplane Model 4 Trips))
V Route D2 Airplane Model 4 Kms Flown Daily[Team] = Route D2 Airplane Model 4 Actual Trips * Market D Roundtrip Distance

D Route D2 Airplane Model 5 Trips[Team] = 0
P Route D2 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route D2 Airplane Model 5 Proposed Trips[Team] = IF(Route D2 Online = 0, 0, Route D2 Airplane Model 5 Trips)
V Route D2 Airplane Model 5 Actual Trips[Team] = IF(Route D2 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route D2 Airplane Model 5 Trips))
V Route D2 Airplane Model 5 Kms Flown Daily[Team] = Route D2 Airplane Model 5 Actual Trips * Market D Roundtrip Distance

D Route D2 Airplane Model 6 Trips[Team] = 0
P Route D2 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route D2 Airplane Model 6 Proposed Trips[Team] = IF(Route D2 Online = 0, 0, Route D2 Airplane Model 6 Trips)
V Route D2 Airplane Model 6 Actual Trips[Team] = IF(Route D2 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route D2 Airplane Model 6 Trips))
V Route D2 Airplane Model 6 Kms Flown Daily[Team] = Route D2 Airplane Model 6 Actual Trips * Market D Roundtrip Distance

D Route D2 Airplane Model 7 Trips[Team] = 0
P Route D2 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route D2 Airplane Model 7 Proposed Trips[Team] = IF(Route D2 Online = 0, 0, Route D2 Airplane Model 7 Trips)
V Route D2 Airplane Model 7 Actual Trips[Team] = IF(Route D2 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route D2 Airplane Model 7 Trips))
V Route D2 Airplane Model 7 Kms Flown Daily[Team] = Route D2 Airplane Model 7 Actual Trips * Market D Roundtrip Distance


## Route Pricing ##

V Route D2 Price Economy Number Of Teams[Team] = IF(Route D2 Online = 1 & Price Structure = 1, 1, 0)
V Route D2 Price Normal Number Of Teams[Team] = IF(Route D2 Online = 1 & Price Structure = 2, 1, 0)
V Route D2 Price Luxury Number Of Teams[Team] = IF(Route D2 Online = 1 & Price Structure = 3, 1, 0)

V Route D2 Price Sensitivity Economy = 1.001
V Route D2 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route D2 Price Economy Number Of Teams)) / Price Economy) ^ Route D2 Price Sensitivity Economy)
V Route D2 Price Market Share Economy[Team] = (Route D2 Price Attractiveness Economy / ARRAYSUM(Route D2 Price Attractiveness Economy))

V Route D2 Middling of Price[Team] = IF(Route D2 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route D2 Price Normal Number Of Teams)) - 0.12)), 0)
V Route D2 Price Sensitivity Normal = 1.5
V Route D2 Price Attractiveness Normal[Team] = (ARRAYAVG(Route D2 Middling of Price) / Route D2 Middling of Price) ^ Route D2 Price Sensitivity Normal
V Route D2 Price Market Share Normal[Team] = (Route D2 Price Attractiveness Normal / ARRAYSUM(Route D2 Price Attractiveness Normal))

V Route D2 Price Sensitivity Luxury = 1.001
V Route D2 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route D2 Price Luxury Number Of Teams))) ^ Route D2 Price Sensitivity Luxury)
V Route D2 Price Market Share Luxury[Team] = (Route D2 Price Attractiveness Luxury / ARRAYSUM(Route D2 Price Attractiveness Luxury))

V Route D2 Price Overall Market Share[Team] = IF(Price Structure = 1, Route D2 Price Market Share Economy, IF(Price Structure = 2, Route D2 Price Market Share Normal, Route D2 Price Market Share Luxury))

## Route Expenses2 ##

V Route D2 Opening Expense[Team] = IF(PREVIOUS(Route D2 Online = 0) & Route D2 Online = 1, Route Const Opening New Route Expense, 0) 

V Route D2 Fuel Expenses Airplane Model 1[Team] = Route D2 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route D2 Fuel Expenses Airplane Model 2[Team] = Route D2 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route D2 Fuel Expenses Airplane Model 3[Team] = Route D2 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route D2 Fuel Expenses Airplane Model 4[Team] = Route D2 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route D2 Fuel Expenses Airplane Model 5[Team] = Route D2 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route D2 Fuel Expenses Airplane Model 6[Team] = Route D2 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route D2 Fuel Expenses Airplane Model 7[Team] = Route D2 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route D2 Total Fuel Expenses[Team] = Route D2 Fuel Expenses Airplane Model 1 + Route D2 Fuel Expenses Airplane Model 2 + Route D2 Fuel Expenses Airplane Model 3 + Route D2 Fuel Expenses Airplane Model 4 + Route D2 Fuel Expenses Airplane Model 5 + Route D2 Fuel Expenses Airplane Model 6 + Route D2 Fuel Expenses Airplane Model 7 


### Route D3 ###

V Route D3 Roundtrip Distance Planned[Team] = Market D Roundtrip Distance * Route D3 Return Trips

## Route D3 Establishment ########
V Route D3 Demand For Teams[3] = {Market D Demand[1] + ((SQRT(Market D Demand[1] / 10 * Route D3 Num Of Teams[1])) * 10), Market D Demand[2] + ((SQRT(Market D Demand[2] / 10 * Route D3 Num Of Teams[2])) * 10), Market D Demand[3] + ((SQRT(Market D Demand[3] / 10 * Route D3 Num Of Teams[3])) * 10)}
D Route D3 Online[Team] = 0
P Route D3 Online.ExecuteDecisionImmediately = true

#V Route D3 Opening Expense[Team] = IF(PREVIOUS(Route D3 Online = 0) & Route D3 Online = 1, Route Const Opening New Route Expense, 0) 

V Route D3 Online Economy[Team] = IF(Route D3 Online = 1 & Price Structure = 1, 1, 0)
V Route D3 Online Normal[Team] = IF(Route D3 Online = 1 & Price Structure = 2, 1, 0)
V Route D3 Online Luxury[Team] = IF(Route D3 Online = 1 & Price Structure = 3, 1, 0)

V Route D3 First Quarter Online[Team] = REMEMBER((Route D3 Online = 1) & (PREVIOUS(Route D3 Online) = 0), STEP)
V Route D3 Number Of Quarters Online[Team] = IF(Route D3 Online = 1, STEP - Route D3 First Quarter Online + 1, 0)
V Route D3 Num Of Teams[3] = {ARRAYSUM(Route D3 Online Economy), ARRAYSUM(Route D3 Online Normal), ARRAYSUM(Route D3 Online Luxury)}

V Route D3 Attractiveness[Team] = IF(Route D3 Number Of Quarters Online = 1, 1, SQRT(Route D3 Number Of Quarters Online) + Route D3 Number Of Quarters Online)

V Route D3 Attractiveness Economy[Team] = IF(Route D3 Online = 1 & Price Structure = 1, Route D3 Attractiveness, 0)
V Route D3 Attractiveness Normal[Team] = IF(Route D3 Online = 1 & Price Structure = 2, Route D3 Attractiveness, 0)
V Route D3 Attractiveness Luxury[Team] = IF(Route D3 Online = 1 & Price Structure = 3, Route D3 Attractiveness, 0)

V Route D3 Market Share[Team] = (Route D3 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route D3 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route D3 Attractiveness Normal), ARRAYSUM(Route D3 Attractiveness Luxury))))
V Route D3 Total Market Share[Team] = IF(Route D3 Online = 0, 0, (0.5 * Route D3 Market Share ) + (0.2 * Route D3 Return Trips Market Share) + (0.3 * Route D3 Price Overall Market Share))
V Route D3 Market Share For Customers[Team] = Route D3 Total Market Share * (IF(Price Structure = 1, Route D3 Demand For Teams[1], IF(Price Structure = 2, Route D3 Demand For Teams[2], Route D3 Demand For Teams[3])))

V Route D3 Sales[Team] = Route D3 Total Market Share * (IF(Price Structure = 1, Route D3 Demand For Teams[1], IF(Price Structure = 2, Route D3 Demand For Teams[2], Route D3 Demand For Teams[3])))

V Route D3 Final Sales[Team] = IF(Route D3 Sales > Route D3 Seat Supply, Route D3 Seat Supply, Route D3 Sales)

V Route D3 Revenue Passenger Kms[Team] = Route D3 Final Sales * Market D Roundtrip Distance

# Route Trips
D Route D3 Return Trips[Team] = 0
P Route D3 Return Trips.ExecuteDecisionImmediately = true
V Route D3 Return Trips Previ[Team] = PREVIOUS(Route D3 Return Trips, 0)
V Route D3 Return Trips Sensitivity = 1.5

V Route D3 Average Number Of Trips = IF(ARRAYSUM(Route D3 Online) = 0, 0, ARRAYSUM(Route D3 Return Trips) / ARRAYSUM(Route D3 Online))
V Route D3 Average Number Of Trips Previ = PREVIOUS(Route D3 Average Number Of Trips, 0)

V Route D3 Return Trips Economy[Team] = IF(Route D3 Online = 1 & Price Structure = 1, Route D3 Return Trips, 0)
V Route D3 Return Trips Normal[Team] = IF(Route D3 Online = 1 & Price Structure = 2, Route D3 Return Trips, 0)
V Route D3 Return Trips Luxury[Team] = IF(Route D3 Online = 1 & Price Structure = 3, Route D3 Return Trips, 0)

V Route D3 Return Trips Attractiveness[Team] = (Route D3 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route D3 Return Trips Economy) / Route D3 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route D3 Return Trips Normal) / Route D3 Num Of Teams[2], ARRAYSUM(Route D3 Return Trips Luxury) / Route D3 Num Of Teams[3]))) ^ Route D3 Return Trips Sensitivity

V Route D3 Return Trips Attractiveness Economy[Team] = IF(Route D3 Online = 1 & Price Structure = 1, Route D3 Return Trips Attractiveness, 0)
V Route D3 Return Trips Attractiveness Normal[Team] = IF(Route D3 Online = 1 & Price Structure = 2, Route D3 Return Trips Attractiveness, 0)
V Route D3 Return Trips Attractiveness Luxury[Team] = IF(Route D3 Online = 1 & Price Structure = 3, Route D3 Return Trips Attractiveness, 0)

V Route D3 Return Trips Market Share[Team] = (Route D3 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route D3 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route D3 Return Trips Attractiveness Normal), ARRAYSUM(Route D3 Return Trips Attractiveness Luxury))))

V Route D3 Seat Supply[Team] = Route D3 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route D3 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route D3 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route D3 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route D3 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route D3 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route D3 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route D3 Available Seat Kms[Team] = Route D3 Seat Supply * Market D Roundtrip Distance

# Route Trips By Plane #

V Route D3 Total Airplane Kms Planned[Team] = Route D3 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route D3 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route D3 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route D3 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route D3 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route D3 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route D3 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route D3 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route D3 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route D3 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route D3 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route D3 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route D3 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route D3 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route D3 Airplane Model 7 Trips)
V Z Route D3 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route D3 Return Trips - Route D3 Total Plane Trips Scheduled

D Route D3 Airplane Model 1 Trips[Team] = 0
P Route D3 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route D3 Airplane Model 1 Proposed Trips[Team] = IF(Route D3 Online = 0, 0, Route D3 Airplane Model 1 Trips)
V Route D3 Airplane Model 1 Actual Trips[Team] = IF(Route D3 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route D3 Airplane Model 1 Trips))
V Route D3 Airplane Model 1 Kms Flown Daily[Team] = Route D3 Airplane Model 1 Actual Trips * Market D Roundtrip Distance

D Route D3 Airplane Model 2 Trips[Team] = 0
P Route D3 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route D3 Airplane Model 2 Proposed Trips[Team] = IF(Route D3 Online = 0, 0, Route D3 Airplane Model 2 Trips)
V Route D3 Airplane Model 2 Actual Trips[Team] = IF(Route D3 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route D3 Airplane Model 2 Trips))
V Route D3 Airplane Model 2 Kms Flown Daily[Team] = Route D3 Airplane Model 2 Actual Trips * Market D Roundtrip Distance

D Route D3 Airplane Model 3 Trips[Team] = 0
P Route D3 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route D3 Airplane Model 3 Proposed Trips[Team] = IF(Route D3 Online = 0, 0, Route D3 Airplane Model 3 Trips)
V Route D3 Airplane Model 3 Actual Trips[Team] = IF(Route D3 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route D3 Airplane Model 3 Trips))
V Route D3 Airplane Model 3 Kms Flown Daily[Team] = Route D3 Airplane Model 3 Actual Trips * Market D Roundtrip Distance

D Route D3 Airplane Model 4 Trips[Team] = 0
P Route D3 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route D3 Airplane Model 4 Proposed Trips[Team] = IF(Route D3 Online = 0, 0, Route D3 Airplane Model 4 Trips)
V Route D3 Airplane Model 4 Actual Trips[Team] = IF(Route D3 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route D3 Airplane Model 4 Trips))
V Route D3 Airplane Model 4 Kms Flown Daily[Team] = Route D3 Airplane Model 4 Actual Trips * Market D Roundtrip Distance

D Route D3 Airplane Model 5 Trips[Team] = 0
P Route D3 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route D3 Airplane Model 5 Proposed Trips[Team] = IF(Route D3 Online = 0, 0, Route D3 Airplane Model 5 Trips)
V Route D3 Airplane Model 5 Actual Trips[Team] = IF(Route D3 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route D3 Airplane Model 5 Trips))
V Route D3 Airplane Model 5 Kms Flown Daily[Team] = Route D3 Airplane Model 5 Actual Trips * Market D Roundtrip Distance

D Route D3 Airplane Model 6 Trips[Team] = 0
P Route D3 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route D3 Airplane Model 6 Proposed Trips[Team] = IF(Route D3 Online = 0, 0, Route D3 Airplane Model 6 Trips)
V Route D3 Airplane Model 6 Actual Trips[Team] = IF(Route D3 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route D3 Airplane Model 6 Trips))
V Route D3 Airplane Model 6 Kms Flown Daily[Team] = Route D3 Airplane Model 6 Actual Trips * Market D Roundtrip Distance

D Route D3 Airplane Model 7 Trips[Team] = 0
P Route D3 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route D3 Airplane Model 7 Proposed Trips[Team] = IF(Route D3 Online = 0, 0, Route D3 Airplane Model 7 Trips)
V Route D3 Airplane Model 7 Actual Trips[Team] = IF(Route D3 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route D3 Airplane Model 7 Trips))
V Route D3 Airplane Model 7 Kms Flown Daily[Team] = Route D3 Airplane Model 7 Actual Trips * Market D Roundtrip Distance


## Route Pricing ##

V Route D3 Price Economy Number Of Teams[Team] = IF(Route D3 Online = 1 & Price Structure = 1, 1, 0)
V Route D3 Price Normal Number Of Teams[Team] = IF(Route D3 Online = 1 & Price Structure = 2, 1, 0)
V Route D3 Price Luxury Number Of Teams[Team] = IF(Route D3 Online = 1 & Price Structure = 3, 1, 0)

V Route D3 Price Sensitivity Economy = 1.001
V Route D3 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route D3 Price Economy Number Of Teams)) / Price Economy) ^ Route D3 Price Sensitivity Economy)
V Route D3 Price Market Share Economy[Team] = (Route D3 Price Attractiveness Economy / ARRAYSUM(Route D3 Price Attractiveness Economy))

V Route D3 Middling of Price[Team] = IF(Route D3 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route D3 Price Normal Number Of Teams)) - 0.12)), 0)
V Route D3 Price Sensitivity Normal = 1.5
V Route D3 Price Attractiveness Normal[Team] = (ARRAYAVG(Route D3 Middling of Price) / Route D3 Middling of Price) ^ Route D3 Price Sensitivity Normal
V Route D3 Price Market Share Normal[Team] = (Route D3 Price Attractiveness Normal / ARRAYSUM(Route D3 Price Attractiveness Normal))

V Route D3 Price Sensitivity Luxury = 1.001
V Route D3 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route D3 Price Luxury Number Of Teams))) ^ Route D3 Price Sensitivity Luxury)
V Route D3 Price Market Share Luxury[Team] = (Route D3 Price Attractiveness Luxury / ARRAYSUM(Route D3 Price Attractiveness Luxury))

V Route D3 Price Overall Market Share[Team] = IF(Price Structure = 1, Route D3 Price Market Share Economy, IF(Price Structure = 2, Route D3 Price Market Share Normal, Route D3 Price Market Share Luxury))

## Route Expenses3 ##

V Route D3 Opening Expense[Team] = IF(PREVIOUS(Route D3 Online = 0) & Route D3 Online = 1, Route Const Opening New Route Expense, 0) 

V Route D3 Fuel Expenses Airplane Model 1[Team] = Route D3 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route D3 Fuel Expenses Airplane Model 2[Team] = Route D3 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route D3 Fuel Expenses Airplane Model 3[Team] = Route D3 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route D3 Fuel Expenses Airplane Model 4[Team] = Route D3 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route D3 Fuel Expenses Airplane Model 5[Team] = Route D3 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route D3 Fuel Expenses Airplane Model 6[Team] = Route D3 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route D3 Fuel Expenses Airplane Model 7[Team] = Route D3 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route D3 Total Fuel Expenses[Team] = Route D3 Fuel Expenses Airplane Model 1 + Route D3 Fuel Expenses Airplane Model 2 + Route D3 Fuel Expenses Airplane Model 3 + Route D3 Fuel Expenses Airplane Model 4 + Route D3 Fuel Expenses Airplane Model 5 + Route D3 Fuel Expenses Airplane Model 6 + Route D3 Fuel Expenses Airplane Model 7 


### Route D4 ###

V Route D4 Roundtrip Distance Planned[Team] = Market D Roundtrip Distance * Route D4 Return Trips

## Route D4 Establishment ########
V Route D4 Demand For Teams[3] = {Market D Demand[1] + ((SQRT(Market D Demand[1] / 10 * Route D4 Num Of Teams[1])) * 10), Market D Demand[2] + ((SQRT(Market D Demand[2] / 10 * Route D4 Num Of Teams[2])) * 10), Market D Demand[3] + ((SQRT(Market D Demand[3] / 10 * Route D4 Num Of Teams[3])) * 10)}
D Route D4 Online[Team] = 0
P Route D4 Online.ExecuteDecisionImmediately = true

#V Route D4 Opening Expense[Team] = IF(PREVIOUS(Route D4 Online = 0) & Route D4 Online = 1, Route Const Opening New Route Expense, 0) 

V Route D4 Online Economy[Team] = IF(Route D4 Online = 1 & Price Structure = 1, 1, 0)
V Route D4 Online Normal[Team] = IF(Route D4 Online = 1 & Price Structure = 2, 1, 0)
V Route D4 Online Luxury[Team] = IF(Route D4 Online = 1 & Price Structure = 3, 1, 0)

V Route D4 First Quarter Online[Team] = REMEMBER((Route D4 Online = 1) & (PREVIOUS(Route D4 Online) = 0), STEP)
V Route D4 Number Of Quarters Online[Team] = IF(Route D4 Online = 1, STEP - Route D4 First Quarter Online + 1, 0)
V Route D4 Num Of Teams[3] = {ARRAYSUM(Route D4 Online Economy), ARRAYSUM(Route D4 Online Normal), ARRAYSUM(Route D4 Online Luxury)}

V Route D4 Attractiveness[Team] = IF(Route D4 Number Of Quarters Online = 1, 1, SQRT(Route D4 Number Of Quarters Online) + Route D4 Number Of Quarters Online)

V Route D4 Attractiveness Economy[Team] = IF(Route D4 Online = 1 & Price Structure = 1, Route D4 Attractiveness, 0)
V Route D4 Attractiveness Normal[Team] = IF(Route D4 Online = 1 & Price Structure = 2, Route D4 Attractiveness, 0)
V Route D4 Attractiveness Luxury[Team] = IF(Route D4 Online = 1 & Price Structure = 3, Route D4 Attractiveness, 0)

V Route D4 Market Share[Team] = (Route D4 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route D4 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route D4 Attractiveness Normal), ARRAYSUM(Route D4 Attractiveness Luxury))))
V Route D4 Total Market Share[Team] = IF(Route D4 Online = 0, 0, (0.5 * Route D4 Market Share ) + (0.2 * Route D4 Return Trips Market Share) + (0.3 * Route D4 Price Overall Market Share))
V Route D4 Market Share For Customers[Team] = Route D4 Total Market Share * (IF(Price Structure = 1, Route D4 Demand For Teams[1], IF(Price Structure = 2, Route D4 Demand For Teams[2], Route D4 Demand For Teams[3])))

V Route D4 Sales[Team] = Route D4 Total Market Share * (IF(Price Structure = 1, Route D4 Demand For Teams[1], IF(Price Structure = 2, Route D4 Demand For Teams[2], Route D4 Demand For Teams[3])))

V Route D4 Final Sales[Team] = IF(Route D4 Sales > Route D4 Seat Supply, Route D4 Seat Supply, Route D4 Sales)

V Route D4 Revenue Passenger Kms[Team] = Route D4 Final Sales * Market D Roundtrip Distance

# Route Trips
D Route D4 Return Trips[Team] = 0
P Route D4 Return Trips.ExecuteDecisionImmediately = true
V Route D4 Return Trips Previ[Team] = PREVIOUS(Route D4 Return Trips, 0)
V Route D4 Return Trips Sensitivity = 1.5

V Route D4 Average Number Of Trips = IF(ARRAYSUM(Route D4 Online) = 0, 0, ARRAYSUM(Route D4 Return Trips) / ARRAYSUM(Route D4 Online))
V Route D4 Average Number Of Trips Previ = PREVIOUS(Route D4 Average Number Of Trips, 0)

V Route D4 Return Trips Economy[Team] = IF(Route D4 Online = 1 & Price Structure = 1, Route D4 Return Trips, 0)
V Route D4 Return Trips Normal[Team] = IF(Route D4 Online = 1 & Price Structure = 2, Route D4 Return Trips, 0)
V Route D4 Return Trips Luxury[Team] = IF(Route D4 Online = 1 & Price Structure = 3, Route D4 Return Trips, 0)

V Route D4 Return Trips Attractiveness[Team] = (Route D4 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route D4 Return Trips Economy) / Route D4 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route D4 Return Trips Normal) / Route D4 Num Of Teams[2], ARRAYSUM(Route D4 Return Trips Luxury) / Route D4 Num Of Teams[3]))) ^ Route D4 Return Trips Sensitivity

V Route D4 Return Trips Attractiveness Economy[Team] = IF(Route D4 Online = 1 & Price Structure = 1, Route D4 Return Trips Attractiveness, 0)
V Route D4 Return Trips Attractiveness Normal[Team] = IF(Route D4 Online = 1 & Price Structure = 2, Route D4 Return Trips Attractiveness, 0)
V Route D4 Return Trips Attractiveness Luxury[Team] = IF(Route D4 Online = 1 & Price Structure = 3, Route D4 Return Trips Attractiveness, 0)

V Route D4 Return Trips Market Share[Team] = (Route D4 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route D4 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route D4 Return Trips Attractiveness Normal), ARRAYSUM(Route D4 Return Trips Attractiveness Luxury))))

V Route D4 Seat Supply[Team] = Route D4 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route D4 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route D4 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route D4 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route D4 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route D4 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route D4 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route D4 Available Seat Kms[Team] = Route D4 Seat Supply * Market D Roundtrip Distance

# Route Trips By Plane #

V Route D4 Total Airplane Kms Planned[Team] = Route D4 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route D4 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route D4 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route D4 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route D4 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route D4 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route D4 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route D4 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route D4 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route D4 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route D4 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route D4 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route D4 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route D4 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route D4 Airplane Model 7 Trips)
V Z Route D4 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route D4 Return Trips - Route D4 Total Plane Trips Scheduled

D Route D4 Airplane Model 1 Trips[Team] = 0
P Route D4 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route D4 Airplane Model 1 Proposed Trips[Team] = IF(Route D4 Online = 0, 0, Route D4 Airplane Model 1 Trips)
V Route D4 Airplane Model 1 Actual Trips[Team] = IF(Route D4 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route D4 Airplane Model 1 Trips))
V Route D4 Airplane Model 1 Kms Flown Daily[Team] = Route D4 Airplane Model 1 Actual Trips * Market D Roundtrip Distance

D Route D4 Airplane Model 2 Trips[Team] = 0
P Route D4 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route D4 Airplane Model 2 Proposed Trips[Team] = IF(Route D4 Online = 0, 0, Route D4 Airplane Model 2 Trips)
V Route D4 Airplane Model 2 Actual Trips[Team] = IF(Route D4 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route D4 Airplane Model 2 Trips))
V Route D4 Airplane Model 2 Kms Flown Daily[Team] = Route D4 Airplane Model 2 Actual Trips * Market D Roundtrip Distance

D Route D4 Airplane Model 3 Trips[Team] = 0
P Route D4 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route D4 Airplane Model 3 Proposed Trips[Team] = IF(Route D4 Online = 0, 0, Route D4 Airplane Model 3 Trips)
V Route D4 Airplane Model 3 Actual Trips[Team] = IF(Route D4 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route D4 Airplane Model 3 Trips))
V Route D4 Airplane Model 3 Kms Flown Daily[Team] = Route D4 Airplane Model 3 Actual Trips * Market D Roundtrip Distance

D Route D4 Airplane Model 4 Trips[Team] = 0
P Route D4 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route D4 Airplane Model 4 Proposed Trips[Team] = IF(Route D4 Online = 0, 0, Route D4 Airplane Model 4 Trips)
V Route D4 Airplane Model 4 Actual Trips[Team] = IF(Route D4 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route D4 Airplane Model 4 Trips))
V Route D4 Airplane Model 4 Kms Flown Daily[Team] = Route D4 Airplane Model 4 Actual Trips * Market D Roundtrip Distance

D Route D4 Airplane Model 5 Trips[Team] = 0
P Route D4 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route D4 Airplane Model 5 Proposed Trips[Team] = IF(Route D4 Online = 0, 0, Route D4 Airplane Model 5 Trips)
V Route D4 Airplane Model 5 Actual Trips[Team] = IF(Route D4 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route D4 Airplane Model 5 Trips))
V Route D4 Airplane Model 5 Kms Flown Daily[Team] = Route D4 Airplane Model 5 Actual Trips * Market D Roundtrip Distance

D Route D4 Airplane Model 6 Trips[Team] = 0
P Route D4 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route D4 Airplane Model 6 Proposed Trips[Team] = IF(Route D4 Online = 0, 0, Route D4 Airplane Model 6 Trips)
V Route D4 Airplane Model 6 Actual Trips[Team] = IF(Route D4 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route D4 Airplane Model 6 Trips))
V Route D4 Airplane Model 6 Kms Flown Daily[Team] = Route D4 Airplane Model 6 Actual Trips * Market D Roundtrip Distance

D Route D4 Airplane Model 7 Trips[Team] = 0
P Route D4 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route D4 Airplane Model 7 Proposed Trips[Team] = IF(Route D4 Online = 0, 0, Route D4 Airplane Model 7 Trips)
V Route D4 Airplane Model 7 Actual Trips[Team] = IF(Route D4 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route D4 Airplane Model 7 Trips))
V Route D4 Airplane Model 7 Kms Flown Daily[Team] = Route D4 Airplane Model 7 Actual Trips * Market D Roundtrip Distance


## Route Pricing ##

V Route D4 Price Economy Number Of Teams[Team] = IF(Route D4 Online = 1 & Price Structure = 1, 1, 0)
V Route D4 Price Normal Number Of Teams[Team] = IF(Route D4 Online = 1 & Price Structure = 2, 1, 0)
V Route D4 Price Luxury Number Of Teams[Team] = IF(Route D4 Online = 1 & Price Structure = 3, 1, 0)

V Route D4 Price Sensitivity Economy = 1.001
V Route D4 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route D4 Price Economy Number Of Teams)) / Price Economy) ^ Route D4 Price Sensitivity Economy)
V Route D4 Price Market Share Economy[Team] = (Route D4 Price Attractiveness Economy / ARRAYSUM(Route D4 Price Attractiveness Economy))

V Route D4 Middling of Price[Team] = IF(Route D4 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route D4 Price Normal Number Of Teams)) - 0.12)), 0)
V Route D4 Price Sensitivity Normal = 1.5
V Route D4 Price Attractiveness Normal[Team] = (ARRAYAVG(Route D4 Middling of Price) / Route D4 Middling of Price) ^ Route D4 Price Sensitivity Normal
V Route D4 Price Market Share Normal[Team] = (Route D4 Price Attractiveness Normal / ARRAYSUM(Route D4 Price Attractiveness Normal))

V Route D4 Price Sensitivity Luxury = 1.001
V Route D4 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route D4 Price Luxury Number Of Teams))) ^ Route D4 Price Sensitivity Luxury)
V Route D4 Price Market Share Luxury[Team] = (Route D4 Price Attractiveness Luxury / ARRAYSUM(Route D4 Price Attractiveness Luxury))

V Route D4 Price Overall Market Share[Team] = IF(Price Structure = 1, Route D4 Price Market Share Economy, IF(Price Structure = 2, Route D4 Price Market Share Normal, Route D4 Price Market Share Luxury))

## Route Expenses4##

V Route D4 Opening Expense[Team] = IF(PREVIOUS(Route D4 Online = 0) & Route D4 Online = 1, Route Const Opening New Route Expense, 0) 

V Route D4 Fuel Expenses Airplane Model 1[Team] = Route D4 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route D4 Fuel Expenses Airplane Model 2[Team] = Route D4 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route D4 Fuel Expenses Airplane Model 3[Team] = Route D4 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route D4 Fuel Expenses Airplane Model 4[Team] = Route D4 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route D4 Fuel Expenses Airplane Model 5[Team] = Route D4 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route D4 Fuel Expenses Airplane Model 6[Team] = Route D4 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route D4 Fuel Expenses Airplane Model 7[Team] = Route D4 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route D4 Total Fuel Expenses[Team] = Route D4 Fuel Expenses Airplane Model 1 + Route D4 Fuel Expenses Airplane Model 2 + Route D4 Fuel Expenses Airplane Model 3 + Route D4 Fuel Expenses Airplane Model 4 + Route D4 Fuel Expenses Airplane Model 5 + Route D4 Fuel Expenses Airplane Model 6 + Route D4 Fuel Expenses Airplane Model 7 


### Route D5 ###

V Route D5 Roundtrip Distance Planned[Team] = Market D Roundtrip Distance * Route D5 Return Trips

## Route D5 Establishment ########
V Route D5 Demand For Teams[3] = {Market D Demand[1] + ((SQRT(Market D Demand[1] / 10 * Route D5 Num Of Teams[1])) * 10), Market D Demand[2] + ((SQRT(Market D Demand[2] / 10 * Route D5 Num Of Teams[2])) * 10), Market D Demand[3] + ((SQRT(Market D Demand[3] / 10 * Route D5 Num Of Teams[3])) * 10)}
D Route D5 Online[Team] = 0
P Route D5 Online.ExecuteDecisionImmediately = true

#V Route D5 Opening Expense[Team] = IF(PREVIOUS(Route D5 Online = 0) & Route D5 Online = 1, Route Const Opening New Route Expense, 0) 

V Route D5 Online Economy[Team] = IF(Route D5 Online = 1 & Price Structure = 1, 1, 0)
V Route D5 Online Normal[Team] = IF(Route D5 Online = 1 & Price Structure = 2, 1, 0)
V Route D5 Online Luxury[Team] = IF(Route D5 Online = 1 & Price Structure = 3, 1, 0)

V Route D5 First Quarter Online[Team] = REMEMBER((Route D5 Online = 1) & (PREVIOUS(Route D5 Online) = 0), STEP)
V Route D5 Number Of Quarters Online[Team] = IF(Route D5 Online = 1, STEP - Route D5 First Quarter Online + 1, 0)
V Route D5 Num Of Teams[3] = {ARRAYSUM(Route D5 Online Economy), ARRAYSUM(Route D5 Online Normal), ARRAYSUM(Route D5 Online Luxury)}

V Route D5 Attractiveness[Team] = IF(Route D5 Number Of Quarters Online = 1, 1, SQRT(Route D5 Number Of Quarters Online) + Route D5 Number Of Quarters Online)

V Route D5 Attractiveness Economy[Team] = IF(Route D5 Online = 1 & Price Structure = 1, Route D5 Attractiveness, 0)
V Route D5 Attractiveness Normal[Team] = IF(Route D5 Online = 1 & Price Structure = 2, Route D5 Attractiveness, 0)
V Route D5 Attractiveness Luxury[Team] = IF(Route D5 Online = 1 & Price Structure = 3, Route D5 Attractiveness, 0)

V Route D5 Market Share[Team] = (Route D5 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route D5 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route D5 Attractiveness Normal), ARRAYSUM(Route D5 Attractiveness Luxury))))
V Route D5 Total Market Share[Team] = IF(Route D5 Online = 0, 0, (0.5 * Route D5 Market Share ) + (0.2 * Route D5 Return Trips Market Share) + (0.3 * Route D5 Price Overall Market Share))
V Route D5 Market Share For Customers[Team] = Route D5 Total Market Share * (IF(Price Structure = 1, Route D5 Demand For Teams[1], IF(Price Structure = 2, Route D5 Demand For Teams[2], Route D5 Demand For Teams[3])))

V Route D5 Sales[Team] = Route D5 Total Market Share * (IF(Price Structure = 1, Route D5 Demand For Teams[1], IF(Price Structure = 2, Route D5 Demand For Teams[2], Route D5 Demand For Teams[3])))

V Route D5 Final Sales[Team] = IF(Route D5 Sales > Route D5 Seat Supply, Route D5 Seat Supply, Route D5 Sales)

V Route D5 Revenue Passenger Kms[Team] = Route D5 Final Sales * Market D Roundtrip Distance

# Route Trips
D Route D5 Return Trips[Team] = 0
P Route D5 Return Trips.ExecuteDecisionImmediately = true
V Route D5 Return Trips Previ[Team] = PREVIOUS(Route D5 Return Trips, 0)
V Route D5 Return Trips Sensitivity = 1.5

V Route D5 Average Number Of Trips = IF(ARRAYSUM(Route D5 Online) = 0, 0, ARRAYSUM(Route D5 Return Trips) / ARRAYSUM(Route D5 Online))
V Route D5 Average Number Of Trips Previ = PREVIOUS(Route D5 Average Number Of Trips, 0)

V Route D5 Return Trips Economy[Team] = IF(Route D5 Online = 1 & Price Structure = 1, Route D5 Return Trips, 0)
V Route D5 Return Trips Normal[Team] = IF(Route D5 Online = 1 & Price Structure = 2, Route D5 Return Trips, 0)
V Route D5 Return Trips Luxury[Team] = IF(Route D5 Online = 1 & Price Structure = 3, Route D5 Return Trips, 0)

V Route D5 Return Trips Attractiveness[Team] = (Route D5 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route D5 Return Trips Economy) / Route D5 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route D5 Return Trips Normal) / Route D5 Num Of Teams[2], ARRAYSUM(Route D5 Return Trips Luxury) / Route D5 Num Of Teams[3]))) ^ Route D5 Return Trips Sensitivity

V Route D5 Return Trips Attractiveness Economy[Team] = IF(Route D5 Online = 1 & Price Structure = 1, Route D5 Return Trips Attractiveness, 0)
V Route D5 Return Trips Attractiveness Normal[Team] = IF(Route D5 Online = 1 & Price Structure = 2, Route D5 Return Trips Attractiveness, 0)
V Route D5 Return Trips Attractiveness Luxury[Team] = IF(Route D5 Online = 1 & Price Structure = 3, Route D5 Return Trips Attractiveness, 0)

V Route D5 Return Trips Market Share[Team] = (Route D5 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route D5 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route D5 Return Trips Attractiveness Normal), ARRAYSUM(Route D5 Return Trips Attractiveness Luxury))))

V Route D5 Seat Supply[Team] = Route D5 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route D5 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route D5 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route D5 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route D5 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route D5 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route D5 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route D5 Available Seat Kms[Team] = Route D5 Seat Supply * Market D Roundtrip Distance

# Route Trips By Plane #

V Route D5 Total Airplane Kms Planned[Team] = Route D5 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route D5 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route D5 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route D5 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route D5 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route D5 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route D5 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route D5 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route D5 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route D5 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route D5 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route D5 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route D5 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route D5 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route D5 Airplane Model 7 Trips)
V Z Route D5 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route D5 Return Trips - Route D5 Total Plane Trips Scheduled

D Route D5 Airplane Model 1 Trips[Team] = 0
P Route D5 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route D5 Airplane Model 1 Proposed Trips[Team] = IF(Route D5 Online = 0, 0, Route D5 Airplane Model 1 Trips)
V Route D5 Airplane Model 1 Actual Trips[Team] = IF(Route D5 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route D5 Airplane Model 1 Trips))
V Route D5 Airplane Model 1 Kms Flown Daily[Team] = Route D5 Airplane Model 1 Actual Trips * Market D Roundtrip Distance

D Route D5 Airplane Model 2 Trips[Team] = 0
P Route D5 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route D5 Airplane Model 2 Proposed Trips[Team] = IF(Route D5 Online = 0, 0, Route D5 Airplane Model 2 Trips)
V Route D5 Airplane Model 2 Actual Trips[Team] = IF(Route D5 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route D5 Airplane Model 2 Trips))
V Route D5 Airplane Model 2 Kms Flown Daily[Team] = Route D5 Airplane Model 2 Actual Trips * Market D Roundtrip Distance

D Route D5 Airplane Model 3 Trips[Team] = 0
P Route D5 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route D5 Airplane Model 3 Proposed Trips[Team] = IF(Route D5 Online = 0, 0, Route D5 Airplane Model 3 Trips)
V Route D5 Airplane Model 3 Actual Trips[Team] = IF(Route D5 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route D5 Airplane Model 3 Trips))
V Route D5 Airplane Model 3 Kms Flown Daily[Team] = Route D5 Airplane Model 3 Actual Trips * Market D Roundtrip Distance

D Route D5 Airplane Model 4 Trips[Team] = 0
P Route D5 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route D5 Airplane Model 4 Proposed Trips[Team] = IF(Route D5 Online = 0, 0, Route D5 Airplane Model 4 Trips)
V Route D5 Airplane Model 4 Actual Trips[Team] = IF(Route D5 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route D5 Airplane Model 4 Trips))
V Route D5 Airplane Model 4 Kms Flown Daily[Team] = Route D5 Airplane Model 4 Actual Trips * Market D Roundtrip Distance

D Route D5 Airplane Model 5 Trips[Team] = 0
P Route D5 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route D5 Airplane Model 5 Proposed Trips[Team] = IF(Route D5 Online = 0, 0, Route D5 Airplane Model 5 Trips)
V Route D5 Airplane Model 5 Actual Trips[Team] = IF(Route D5 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route D5 Airplane Model 5 Trips))
V Route D5 Airplane Model 5 Kms Flown Daily[Team] = Route D5 Airplane Model 5 Actual Trips * Market D Roundtrip Distance

D Route D5 Airplane Model 6 Trips[Team] = 0
P Route D5 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route D5 Airplane Model 6 Proposed Trips[Team] = IF(Route D5 Online = 0, 0, Route D5 Airplane Model 6 Trips)
V Route D5 Airplane Model 6 Actual Trips[Team] = IF(Route D5 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route D5 Airplane Model 6 Trips))
V Route D5 Airplane Model 6 Kms Flown Daily[Team] = Route D5 Airplane Model 6 Actual Trips * Market D Roundtrip Distance

D Route D5 Airplane Model 7 Trips[Team] = 0
P Route D5 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route D5 Airplane Model 7 Proposed Trips[Team] = IF(Route D5 Online = 0, 0, Route D5 Airplane Model 7 Trips)
V Route D5 Airplane Model 7 Actual Trips[Team] = IF(Route D5 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route D5 Airplane Model 7 Trips))
V Route D5 Airplane Model 7 Kms Flown Daily[Team] = Route D5 Airplane Model 7 Actual Trips * Market D Roundtrip Distance


## Route Pricing ##

V Route D5 Price Economy Number Of Teams[Team] = IF(Route D5 Online = 1 & Price Structure = 1, 1, 0)
V Route D5 Price Normal Number Of Teams[Team] = IF(Route D5 Online = 1 & Price Structure = 2, 1, 0)
V Route D5 Price Luxury Number Of Teams[Team] = IF(Route D5 Online = 1 & Price Structure = 3, 1, 0)

V Route D5 Price Sensitivity Economy = 1.001
V Route D5 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route D5 Price Economy Number Of Teams)) / Price Economy) ^ Route D5 Price Sensitivity Economy)
V Route D5 Price Market Share Economy[Team] = (Route D5 Price Attractiveness Economy / ARRAYSUM(Route D5 Price Attractiveness Economy))

V Route D5 Middling of Price[Team] = IF(Route D5 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route D5 Price Normal Number Of Teams)) - 0.12)), 0)
V Route D5 Price Sensitivity Normal = 1.5
V Route D5 Price Attractiveness Normal[Team] = (ARRAYAVG(Route D5 Middling of Price) / Route D5 Middling of Price) ^ Route D5 Price Sensitivity Normal
V Route D5 Price Market Share Normal[Team] = (Route D5 Price Attractiveness Normal / ARRAYSUM(Route D5 Price Attractiveness Normal))

V Route D5 Price Sensitivity Luxury = 1.001
V Route D5 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route D5 Price Luxury Number Of Teams))) ^ Route D5 Price Sensitivity Luxury)
V Route D5 Price Market Share Luxury[Team] = (Route D5 Price Attractiveness Luxury / ARRAYSUM(Route D5 Price Attractiveness Luxury))

V Route D5 Price Overall Market Share[Team] = IF(Price Structure = 1, Route D5 Price Market Share Economy, IF(Price Structure = 2, Route D5 Price Market Share Normal, Route D5 Price Market Share Luxury))

## Route Expenses5##

V Route D5 Opening Expense[Team] = IF(PREVIOUS(Route D5 Online = 0) & Route D5 Online = 1, Route Const Opening New Route Expense, 0) 

V Route D5 Fuel Expenses Airplane Model 1[Team] = Route D5 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route D5 Fuel Expenses Airplane Model 2[Team] = Route D5 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route D5 Fuel Expenses Airplane Model 3[Team] = Route D5 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route D5 Fuel Expenses Airplane Model 4[Team] = Route D5 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route D5 Fuel Expenses Airplane Model 5[Team] = Route D5 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route D5 Fuel Expenses Airplane Model 6[Team] = Route D5 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route D5 Fuel Expenses Airplane Model 7[Team] = Route D5 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route D5 Total Fuel Expenses[Team] = Route D5 Fuel Expenses Airplane Model 1 + Route D5 Fuel Expenses Airplane Model 2 + Route D5 Fuel Expenses Airplane Model 3 + Route D5 Fuel Expenses Airplane Model 4 + Route D5 Fuel Expenses Airplane Model 5 + Route D5 Fuel Expenses Airplane Model 6 + Route D5 Fuel Expenses Airplane Model 7 


##### MARKET E #####

V Market E Roundtrip Distance = 4355
V Market E Demand[3] = {PREVIOUS(Market E Demand[1] * 1.02, 575), PREVIOUS(Market E Demand[2] * 1.02, 1300), PREVIOUS(Market E Demand[3] * 1.02, 400)}

V Market E Total Available Seat Kms Airplane Model 1[Team] = Route E1 Airplane Model 1 Kms Flown Daily + Route E2 Airplane Model 1 Kms Flown Daily + Route E3 Airplane Model 1 Kms Flown Daily + Route E4 Airplane Model 1 Kms Flown Daily + Route E5 Airplane Model 1 Kms Flown Daily
V Market E Total Actual Seat Kms Airplane Model 1[Team] = Market E Total Available Seat Kms Airplane Model 1 * X Reliability Variable
V Market E Total Available Seat Kms Airplane Model 2[Team] = Route E1 Airplane Model 2 Kms Flown Daily + Route E2 Airplane Model 2 Kms Flown Daily + Route E3 Airplane Model 2 Kms Flown Daily + Route E4 Airplane Model 2 Kms Flown Daily + Route E5 Airplane Model 2 Kms Flown Daily
V Market E Total Actual Seat Kms Airplane Model 2[Team] = Market E Total Available Seat Kms Airplane Model 2 * X Reliability Variable
V Market E Total Available Seat Kms Airplane Model 3[Team] = Route E1 Airplane Model 3 Kms Flown Daily + Route E2 Airplane Model 3 Kms Flown Daily + Route E3 Airplane Model 3 Kms Flown Daily + Route E4 Airplane Model 3 Kms Flown Daily + Route E5 Airplane Model 3 Kms Flown Daily
V Market E Total Actual Seat Kms Airplane Model 3[Team] = Market E Total Available Seat Kms Airplane Model 3 * X Reliability Variable
V Market E Total Available Seat Kms Airplane Model 4[Team] = Route E1 Airplane Model 4 Kms Flown Daily + Route E2 Airplane Model 4 Kms Flown Daily + Route E3 Airplane Model 4 Kms Flown Daily + Route E4 Airplane Model 4 Kms Flown Daily + Route E5 Airplane Model 4 Kms Flown Daily
V Market E Total Actual Seat Kms Airplane Model 4[Team] = Market E Total Available Seat Kms Airplane Model 4 * X Reliability Variable
V Market E Total Available Seat Kms Airplane Model 5[Team] = Route E1 Airplane Model 5 Kms Flown Daily + Route E2 Airplane Model 5 Kms Flown Daily + Route E3 Airplane Model 5 Kms Flown Daily + Route E4 Airplane Model 5 Kms Flown Daily + Route E5 Airplane Model 5 Kms Flown Daily
V Market E Total Actual Seat Kms Airplane Model 5[Team] = Market E Total Available Seat Kms Airplane Model 5 * X Reliability Variable
V Market E Total Available Seat Kms Airplane Model 6[Team] = Route E1 Airplane Model 6 Kms Flown Daily + Route E2 Airplane Model 6 Kms Flown Daily + Route E3 Airplane Model 6 Kms Flown Daily + Route E4 Airplane Model 6 Kms Flown Daily + Route E5 Airplane Model 6 Kms Flown Daily
V Market E Total Actual Seat Kms Airplane Model 6[Team] = Market E Total Available Seat Kms Airplane Model 6 * X Reliability Variable
V Market E Total Available Seat Kms Airplane Model 7[Team] = Route E1 Airplane Model 7 Kms Flown Daily + Route E2 Airplane Model 7 Kms Flown Daily + Route E3 Airplane Model 7 Kms Flown Daily + Route E4 Airplane Model 7 Kms Flown Daily + Route E5 Airplane Model 7 Kms Flown Daily
V Market E Total Actual Seat Kms Airplane Model 7[Team] = Market E Total Available Seat Kms Airplane Model 7 * X Reliability Variable

V Market E Opening Expenses[Team] = Route E1 Opening Expense + Route E2 Opening Expense + Route E3 Opening Expense + Route E4 Opening Expense + Route E5 Opening Expense
V Market E Fuel Expenses[Team] = Route E1 Total Fuel Expenses + Route E2 Total Fuel Expenses + Route E3 Total Fuel Expenses + Route E4 Total Fuel Expenses + Route E5 Total Fuel Expenses

V Market E Total Available Seat Kms[Team] = Route E1 Available Seat Kms + Route E2 Available Seat Kms + Route E3 Available Seat Kms + Route E4 Available Seat Kms + Route E5 Available Seat Kms

V Market E Total Revenue Passenger Kms[Team] =  Route E1 Revenue Passenger Kms + Route E2 Revenue Passenger Kms + Route E3 Revenue Passenger Kms + Route E4 Revenue Passenger Kms + Route E5 Revenue Passenger Kms

V Market E Total Planned Daily Flight Distance[Team] = Route E1 Roundtrip Distance Planned + Route E2 Roundtrip Distance Planned + Route E3 Roundtrip Distance Planned + Route E4 Roundtrip Distance Planned + Route E5 Roundtrip Distance Planned

V Market E Final Sales[Team] = (Route E1 Final Sales + Route E2 Final Sales + Route E3 Final Sales + Route E4 Final Sales + Route E5 Final Sales) * Market E Roundtrip Distance

V Airplane 1 Fleet Market E Total Trips[Team] = (Route E1 Airplane Model 1 Proposed Trips + Route E2 Airplane Model 1 Proposed Trips + Route E3 Airplane Model 1 Proposed Trips + Route E4 Airplane Model 1 Proposed Trips + Route E5 Airplane Model 1 Proposed Trips) * Market E Roundtrip Distance
V Airplane 2 Fleet Market E Total Trips[Team] = (Route E1 Airplane Model 2 Proposed Trips + Route E2 Airplane Model 2 Proposed Trips + Route E3 Airplane Model 2 Proposed Trips + Route E4 Airplane Model 2 Proposed Trips + Route E5 Airplane Model 2 Proposed Trips) * Market E Roundtrip Distance
V Airplane 3 Fleet Market E Total Trips[Team] = (Route E1 Airplane Model 3 Proposed Trips + Route E2 Airplane Model 3 Proposed Trips + Route E3 Airplane Model 3 Proposed Trips + Route E4 Airplane Model 3 Proposed Trips + Route E5 Airplane Model 3 Proposed Trips) * Market E Roundtrip Distance
V Airplane 4 Fleet Market E Total Trips[Team] = (Route E1 Airplane Model 4 Proposed Trips + Route E2 Airplane Model 4 Proposed Trips + Route E3 Airplane Model 4 Proposed Trips + Route E4 Airplane Model 4 Proposed Trips + Route E5 Airplane Model 4 Proposed Trips) * Market E Roundtrip Distance
V Airplane 5 Fleet Market E Total Trips[Team] = (Route E1 Airplane Model 5 Proposed Trips + Route E2 Airplane Model 5 Proposed Trips + Route E3 Airplane Model 5 Proposed Trips + Route E4 Airplane Model 5 Proposed Trips + Route E5 Airplane Model 5 Proposed Trips) * Market E Roundtrip Distance
V Airplane 6 Fleet Market E Total Trips[Team] = (Route E1 Airplane Model 6 Proposed Trips + Route E2 Airplane Model 6 Proposed Trips + Route E3 Airplane Model 6 Proposed Trips + Route E4 Airplane Model 6 Proposed Trips + Route E5 Airplane Model 6 Proposed Trips) * Market E Roundtrip Distance
V Airplane 7 Fleet Market E Total Trips[Team] = (Route E1 Airplane Model 7 Proposed Trips + Route E2 Airplane Model 7 Proposed Trips + Route E3 Airplane Model 7 Proposed Trips + Route E4 Airplane Model 7 Proposed Trips + Route E5 Airplane Model 7 Proposed Trips) * Market E Roundtrip Distance


### Route E1 ###

#V Route E1 Roundtrip Distance = 832

V Route E1 Roundtrip Distance Planned[Team] = Market E Roundtrip Distance * Route E1 Return Trips

## Route E1 Establishment ##

#V Route E1 Demand[3] = {PREVIOUS(Route E1 Demand[1] * 1.02, 800), PREVIOUS(Route E1 Demand[2] * 1.02, 1000), PREVIOUS(Route E1 Demand[3] * 1.02, 700)}
V Route E1 Demand For Teams[3] = {Market E Demand[1] + ((SQRT(Market E Demand[1] / 10 * Route E1 Num Of Teams[1])) * 10), Market E Demand[2] + ((SQRT(Market E Demand[2] / 10 * Route E1 Num Of Teams[2])) * 10), Market E Demand[3] + ((SQRT(Market E Demand[3] / 10 * Route E1 Num Of Teams[3])) * 10)}
D Route E1 Online[Team] = 0
P Route E1 Online.ExecuteDecisionImmediately = true

#V Route E1 Opening Expense[Team] = IF(PREVIOUS(Route E1 Online = 0) & Route E1 Online = 1, Route Const Opening New Route Expense, 0) 

V Route E1 Online Economy[Team] = IF(Route E1 Online = 1 & Price Structure = 1, 1, 0)
V Route E1 Online Normal[Team] = IF(Route E1 Online = 1 & Price Structure = 2, 1, 0)
V Route E1 Online Luxury[Team] = IF(Route E1 Online = 1 & Price Structure = 3, 1, 0)

V Route E1 First Quarter Online[Team] = REMEMBER((Route E1 Online = 1) & (PREVIOUS(Route E1 Online) = 0), STEP)
V Route E1 Number Of Quarters Online[Team] = IF(Route E1 Online = 1, STEP - Route E1 First Quarter Online + 1, 0)
V Route E1 Num Of Teams[3] = {ARRAYSUM(Route E1 Online Economy), ARRAYSUM(Route E1 Online Normal), ARRAYSUM(Route E1 Online Luxury)}

#V Route E1 Norm Quarters[Team] = 0 + IF(Route E1 Norm Online = 1, 1, (-1) * Route E1 Norm Quarters Mirror)
#V Route E1 Norm Quarters Mirror[Team] = Route E1 Norm Quarters
#P Route E1 Norm Quarters Mirror.ExecuteDecisionImmediately = false

V Route E1 Attractiveness[Team] = IF(Route E1 Number Of Quarters Online = 1, 1, SQRT(Route E1 Number Of Quarters Online) + Route E1 Number Of Quarters Online)

V Route E1 Attractiveness Economy[Team] = IF(Route E1 Online = 1 & Price Structure = 1, Route E1 Attractiveness, 0)
V Route E1 Attractiveness Normal[Team] = IF(Route E1 Online = 1 & Price Structure = 2, Route E1 Attractiveness, 0)
V Route E1 Attractiveness Luxury[Team] = IF(Route E1 Online = 1 & Price Structure = 3, Route E1 Attractiveness, 0)

V Route E1 Market Share[Team] = (Route E1 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route E1 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route E1 Attractiveness Normal), ARRAYSUM(Route E1 Attractiveness Luxury))))
V Route E1 Total Market Share[Team] = IF(Route E1 Online = 0, 0, (0.5 * Route E1 Market Share ) + (0.2 * Route E1 Return Trips Market Share) + (0.3 * Route E1 Price Overall Market Share))
V Route E1 Market Share For Customers[Team] = Route E1 Total Market Share * (IF(Price Structure = 1, Route E1 Demand For Teams[1], IF(Price Structure = 2, Route E1 Demand For Teams[2], Route E1 Demand For Teams[3])))

V Route E1 Sales[Team] = Route E1 Total Market Share * (IF(Price Structure = 1, Route E1 Demand For Teams[1], IF(Price Structure = 2, Route E1 Demand For Teams[2], Route E1 Demand For Teams[3])))

V Route E1 Final Sales[Team] = IF(Route E1 Sales > Route E1 Seat Supply, Route E1 Seat Supply, Route E1 Sales)

V Route E1 Revenue Passenger Kms[Team] = Route E1 Final Sales * Market E Roundtrip Distance

## Route Trips ##
D Route E1 Return Trips[Team] = 0
P Route E1 Return Trips.ExecuteDecisionImmediately = true
V Route E1 Return Trips Previ[Team] = PREVIOUS(Route E1 Return Trips, 0)
V Route E1 Return Trips Sensitivity = 1.5

V Route E1 Average Number Of Trips = IF(ARRAYSUM(Route E1 Online) = 0, 0, ARRAYSUM(Route E1 Return Trips) / ARRAYSUM(Route E1 Online))
V Route E1 Average Number Of Trips Previ = PREVIOUS(Route E1 Average Number Of Trips, 0)

V Route E1 Return Trips Economy[Team] = IF(Route E1 Online = 1 & Price Structure = 1, Route E1 Return Trips, 0)
V Route E1 Return Trips Normal[Team] = IF(Route E1 Online = 1 & Price Structure = 2, Route E1 Return Trips, 0)
V Route E1 Return Trips Luxury[Team] = IF(Route E1 Online = 1 & Price Structure = 3, Route E1 Return Trips, 0)

V Route E1 Return Trips Attractiveness[Team] = (Route E1 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route E1 Return Trips Economy) / Route E1 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route E1 Return Trips Normal) / Route E1 Num Of Teams[2], ARRAYSUM(Route E1 Return Trips Luxury) / Route E1 Num Of Teams[3]))) ^ Route E1 Return Trips Sensitivity

V Route E1 Return Trips Attractiveness Economy[Team] = IF(Route E1 Online = 1 & Price Structure = 1, Route E1 Return Trips Attractiveness, 0)
V Route E1 Return Trips Attractiveness Normal[Team] = IF(Route E1 Online = 1 & Price Structure = 2, Route E1 Return Trips Attractiveness, 0)
V Route E1 Return Trips Attractiveness Luxury[Team] = IF(Route E1 Online = 1 & Price Structure = 3, Route E1 Return Trips Attractiveness, 0)

V Route E1 Return Trips Market Share[Team] = (Route E1 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route E1 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route E1 Return Trips Attractiveness Normal), ARRAYSUM(Route E1 Return Trips Attractiveness Luxury))))

V Route E1 Seat Supply[Team] = Route E1 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route E1 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route E1 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route E1 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route E1 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route E1 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route E1 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route E1 Available Seat Kms[Team] = Route E1 Seat Supply * Market E Roundtrip Distance

# Route Trips By Plane #

V Route E1 Total Airplane Kms Planned[Team] = Route E1 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route E1 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route E1 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route E1 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route E1 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route E1 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route E1 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route E1 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route E1 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route E1 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route E1 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route E1 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route E1 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route E1 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route E1 Airplane Model 7 Trips)
V Z Route E1 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route E1 Return Trips - Route E1 Total Plane Trips Scheduled

D Route E1 Airplane Model 1 Trips[Team] = 0
P Route E1 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route E1 Airplane Model 1 Proposed Trips[Team] = IF(Route E1 Online = 0, 0, Route E1 Airplane Model 1 Trips)
V Route E1 Airplane Model 1 Actual Trips[Team] = IF(Route E1 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route E1 Airplane Model 1 Trips))
V Route E1 Airplane Model 1 Kms Flown Daily[Team] = Route E1 Airplane Model 1 Actual Trips * Market E Roundtrip Distance

D Route E1 Airplane Model 2 Trips[Team] = 0
P Route E1 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route E1 Airplane Model 2 Proposed Trips[Team] = IF(Route E1 Online = 0, 0, Route E1 Airplane Model 2 Trips)
V Route E1 Airplane Model 2 Actual Trips[Team] = IF(Route E1 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route E1 Airplane Model 2 Trips))
V Route E1 Airplane Model 2 Kms Flown Daily[Team] = Route E1 Airplane Model 2 Actual Trips * Market E Roundtrip Distance

D Route E1 Airplane Model 3 Trips[Team] = 0
P Route E1 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route E1 Airplane Model 3 Proposed Trips[Team] = IF(Route E1 Online = 0, 0, Route E1 Airplane Model 3 Trips)
V Route E1 Airplane Model 3 Actual Trips[Team] = IF(Route E1 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route E1 Airplane Model 3 Trips))
V Route E1 Airplane Model 3 Kms Flown Daily[Team] = Route E1 Airplane Model 3 Actual Trips * Market E Roundtrip Distance

D Route E1 Airplane Model 4 Trips[Team] = 0
P Route E1 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route E1 Airplane Model 4 Proposed Trips[Team] = IF(Route E1 Online = 0, 0, Route E1 Airplane Model 4 Trips)
V Route E1 Airplane Model 4 Actual Trips[Team] = IF(Route E1 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route E1 Airplane Model 4 Trips))
V Route E1 Airplane Model 4 Kms Flown Daily[Team] = Route E1 Airplane Model 4 Actual Trips * Market E Roundtrip Distance

D Route E1 Airplane Model 5 Trips[Team] = 0
P Route E1 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route E1 Airplane Model 5 Proposed Trips[Team] = IF(Route E1 Online = 0, 0, Route E1 Airplane Model 5 Trips)
V Route E1 Airplane Model 5 Actual Trips[Team] = IF(Route E1 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route E1 Airplane Model 5 Trips))
V Route E1 Airplane Model 5 Kms Flown Daily[Team] = Route E1 Airplane Model 5 Actual Trips * Market E Roundtrip Distance

D Route E1 Airplane Model 6 Trips[Team] = 0
P Route E1 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route E1 Airplane Model 6 Proposed Trips[Team] = IF(Route E1 Online = 0, 0, Route E1 Airplane Model 6 Trips)
V Route E1 Airplane Model 6 Actual Trips[Team] = IF(Route E1 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route E1 Airplane Model 6 Trips))
V Route E1 Airplane Model 6 Kms Flown Daily[Team] = Route E1 Airplane Model 6 Actual Trips * Market E Roundtrip Distance

D Route E1 Airplane Model 7 Trips[Team] = 0
P Route E1 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route E1 Airplane Model 7 Proposed Trips[Team] = IF(Route E1 Online = 0, 0, Route E1 Airplane Model 7 Trips)
V Route E1 Airplane Model 7 Actual Trips[Team] = IF(Route E1 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route E1 Airplane Model 7 Trips))
V Route E1 Airplane Model 7 Kms Flown Daily[Team] = Route E1 Airplane Model 7 Actual Trips * Market E Roundtrip Distance


## Route Pricing ##
V Route E1 Price Economy Number Of Teams[Team] = IF(Route E1 Online = 1 & Price Structure = 1, 1, 0)
V Route E1 Price Normal Number Of Teams[Team] = IF(Route E1 Online = 1 & Price Structure = 2, 1, 0)
V Route E1 Price Luxury Number Of Teams[Team] = IF(Route E1 Online = 1 & Price Structure = 3, 1, 0)

V Route E1 Price Sensitivity Economy = 1.001
V Route E1 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route E1 Price Economy Number Of Teams)) / Price Economy) ^ Route E1 Price Sensitivity Economy)
V Route E1 Price Market Share Economy[Team] = (Route E1 Price Attractiveness Economy / ARRAYSUM(Route E1 Price Attractiveness Economy))

V Route E1 Middling of Price[Team] = IF(Route E1 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route E1 Price Normal Number Of Teams)) - 0.12)), 0)
V Route E1 Price Sensitivity Normal = 1.5
V Route E1 Price Attractiveness Normal[Team] = (ARRAYAVG(Route E1 Middling of Price) / Route E1 Middling of Price) ^ Route E1 Price Sensitivity Normal
V Route E1 Price Market Share Normal[Team] = (Route E1 Price Attractiveness Normal / ARRAYSUM(Route E1 Price Attractiveness Normal))

V Route E1 Price Sensitivity Luxury = 1.001
V Route E1 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route E1 Price Luxury Number Of Teams))) ^ Route E1 Price Sensitivity Luxury)
V Route E1 Price Market Share Luxury[Team] = (Route E1 Price Attractiveness Luxury / ARRAYSUM(Route E1 Price Attractiveness Luxury))

V Route E1 Price Overall Market Share[Team] = IF(Price Structure = 1, Route E1 Price Market Share Economy, IF(Price Structure = 2, Route E1 Price Market Share Normal, Route E1 Price Market Share Luxury))

## Route Expenses1 ##

V Route E1 Opening Expense[Team] = IF(PREVIOUS(Route E1 Online = 0) & Route E1 Online = 1, Route Const Opening New Route Expense, 0) 

V Route E1 Fuel Expenses Airplane Model 1[Team] = Route E1 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route E1 Fuel Expenses Airplane Model 2[Team] = Route E1 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route E1 Fuel Expenses Airplane Model 3[Team] = Route E1 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route E1 Fuel Expenses Airplane Model 4[Team] = Route E1 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route E1 Fuel Expenses Airplane Model 5[Team] = Route E1 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route E1 Fuel Expenses Airplane Model 6[Team] = Route E1 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route E1 Fuel Expenses Airplane Model 7[Team] = Route E1 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route E1 Total Fuel Expenses[Team] = Route E1 Fuel Expenses Airplane Model 1 + Route E1 Fuel Expenses Airplane Model 2 + Route E1 Fuel Expenses Airplane Model 3 + Route E1 Fuel Expenses Airplane Model 4 + Route E1 Fuel Expenses Airplane Model 5 + Route E1 Fuel Expenses Airplane Model 6 + Route E1 Fuel Expenses Airplane Model 7 


### Route E2 ###

V Route E2 Roundtrip Distance Planned[Team] = Market E Roundtrip Distance * Route E2 Return Trips

## Route E2 Establishment ########
V Route E2 Demand For Teams[3] = {Market E Demand[1] + ((SQRT(Market E Demand[1] / 10 * Route E2 Num Of Teams[1])) * 10), Market E Demand[2] + ((SQRT(Market E Demand[2] / 10 * Route E2 Num Of Teams[2])) * 10), Market E Demand[3] + ((SQRT(Market E Demand[3] / 10 * Route E2 Num Of Teams[3])) * 10)}
D Route E2 Online[Team] = 0
P Route E2 Online.ExecuteDecisionImmediately = true

#V Route E2 Opening Expense[Team] = IF(PREVIOUS(Route E2 Online = 0) & Route E2 Online = 1, Route Const Opening New Route Expense, 0) 

V Route E2 Online Economy[Team] = IF(Route E2 Online = 1 & Price Structure = 1, 1, 0)
V Route E2 Online Normal[Team] = IF(Route E2 Online = 1 & Price Structure = 2, 1, 0)
V Route E2 Online Luxury[Team] = IF(Route E2 Online = 1 & Price Structure = 3, 1, 0)

V Route E2 First Quarter Online[Team] = REMEMBER((Route E2 Online = 1) & (PREVIOUS(Route E2 Online) = 0), STEP)
V Route E2 Number Of Quarters Online[Team] = IF(Route E2 Online = 1, STEP - Route E2 First Quarter Online + 1, 0)
V Route E2 Num Of Teams[3] = {ARRAYSUM(Route E2 Online Economy), ARRAYSUM(Route E2 Online Normal), ARRAYSUM(Route E2 Online Luxury)}

V Route E2 Attractiveness[Team] = IF(Route E2 Number Of Quarters Online = 1, 1, SQRT(Route E2 Number Of Quarters Online) + Route E2 Number Of Quarters Online)

V Route E2 Attractiveness Economy[Team] = IF(Route E2 Online = 1 & Price Structure = 1, Route E2 Attractiveness, 0)
V Route E2 Attractiveness Normal[Team] = IF(Route E2 Online = 1 & Price Structure = 2, Route E2 Attractiveness, 0)
V Route E2 Attractiveness Luxury[Team] = IF(Route E2 Online = 1 & Price Structure = 3, Route E2 Attractiveness, 0)

V Route E2 Market Share[Team] = (Route E2 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route E2 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route E2 Attractiveness Normal), ARRAYSUM(Route E2 Attractiveness Luxury))))
V Route E2 Total Market Share[Team] = IF(Route E2 Online = 0, 0, (0.5 * Route E2 Market Share ) + (0.2 * Route E2 Return Trips Market Share) + (0.3 * Route E2 Price Overall Market Share))
V Route E2 Market Share For Customers[Team] = Route E2 Total Market Share * (IF(Price Structure = 1, Route E2 Demand For Teams[1], IF(Price Structure = 2, Route E2 Demand For Teams[2], Route E2 Demand For Teams[3])))

V Route E2 Sales[Team] = Route E2 Total Market Share * (IF(Price Structure = 1, Route E2 Demand For Teams[1], IF(Price Structure = 2, Route E2 Demand For Teams[2], Route E2 Demand For Teams[3])))

V Route E2 Final Sales[Team] = IF(Route E2 Sales > Route E2 Seat Supply, Route E2 Seat Supply, Route E2 Sales)

V Route E2 Revenue Passenger Kms[Team] = Route E2 Final Sales * Market E Roundtrip Distance

# Route Trips
D Route E2 Return Trips[Team] = 0
P Route E2 Return Trips.ExecuteDecisionImmediately = true
V Route E2 Return Trips Previ[Team] = PREVIOUS(Route E2 Return Trips, 0)
V Route E2 Return Trips Sensitivity = 1.5

V Route E2 Average Number Of Trips = IF(ARRAYSUM(Route E2 Online) = 0, 0, ARRAYSUM(Route E2 Return Trips) / ARRAYSUM(Route E2 Online))
V Route E2 Average Number Of Trips Previ = PREVIOUS(Route E2 Average Number Of Trips, 0)

V Route E2 Return Trips Economy[Team] = IF(Route E2 Online = 1 & Price Structure = 1, Route E2 Return Trips, 0)
V Route E2 Return Trips Normal[Team] = IF(Route E2 Online = 1 & Price Structure = 2, Route E2 Return Trips, 0)
V Route E2 Return Trips Luxury[Team] = IF(Route E2 Online = 1 & Price Structure = 3, Route E2 Return Trips, 0)

V Route E2 Return Trips Attractiveness[Team] = (Route E2 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route E2 Return Trips Economy) / Route E2 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route E2 Return Trips Normal) / Route E2 Num Of Teams[2], ARRAYSUM(Route E2 Return Trips Luxury) / Route E2 Num Of Teams[3]))) ^ Route E2 Return Trips Sensitivity

V Route E2 Return Trips Attractiveness Economy[Team] = IF(Route E2 Online = 1 & Price Structure = 1, Route E2 Return Trips Attractiveness, 0)
V Route E2 Return Trips Attractiveness Normal[Team] = IF(Route E2 Online = 1 & Price Structure = 2, Route E2 Return Trips Attractiveness, 0)
V Route E2 Return Trips Attractiveness Luxury[Team] = IF(Route E2 Online = 1 & Price Structure = 3, Route E2 Return Trips Attractiveness, 0)

V Route E2 Return Trips Market Share[Team] = (Route E2 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route E2 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route E2 Return Trips Attractiveness Normal), ARRAYSUM(Route E2 Return Trips Attractiveness Luxury))))

V Route E2 Seat Supply[Team] = Route E2 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route E2 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route E2 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route E2 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route E2 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route E2 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route E2 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route E2 Available Seat Kms[Team] = Route E2 Seat Supply * Market E Roundtrip Distance

# Route Trips By Plane #

V Route E2 Total Airplane Kms Planned[Team] = Route E2 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route E2 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route E2 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route E2 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route E2 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route E2 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route E2 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route E2 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route E2 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route E2 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route E2 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route E2 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route E2 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route E2 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route E2 Airplane Model 7 Trips)
V Z Route E2 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route E2 Return Trips - Route E2 Total Plane Trips Scheduled

D Route E2 Airplane Model 1 Trips[Team] = 0
P Route E2 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route E2 Airplane Model 1 Proposed Trips[Team] = IF(Route E2 Online = 0, 0, Route E2 Airplane Model 1 Trips)
V Route E2 Airplane Model 1 Actual Trips[Team] = IF(Route E2 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route E2 Airplane Model 1 Trips))
V Route E2 Airplane Model 1 Kms Flown Daily[Team] = Route E2 Airplane Model 1 Actual Trips * Market E Roundtrip Distance

D Route E2 Airplane Model 2 Trips[Team] = 0
P Route E2 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route E2 Airplane Model 2 Proposed Trips[Team] = IF(Route E2 Online = 0, 0, Route E2 Airplane Model 2 Trips)
V Route E2 Airplane Model 2 Actual Trips[Team] = IF(Route E2 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route E2 Airplane Model 2 Trips))
V Route E2 Airplane Model 2 Kms Flown Daily[Team] = Route E2 Airplane Model 2 Actual Trips * Market E Roundtrip Distance

D Route E2 Airplane Model 3 Trips[Team] = 0
P Route E2 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route E2 Airplane Model 3 Proposed Trips[Team] = IF(Route E2 Online = 0, 0, Route E2 Airplane Model 3 Trips)
V Route E2 Airplane Model 3 Actual Trips[Team] = IF(Route E2 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route E2 Airplane Model 3 Trips))
V Route E2 Airplane Model 3 Kms Flown Daily[Team] = Route E2 Airplane Model 3 Actual Trips * Market E Roundtrip Distance

D Route E2 Airplane Model 4 Trips[Team] = 0
P Route E2 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route E2 Airplane Model 4 Proposed Trips[Team] = IF(Route E2 Online = 0, 0, Route E2 Airplane Model 4 Trips)
V Route E2 Airplane Model 4 Actual Trips[Team] = IF(Route E2 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route E2 Airplane Model 4 Trips))
V Route E2 Airplane Model 4 Kms Flown Daily[Team] = Route E2 Airplane Model 4 Actual Trips * Market E Roundtrip Distance

D Route E2 Airplane Model 5 Trips[Team] = 0
P Route E2 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route E2 Airplane Model 5 Proposed Trips[Team] = IF(Route E2 Online = 0, 0, Route E2 Airplane Model 5 Trips)
V Route E2 Airplane Model 5 Actual Trips[Team] = IF(Route E2 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route E2 Airplane Model 5 Trips))
V Route E2 Airplane Model 5 Kms Flown Daily[Team] = Route E2 Airplane Model 5 Actual Trips * Market E Roundtrip Distance

D Route E2 Airplane Model 6 Trips[Team] = 0
P Route E2 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route E2 Airplane Model 6 Proposed Trips[Team] = IF(Route E2 Online = 0, 0, Route E2 Airplane Model 6 Trips)
V Route E2 Airplane Model 6 Actual Trips[Team] = IF(Route E2 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route E2 Airplane Model 6 Trips))
V Route E2 Airplane Model 6 Kms Flown Daily[Team] = Route E2 Airplane Model 6 Actual Trips * Market E Roundtrip Distance

D Route E2 Airplane Model 7 Trips[Team] = 0
P Route E2 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route E2 Airplane Model 7 Proposed Trips[Team] = IF(Route E2 Online = 0, 0, Route E2 Airplane Model 7 Trips)
V Route E2 Airplane Model 7 Actual Trips[Team] = IF(Route E2 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route E2 Airplane Model 7 Trips))
V Route E2 Airplane Model 7 Kms Flown Daily[Team] = Route E2 Airplane Model 7 Actual Trips * Market E Roundtrip Distance


## Route Pricing ##

V Route E2 Price Economy Number Of Teams[Team] = IF(Route E2 Online = 1 & Price Structure = 1, 1, 0)
V Route E2 Price Normal Number Of Teams[Team] = IF(Route E2 Online = 1 & Price Structure = 2, 1, 0)
V Route E2 Price Luxury Number Of Teams[Team] = IF(Route E2 Online = 1 & Price Structure = 3, 1, 0)

V Route E2 Price Sensitivity Economy = 1.001
V Route E2 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route E2 Price Economy Number Of Teams)) / Price Economy) ^ Route E2 Price Sensitivity Economy)
V Route E2 Price Market Share Economy[Team] = (Route E2 Price Attractiveness Economy / ARRAYSUM(Route E2 Price Attractiveness Economy))

V Route E2 Middling of Price[Team] = IF(Route E2 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route E2 Price Normal Number Of Teams)) - 0.12)), 0)
V Route E2 Price Sensitivity Normal = 1.5
V Route E2 Price Attractiveness Normal[Team] = (ARRAYAVG(Route E2 Middling of Price) / Route E2 Middling of Price) ^ Route E2 Price Sensitivity Normal
V Route E2 Price Market Share Normal[Team] = (Route E2 Price Attractiveness Normal / ARRAYSUM(Route E2 Price Attractiveness Normal))

V Route E2 Price Sensitivity Luxury = 1.001
V Route E2 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route E2 Price Luxury Number Of Teams))) ^ Route E2 Price Sensitivity Luxury)
V Route E2 Price Market Share Luxury[Team] = (Route E2 Price Attractiveness Luxury / ARRAYSUM(Route E2 Price Attractiveness Luxury))

V Route E2 Price Overall Market Share[Team] = IF(Price Structure = 1, Route E2 Price Market Share Economy, IF(Price Structure = 2, Route E2 Price Market Share Normal, Route E2 Price Market Share Luxury))

## Route Expenses2 ##

V Route E2 Opening Expense[Team] = IF(PREVIOUS(Route E2 Online = 0) & Route E2 Online = 1, Route Const Opening New Route Expense, 0) 

V Route E2 Fuel Expenses Airplane Model 1[Team] = Route E2 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route E2 Fuel Expenses Airplane Model 2[Team] = Route E2 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route E2 Fuel Expenses Airplane Model 3[Team] = Route E2 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route E2 Fuel Expenses Airplane Model 4[Team] = Route E2 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route E2 Fuel Expenses Airplane Model 5[Team] = Route E2 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route E2 Fuel Expenses Airplane Model 6[Team] = Route E2 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route E2 Fuel Expenses Airplane Model 7[Team] = Route E2 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route E2 Total Fuel Expenses[Team] = Route E2 Fuel Expenses Airplane Model 1 + Route E2 Fuel Expenses Airplane Model 2 + Route E2 Fuel Expenses Airplane Model 3 + Route E2 Fuel Expenses Airplane Model 4 + Route E2 Fuel Expenses Airplane Model 5 + Route E2 Fuel Expenses Airplane Model 6 + Route E2 Fuel Expenses Airplane Model 7 


### Route E3 ###

V Route E3 Roundtrip Distance Planned[Team] = Market E Roundtrip Distance * Route E3 Return Trips

## Route E3 Establishment ########
V Route E3 Demand For Teams[3] = {Market E Demand[1] + ((SQRT(Market E Demand[1] / 10 * Route E3 Num Of Teams[1])) * 10), Market E Demand[2] + ((SQRT(Market E Demand[2] / 10 * Route E3 Num Of Teams[2])) * 10), Market E Demand[3] + ((SQRT(Market E Demand[3] / 10 * Route E3 Num Of Teams[3])) * 10)}
D Route E3 Online[Team] = 0
P Route E3 Online.ExecuteDecisionImmediately = true

#V Route E3 Opening Expense[Team] = IF(PREVIOUS(Route E3 Online = 0) & Route E3 Online = 1, Route Const Opening New Route Expense, 0) 

V Route E3 Online Economy[Team] = IF(Route E3 Online = 1 & Price Structure = 1, 1, 0)
V Route E3 Online Normal[Team] = IF(Route E3 Online = 1 & Price Structure = 2, 1, 0)
V Route E3 Online Luxury[Team] = IF(Route E3 Online = 1 & Price Structure = 3, 1, 0)

V Route E3 First Quarter Online[Team] = REMEMBER((Route E3 Online = 1) & (PREVIOUS(Route E3 Online) = 0), STEP)
V Route E3 Number Of Quarters Online[Team] = IF(Route E3 Online = 1, STEP - Route E3 First Quarter Online + 1, 0)
V Route E3 Num Of Teams[3] = {ARRAYSUM(Route E3 Online Economy), ARRAYSUM(Route E3 Online Normal), ARRAYSUM(Route E3 Online Luxury)}

V Route E3 Attractiveness[Team] = IF(Route E3 Number Of Quarters Online = 1, 1, SQRT(Route E3 Number Of Quarters Online) + Route E3 Number Of Quarters Online)

V Route E3 Attractiveness Economy[Team] = IF(Route E3 Online = 1 & Price Structure = 1, Route E3 Attractiveness, 0)
V Route E3 Attractiveness Normal[Team] = IF(Route E3 Online = 1 & Price Structure = 2, Route E3 Attractiveness, 0)
V Route E3 Attractiveness Luxury[Team] = IF(Route E3 Online = 1 & Price Structure = 3, Route E3 Attractiveness, 0)

V Route E3 Market Share[Team] = (Route E3 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route E3 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route E3 Attractiveness Normal), ARRAYSUM(Route E3 Attractiveness Luxury))))
V Route E3 Total Market Share[Team] = IF(Route E3 Online = 0, 0, (0.5 * Route E3 Market Share ) + (0.2 * Route E3 Return Trips Market Share) + (0.3 * Route E3 Price Overall Market Share))
V Route E3 Market Share For Customers[Team] = Route E3 Total Market Share * (IF(Price Structure = 1, Route E3 Demand For Teams[1], IF(Price Structure = 2, Route E3 Demand For Teams[2], Route E3 Demand For Teams[3])))

V Route E3 Sales[Team] = Route E3 Total Market Share * (IF(Price Structure = 1, Route E3 Demand For Teams[1], IF(Price Structure = 2, Route E3 Demand For Teams[2], Route E3 Demand For Teams[3])))

V Route E3 Final Sales[Team] = IF(Route E3 Sales > Route E3 Seat Supply, Route E3 Seat Supply, Route E3 Sales)

V Route E3 Revenue Passenger Kms[Team] = Route E3 Final Sales * Market E Roundtrip Distance

# Route Trips
D Route E3 Return Trips[Team] = 0
P Route E3 Return Trips.ExecuteDecisionImmediately = true
V Route E3 Return Trips Previ[Team] = PREVIOUS(Route E3 Return Trips, 0)
V Route E3 Return Trips Sensitivity = 1.5

V Route E3 Average Number Of Trips = IF(ARRAYSUM(Route E3 Online) = 0, 0, ARRAYSUM(Route E3 Return Trips) / ARRAYSUM(Route E3 Online))
V Route E3 Average Number Of Trips Previ = PREVIOUS(Route E3 Average Number Of Trips, 0)

V Route E3 Return Trips Economy[Team] = IF(Route E3 Online = 1 & Price Structure = 1, Route E3 Return Trips, 0)
V Route E3 Return Trips Normal[Team] = IF(Route E3 Online = 1 & Price Structure = 2, Route E3 Return Trips, 0)
V Route E3 Return Trips Luxury[Team] = IF(Route E3 Online = 1 & Price Structure = 3, Route E3 Return Trips, 0)

V Route E3 Return Trips Attractiveness[Team] = (Route E3 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route E3 Return Trips Economy) / Route E3 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route E3 Return Trips Normal) / Route E3 Num Of Teams[2], ARRAYSUM(Route E3 Return Trips Luxury) / Route E3 Num Of Teams[3]))) ^ Route E3 Return Trips Sensitivity

V Route E3 Return Trips Attractiveness Economy[Team] = IF(Route E3 Online = 1 & Price Structure = 1, Route E3 Return Trips Attractiveness, 0)
V Route E3 Return Trips Attractiveness Normal[Team] = IF(Route E3 Online = 1 & Price Structure = 2, Route E3 Return Trips Attractiveness, 0)
V Route E3 Return Trips Attractiveness Luxury[Team] = IF(Route E3 Online = 1 & Price Structure = 3, Route E3 Return Trips Attractiveness, 0)

V Route E3 Return Trips Market Share[Team] = (Route E3 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route E3 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route E3 Return Trips Attractiveness Normal), ARRAYSUM(Route E3 Return Trips Attractiveness Luxury))))

V Route E3 Seat Supply[Team] = Route E3 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route E3 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route E3 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route E3 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route E3 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route E3 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route E3 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route E3 Available Seat Kms[Team] = Route E3 Seat Supply * Market E Roundtrip Distance

# Route Trips By Plane #

V Route E3 Total Airplane Kms Planned[Team] = Route E3 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route E3 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route E3 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route E3 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route E3 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route E3 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route E3 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route E3 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route E3 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route E3 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route E3 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route E3 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route E3 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route E3 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route E3 Airplane Model 7 Trips)
V Z Route E3 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route E3 Return Trips - Route E3 Total Plane Trips Scheduled

D Route E3 Airplane Model 1 Trips[Team] = 0
P Route E3 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route E3 Airplane Model 1 Proposed Trips[Team] = IF(Route E3 Online = 0, 0, Route E3 Airplane Model 1 Trips)
V Route E3 Airplane Model 1 Actual Trips[Team] = IF(Route E3 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route E3 Airplane Model 1 Trips))
V Route E3 Airplane Model 1 Kms Flown Daily[Team] = Route E3 Airplane Model 1 Actual Trips * Market E Roundtrip Distance

D Route E3 Airplane Model 2 Trips[Team] = 0
P Route E3 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route E3 Airplane Model 2 Proposed Trips[Team] = IF(Route E3 Online = 0, 0, Route E3 Airplane Model 2 Trips)
V Route E3 Airplane Model 2 Actual Trips[Team] = IF(Route E3 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route E3 Airplane Model 2 Trips))
V Route E3 Airplane Model 2 Kms Flown Daily[Team] = Route E3 Airplane Model 2 Actual Trips * Market E Roundtrip Distance

D Route E3 Airplane Model 3 Trips[Team] = 0
P Route E3 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route E3 Airplane Model 3 Proposed Trips[Team] = IF(Route E3 Online = 0, 0, Route E3 Airplane Model 3 Trips)
V Route E3 Airplane Model 3 Actual Trips[Team] = IF(Route E3 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route E3 Airplane Model 3 Trips))
V Route E3 Airplane Model 3 Kms Flown Daily[Team] = Route E3 Airplane Model 3 Actual Trips * Market E Roundtrip Distance

D Route E3 Airplane Model 4 Trips[Team] = 0
P Route E3 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route E3 Airplane Model 4 Proposed Trips[Team] = IF(Route E3 Online = 0, 0, Route E3 Airplane Model 4 Trips)
V Route E3 Airplane Model 4 Actual Trips[Team] = IF(Route E3 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route E3 Airplane Model 4 Trips))
V Route E3 Airplane Model 4 Kms Flown Daily[Team] = Route E3 Airplane Model 4 Actual Trips * Market E Roundtrip Distance

D Route E3 Airplane Model 5 Trips[Team] = 0
P Route E3 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route E3 Airplane Model 5 Proposed Trips[Team] = IF(Route E3 Online = 0, 0, Route E3 Airplane Model 5 Trips)
V Route E3 Airplane Model 5 Actual Trips[Team] = IF(Route E3 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route E3 Airplane Model 5 Trips))
V Route E3 Airplane Model 5 Kms Flown Daily[Team] = Route E3 Airplane Model 5 Actual Trips * Market E Roundtrip Distance

D Route E3 Airplane Model 6 Trips[Team] = 0
P Route E3 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route E3 Airplane Model 6 Proposed Trips[Team] = IF(Route E3 Online = 0, 0, Route E3 Airplane Model 6 Trips)
V Route E3 Airplane Model 6 Actual Trips[Team] = IF(Route E3 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route E3 Airplane Model 6 Trips))
V Route E3 Airplane Model 6 Kms Flown Daily[Team] = Route E3 Airplane Model 6 Actual Trips * Market E Roundtrip Distance

D Route E3 Airplane Model 7 Trips[Team] = 0
P Route E3 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route E3 Airplane Model 7 Proposed Trips[Team] = IF(Route E3 Online = 0, 0, Route E3 Airplane Model 7 Trips)
V Route E3 Airplane Model 7 Actual Trips[Team] = IF(Route E3 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route E3 Airplane Model 7 Trips))
V Route E3 Airplane Model 7 Kms Flown Daily[Team] = Route E3 Airplane Model 7 Actual Trips * Market E Roundtrip Distance


## Route Pricing ##

V Route E3 Price Economy Number Of Teams[Team] = IF(Route E3 Online = 1 & Price Structure = 1, 1, 0)
V Route E3 Price Normal Number Of Teams[Team] = IF(Route E3 Online = 1 & Price Structure = 2, 1, 0)
V Route E3 Price Luxury Number Of Teams[Team] = IF(Route E3 Online = 1 & Price Structure = 3, 1, 0)

V Route E3 Price Sensitivity Economy = 1.001
V Route E3 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route E3 Price Economy Number Of Teams)) / Price Economy) ^ Route E3 Price Sensitivity Economy)
V Route E3 Price Market Share Economy[Team] = (Route E3 Price Attractiveness Economy / ARRAYSUM(Route E3 Price Attractiveness Economy))

V Route E3 Middling of Price[Team] = IF(Route E3 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route E3 Price Normal Number Of Teams)) - 0.12)), 0)
V Route E3 Price Sensitivity Normal = 1.5
V Route E3 Price Attractiveness Normal[Team] = (ARRAYAVG(Route E3 Middling of Price) / Route E3 Middling of Price) ^ Route E3 Price Sensitivity Normal
V Route E3 Price Market Share Normal[Team] = (Route E3 Price Attractiveness Normal / ARRAYSUM(Route E3 Price Attractiveness Normal))

V Route E3 Price Sensitivity Luxury = 1.001
V Route E3 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route E3 Price Luxury Number Of Teams))) ^ Route E3 Price Sensitivity Luxury)
V Route E3 Price Market Share Luxury[Team] = (Route E3 Price Attractiveness Luxury / ARRAYSUM(Route E3 Price Attractiveness Luxury))

V Route E3 Price Overall Market Share[Team] = IF(Price Structure = 1, Route E3 Price Market Share Economy, IF(Price Structure = 2, Route E3 Price Market Share Normal, Route E3 Price Market Share Luxury))

## Route Expenses3 ##

V Route E3 Opening Expense[Team] = IF(PREVIOUS(Route E3 Online = 0) & Route E3 Online = 1, Route Const Opening New Route Expense, 0) 

V Route E3 Fuel Expenses Airplane Model 1[Team] = Route E3 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route E3 Fuel Expenses Airplane Model 2[Team] = Route E3 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route E3 Fuel Expenses Airplane Model 3[Team] = Route E3 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route E3 Fuel Expenses Airplane Model 4[Team] = Route E3 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route E3 Fuel Expenses Airplane Model 5[Team] = Route E3 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route E3 Fuel Expenses Airplane Model 6[Team] = Route E3 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route E3 Fuel Expenses Airplane Model 7[Team] = Route E3 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route E3 Total Fuel Expenses[Team] = Route E3 Fuel Expenses Airplane Model 1 + Route E3 Fuel Expenses Airplane Model 2 + Route E3 Fuel Expenses Airplane Model 3 + Route E3 Fuel Expenses Airplane Model 4 + Route E3 Fuel Expenses Airplane Model 5 + Route E3 Fuel Expenses Airplane Model 6 + Route E3 Fuel Expenses Airplane Model 7 


### Route E4 ###

V Route E4 Roundtrip Distance Planned[Team] = Market E Roundtrip Distance * Route E4 Return Trips

## Route E4 Establishment ########
V Route E4 Demand For Teams[3] = {Market E Demand[1] + ((SQRT(Market E Demand[1] / 10 * Route E4 Num Of Teams[1])) * 10), Market E Demand[2] + ((SQRT(Market E Demand[2] / 10 * Route E4 Num Of Teams[2])) * 10), Market E Demand[3] + ((SQRT(Market E Demand[3] / 10 * Route E4 Num Of Teams[3])) * 10)}
D Route E4 Online[Team] = 0
P Route E4 Online.ExecuteDecisionImmediately = true

#V Route E4 Opening Expense[Team] = IF(PREVIOUS(Route E4 Online = 0) & Route E4 Online = 1, Route Const Opening New Route Expense, 0) 

V Route E4 Online Economy[Team] = IF(Route E4 Online = 1 & Price Structure = 1, 1, 0)
V Route E4 Online Normal[Team] = IF(Route E4 Online = 1 & Price Structure = 2, 1, 0)
V Route E4 Online Luxury[Team] = IF(Route E4 Online = 1 & Price Structure = 3, 1, 0)

V Route E4 First Quarter Online[Team] = REMEMBER((Route E4 Online = 1) & (PREVIOUS(Route E4 Online) = 0), STEP)
V Route E4 Number Of Quarters Online[Team] = IF(Route E4 Online = 1, STEP - Route E4 First Quarter Online + 1, 0)
V Route E4 Num Of Teams[3] = {ARRAYSUM(Route E4 Online Economy), ARRAYSUM(Route E4 Online Normal), ARRAYSUM(Route E4 Online Luxury)}

V Route E4 Attractiveness[Team] = IF(Route E4 Number Of Quarters Online = 1, 1, SQRT(Route E4 Number Of Quarters Online) + Route E4 Number Of Quarters Online)

V Route E4 Attractiveness Economy[Team] = IF(Route E4 Online = 1 & Price Structure = 1, Route E4 Attractiveness, 0)
V Route E4 Attractiveness Normal[Team] = IF(Route E4 Online = 1 & Price Structure = 2, Route E4 Attractiveness, 0)
V Route E4 Attractiveness Luxury[Team] = IF(Route E4 Online = 1 & Price Structure = 3, Route E4 Attractiveness, 0)

V Route E4 Market Share[Team] = (Route E4 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route E4 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route E4 Attractiveness Normal), ARRAYSUM(Route E4 Attractiveness Luxury))))
V Route E4 Total Market Share[Team] = IF(Route E4 Online = 0, 0, (0.5 * Route E4 Market Share ) + (0.2 * Route E4 Return Trips Market Share) + (0.3 * Route E4 Price Overall Market Share))
V Route E4 Market Share For Customers[Team] = Route E4 Total Market Share * (IF(Price Structure = 1, Route E4 Demand For Teams[1], IF(Price Structure = 2, Route E4 Demand For Teams[2], Route E4 Demand For Teams[3])))

V Route E4 Sales[Team] = Route E4 Total Market Share * (IF(Price Structure = 1, Route E4 Demand For Teams[1], IF(Price Structure = 2, Route E4 Demand For Teams[2], Route E4 Demand For Teams[3])))

V Route E4 Final Sales[Team] = IF(Route E4 Sales > Route E4 Seat Supply, Route E4 Seat Supply, Route E4 Sales)

V Route E4 Revenue Passenger Kms[Team] = Route E4 Final Sales * Market E Roundtrip Distance

# Route Trips
D Route E4 Return Trips[Team] = 0
P Route E4 Return Trips.ExecuteDecisionImmediately = true
V Route E4 Return Trips Previ[Team] = PREVIOUS(Route E4 Return Trips, 0)
V Route E4 Return Trips Sensitivity = 1.5

V Route E4 Average Number Of Trips = IF(ARRAYSUM(Route E4 Online) = 0, 0, ARRAYSUM(Route E4 Return Trips) / ARRAYSUM(Route E4 Online))
V Route E4 Average Number Of Trips Previ = PREVIOUS(Route E4 Average Number Of Trips, 0)

V Route E4 Return Trips Economy[Team] = IF(Route E4 Online = 1 & Price Structure = 1, Route E4 Return Trips, 0)
V Route E4 Return Trips Normal[Team] = IF(Route E4 Online = 1 & Price Structure = 2, Route E4 Return Trips, 0)
V Route E4 Return Trips Luxury[Team] = IF(Route E4 Online = 1 & Price Structure = 3, Route E4 Return Trips, 0)

V Route E4 Return Trips Attractiveness[Team] = (Route E4 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route E4 Return Trips Economy) / Route E4 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route E4 Return Trips Normal) / Route E4 Num Of Teams[2], ARRAYSUM(Route E4 Return Trips Luxury) / Route E4 Num Of Teams[3]))) ^ Route E4 Return Trips Sensitivity

V Route E4 Return Trips Attractiveness Economy[Team] = IF(Route E4 Online = 1 & Price Structure = 1, Route E4 Return Trips Attractiveness, 0)
V Route E4 Return Trips Attractiveness Normal[Team] = IF(Route E4 Online = 1 & Price Structure = 2, Route E4 Return Trips Attractiveness, 0)
V Route E4 Return Trips Attractiveness Luxury[Team] = IF(Route E4 Online = 1 & Price Structure = 3, Route E4 Return Trips Attractiveness, 0)

V Route E4 Return Trips Market Share[Team] = (Route E4 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route E4 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route E4 Return Trips Attractiveness Normal), ARRAYSUM(Route E4 Return Trips Attractiveness Luxury))))

V Route E4 Seat Supply[Team] = Route E4 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route E4 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route E4 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route E4 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route E4 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route E4 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route E4 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route E4 Available Seat Kms[Team] = Route E4 Seat Supply * Market E Roundtrip Distance

# Route Trips By Plane #

V Route E4 Total Airplane Kms Planned[Team] = Route E4 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route E4 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route E4 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route E4 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route E4 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route E4 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route E4 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route E4 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route E4 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route E4 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route E4 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route E4 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route E4 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route E4 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route E4 Airplane Model 7 Trips)
V Z Route E4 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route E4 Return Trips - Route E4 Total Plane Trips Scheduled

D Route E4 Airplane Model 1 Trips[Team] = 0
P Route E4 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route E4 Airplane Model 1 Proposed Trips[Team] = IF(Route E4 Online = 0, 0, Route E4 Airplane Model 1 Trips)
V Route E4 Airplane Model 1 Actual Trips[Team] = IF(Route E4 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route E4 Airplane Model 1 Trips))
V Route E4 Airplane Model 1 Kms Flown Daily[Team] = Route E4 Airplane Model 1 Actual Trips * Market E Roundtrip Distance

D Route E4 Airplane Model 2 Trips[Team] = 0
P Route E4 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route E4 Airplane Model 2 Proposed Trips[Team] = IF(Route E4 Online = 0, 0, Route E4 Airplane Model 2 Trips)
V Route E4 Airplane Model 2 Actual Trips[Team] = IF(Route E4 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route E4 Airplane Model 2 Trips))
V Route E4 Airplane Model 2 Kms Flown Daily[Team] = Route E4 Airplane Model 2 Actual Trips * Market E Roundtrip Distance

D Route E4 Airplane Model 3 Trips[Team] = 0
P Route E4 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route E4 Airplane Model 3 Proposed Trips[Team] = IF(Route E4 Online = 0, 0, Route E4 Airplane Model 3 Trips)
V Route E4 Airplane Model 3 Actual Trips[Team] = IF(Route E4 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route E4 Airplane Model 3 Trips))
V Route E4 Airplane Model 3 Kms Flown Daily[Team] = Route E4 Airplane Model 3 Actual Trips * Market E Roundtrip Distance

D Route E4 Airplane Model 4 Trips[Team] = 0
P Route E4 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route E4 Airplane Model 4 Proposed Trips[Team] = IF(Route E4 Online = 0, 0, Route E4 Airplane Model 4 Trips)
V Route E4 Airplane Model 4 Actual Trips[Team] = IF(Route E4 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route E4 Airplane Model 4 Trips))
V Route E4 Airplane Model 4 Kms Flown Daily[Team] = Route E4 Airplane Model 4 Actual Trips * Market E Roundtrip Distance

D Route E4 Airplane Model 5 Trips[Team] = 0
P Route E4 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route E4 Airplane Model 5 Proposed Trips[Team] = IF(Route E4 Online = 0, 0, Route E4 Airplane Model 5 Trips)
V Route E4 Airplane Model 5 Actual Trips[Team] = IF(Route E4 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route E4 Airplane Model 5 Trips))
V Route E4 Airplane Model 5 Kms Flown Daily[Team] = Route E4 Airplane Model 5 Actual Trips * Market E Roundtrip Distance

D Route E4 Airplane Model 6 Trips[Team] = 0
P Route E4 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route E4 Airplane Model 6 Proposed Trips[Team] = IF(Route E4 Online = 0, 0, Route E4 Airplane Model 6 Trips)
V Route E4 Airplane Model 6 Actual Trips[Team] = IF(Route E4 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route E4 Airplane Model 6 Trips))
V Route E4 Airplane Model 6 Kms Flown Daily[Team] = Route E4 Airplane Model 6 Actual Trips * Market E Roundtrip Distance

D Route E4 Airplane Model 7 Trips[Team] = 0
P Route E4 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route E4 Airplane Model 7 Proposed Trips[Team] = IF(Route E4 Online = 0, 0, Route E4 Airplane Model 7 Trips)
V Route E4 Airplane Model 7 Actual Trips[Team] = IF(Route E4 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route E4 Airplane Model 7 Trips))
V Route E4 Airplane Model 7 Kms Flown Daily[Team] = Route E4 Airplane Model 7 Actual Trips * Market E Roundtrip Distance


## Route Pricing ##

V Route E4 Price Economy Number Of Teams[Team] = IF(Route E4 Online = 1 & Price Structure = 1, 1, 0)
V Route E4 Price Normal Number Of Teams[Team] = IF(Route E4 Online = 1 & Price Structure = 2, 1, 0)
V Route E4 Price Luxury Number Of Teams[Team] = IF(Route E4 Online = 1 & Price Structure = 3, 1, 0)

V Route E4 Price Sensitivity Economy = 1.001
V Route E4 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route E4 Price Economy Number Of Teams)) / Price Economy) ^ Route E4 Price Sensitivity Economy)
V Route E4 Price Market Share Economy[Team] = (Route E4 Price Attractiveness Economy / ARRAYSUM(Route E4 Price Attractiveness Economy))

V Route E4 Middling of Price[Team] = IF(Route E4 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route E4 Price Normal Number Of Teams)) - 0.12)), 0)
V Route E4 Price Sensitivity Normal = 1.5
V Route E4 Price Attractiveness Normal[Team] = (ARRAYAVG(Route E4 Middling of Price) / Route E4 Middling of Price) ^ Route E4 Price Sensitivity Normal
V Route E4 Price Market Share Normal[Team] = (Route E4 Price Attractiveness Normal / ARRAYSUM(Route E4 Price Attractiveness Normal))

V Route E4 Price Sensitivity Luxury = 1.001
V Route E4 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route E4 Price Luxury Number Of Teams))) ^ Route E4 Price Sensitivity Luxury)
V Route E4 Price Market Share Luxury[Team] = (Route E4 Price Attractiveness Luxury / ARRAYSUM(Route E4 Price Attractiveness Luxury))

V Route E4 Price Overall Market Share[Team] = IF(Price Structure = 1, Route E4 Price Market Share Economy, IF(Price Structure = 2, Route E4 Price Market Share Normal, Route E4 Price Market Share Luxury))

## Route Expenses4##

V Route E4 Opening Expense[Team] = IF(PREVIOUS(Route E4 Online = 0) & Route E4 Online = 1, Route Const Opening New Route Expense, 0) 

V Route E4 Fuel Expenses Airplane Model 1[Team] = Route E4 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route E4 Fuel Expenses Airplane Model 2[Team] = Route E4 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route E4 Fuel Expenses Airplane Model 3[Team] = Route E4 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route E4 Fuel Expenses Airplane Model 4[Team] = Route E4 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route E4 Fuel Expenses Airplane Model 5[Team] = Route E4 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route E4 Fuel Expenses Airplane Model 6[Team] = Route E4 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route E4 Fuel Expenses Airplane Model 7[Team] = Route E4 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route E4 Total Fuel Expenses[Team] = Route E4 Fuel Expenses Airplane Model 1 + Route E4 Fuel Expenses Airplane Model 2 + Route E4 Fuel Expenses Airplane Model 3 + Route E4 Fuel Expenses Airplane Model 4 + Route E4 Fuel Expenses Airplane Model 5 + Route E4 Fuel Expenses Airplane Model 6 + Route E4 Fuel Expenses Airplane Model 7 


### Route E5 ###

V Route E5 Roundtrip Distance Planned[Team] = Market E Roundtrip Distance * Route E5 Return Trips

## Route E5 Establishment ########
V Route E5 Demand For Teams[3] = {Market E Demand[1] + ((SQRT(Market E Demand[1] / 10 * Route E5 Num Of Teams[1])) * 10), Market E Demand[2] + ((SQRT(Market E Demand[2] / 10 * Route E5 Num Of Teams[2])) * 10), Market E Demand[3] + ((SQRT(Market E Demand[3] / 10 * Route E5 Num Of Teams[3])) * 10)}
D Route E5 Online[Team] = 0
P Route E5 Online.ExecuteDecisionImmediately = true

#V Route E5 Opening Expense[Team] = IF(PREVIOUS(Route E5 Online = 0) & Route E5 Online = 1, Route Const Opening New Route Expense, 0) 

V Route E5 Online Economy[Team] = IF(Route E5 Online = 1 & Price Structure = 1, 1, 0)
V Route E5 Online Normal[Team] = IF(Route E5 Online = 1 & Price Structure = 2, 1, 0)
V Route E5 Online Luxury[Team] = IF(Route E5 Online = 1 & Price Structure = 3, 1, 0)

V Route E5 First Quarter Online[Team] = REMEMBER((Route E5 Online = 1) & (PREVIOUS(Route E5 Online) = 0), STEP)
V Route E5 Number Of Quarters Online[Team] = IF(Route E5 Online = 1, STEP - Route E5 First Quarter Online + 1, 0)
V Route E5 Num Of Teams[3] = {ARRAYSUM(Route E5 Online Economy), ARRAYSUM(Route E5 Online Normal), ARRAYSUM(Route E5 Online Luxury)}

V Route E5 Attractiveness[Team] = IF(Route E5 Number Of Quarters Online = 1, 1, SQRT(Route E5 Number Of Quarters Online) + Route E5 Number Of Quarters Online)

V Route E5 Attractiveness Economy[Team] = IF(Route E5 Online = 1 & Price Structure = 1, Route E5 Attractiveness, 0)
V Route E5 Attractiveness Normal[Team] = IF(Route E5 Online = 1 & Price Structure = 2, Route E5 Attractiveness, 0)
V Route E5 Attractiveness Luxury[Team] = IF(Route E5 Online = 1 & Price Structure = 3, Route E5 Attractiveness, 0)

V Route E5 Market Share[Team] = (Route E5 Attractiveness / IF(Price Structure = 1, ARRAYSUM(Route E5 Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route E5 Attractiveness Normal), ARRAYSUM(Route E5 Attractiveness Luxury))))
V Route E5 Total Market Share[Team] = IF(Route E5 Online = 0, 0, (0.5 * Route E5 Market Share ) + (0.2 * Route E5 Return Trips Market Share) + (0.3 * Route E5 Price Overall Market Share))
V Route E5 Market Share For Customers[Team] = Route E5 Total Market Share * (IF(Price Structure = 1, Route E5 Demand For Teams[1], IF(Price Structure = 2, Route E5 Demand For Teams[2], Route E5 Demand For Teams[3])))

V Route E5 Sales[Team] = Route E5 Total Market Share * (IF(Price Structure = 1, Route E5 Demand For Teams[1], IF(Price Structure = 2, Route E5 Demand For Teams[2], Route E5 Demand For Teams[3])))

V Route E5 Final Sales[Team] = IF(Route E5 Sales > Route E5 Seat Supply, Route E5 Seat Supply, Route E5 Sales)

V Route E5 Revenue Passenger Kms[Team] = Route E5 Final Sales * Market E Roundtrip Distance

# Route Trips
D Route E5 Return Trips[Team] = 0
P Route E5 Return Trips.ExecuteDecisionImmediately = true
V Route E5 Return Trips Previ[Team] = PREVIOUS(Route E5 Return Trips, 0)
V Route E5 Return Trips Sensitivity = 1.5

V Route E5 Average Number Of Trips = IF(ARRAYSUM(Route E5 Online) = 0, 0, ARRAYSUM(Route E5 Return Trips) / ARRAYSUM(Route E5 Online))
V Route E5 Average Number Of Trips Previ = PREVIOUS(Route E5 Average Number Of Trips, 0)

V Route E5 Return Trips Economy[Team] = IF(Route E5 Online = 1 & Price Structure = 1, Route E5 Return Trips, 0)
V Route E5 Return Trips Normal[Team] = IF(Route E5 Online = 1 & Price Structure = 2, Route E5 Return Trips, 0)
V Route E5 Return Trips Luxury[Team] = IF(Route E5 Online = 1 & Price Structure = 3, Route E5 Return Trips, 0)

V Route E5 Return Trips Attractiveness[Team] = (Route E5 Return Trips / IF(Price Structure = 1, ARRAYSUM(Route E5 Return Trips Economy) / Route E5 Num Of Teams[1], IF(Price Structure = 2, ARRAYSUM(Route E5 Return Trips Normal) / Route E5 Num Of Teams[2], ARRAYSUM(Route E5 Return Trips Luxury) / Route E5 Num Of Teams[3]))) ^ Route E5 Return Trips Sensitivity

V Route E5 Return Trips Attractiveness Economy[Team] = IF(Route E5 Online = 1 & Price Structure = 1, Route E5 Return Trips Attractiveness, 0)
V Route E5 Return Trips Attractiveness Normal[Team] = IF(Route E5 Online = 1 & Price Structure = 2, Route E5 Return Trips Attractiveness, 0)
V Route E5 Return Trips Attractiveness Luxury[Team] = IF(Route E5 Online = 1 & Price Structure = 3, Route E5 Return Trips Attractiveness, 0)

V Route E5 Return Trips Market Share[Team] = (Route E5 Return Trips Attractiveness /  IF(Price Structure = 1, ARRAYSUM(Route E5 Return Trips Attractiveness Economy), IF(Price Structure = 2, ARRAYSUM(Route E5 Return Trips Attractiveness Normal), ARRAYSUM(Route E5 Return Trips Attractiveness Luxury))))

V Route E5 Seat Supply[Team] = Route E5 Airplane Model 1 Actual Trips * Airplane Model 1 Seats + Route E5 Airplane Model 2 Actual Trips * Airplane Model 2 Seats + Route E5 Airplane Model 3 Actual Trips * Airplane Model 3 Seats + Route E5 Airplane Model 4 Actual Trips * Airplane Model 4 Seats + Route E5 Airplane Model 5 Actual Trips * Airplane Model 5 Seats + Route E5 Airplane Model 6 Actual Trips * Airplane Model 6 Seats + Route E5 Airplane Model 7 Actual Trips * Airplane Model 7 Seats

V Route E5 Available Seat Kms[Team] = Route E5 Seat Supply * Market E Roundtrip Distance

# Route Trips By Plane #

V Route E5 Total Airplane Kms Planned[Team] = Route E5 Airplane Model 1 Trips * Airplane Model 1 Maximum Daily Kms + Route E5 Airplane Model 2 Trips * Airplane Model 2 Maximum Daily Kms + Route E5 Airplane Model 3 Trips * Airplane Model 3 Maximum Daily Kms + Route E5 Airplane Model 4 Trips * Airplane Model 4 Maximum Daily Kms + Route E5 Airplane Model 5 Trips * Airplane Model 5 Maximum Daily Kms + Route E5 Airplane Model 6 Trips * Airplane Model 6 Maximum Daily Kms + Route E5 Airplane Model 7 Trips * Airplane Model 7 Maximum Daily Kms

V Route E5 Total Plane Trips Scheduled[Team] = IF(Airplane Model 1 Owned A Leased Planes = 0, 0, Route E5 Airplane Model 1 Trips) + IF(Airplane Model 2 Owned A Leased Planes = 0, 0, Route E5 Airplane Model 2 Trips) + IF(Airplane Model 3 Owned A Leased Planes = 0, 0, Route E5 Airplane Model 3 Trips) + IF(Airplane Model 4 Owned A Leased Planes = 0, 0, Route E5 Airplane Model 4 Trips) + IF(Airplane Model 5 Owned A Leased Planes = 0, 0, Route E5 Airplane Model 5 Trips) + IF(Airplane Model 6 Owned A Leased Planes = 0, 0, Route E5 Airplane Model 6 Trips) + IF(Airplane Model 7 Owned A Leased Planes = 0, 0, Route E5 Airplane Model 7 Trips)
V Z Route E5 Diff BW Planned Trips A Scheduled Plane Trips[Team] = Route E5 Return Trips - Route E5 Total Plane Trips Scheduled

D Route E5 Airplane Model 1 Trips[Team] = 0
P Route E5 Airplane Model 1 Trips.ExecuteDecisionImmediately = true
V Route E5 Airplane Model 1 Proposed Trips[Team] = IF(Route E5 Online = 0, 0, Route E5 Airplane Model 1 Trips)
V Route E5 Airplane Model 1 Actual Trips[Team] = IF(Route E5 Online = 0, 0, IF(Airplane 1 Warning = 1, 0, Route E5 Airplane Model 1 Trips))
V Route E5 Airplane Model 1 Kms Flown Daily[Team] = Route E5 Airplane Model 1 Actual Trips * Market E Roundtrip Distance

D Route E5 Airplane Model 2 Trips[Team] = 0
P Route E5 Airplane Model 2 Trips.ExecuteDecisionImmediately = true
V Route E5 Airplane Model 2 Proposed Trips[Team] = IF(Route E5 Online = 0, 0, Route E5 Airplane Model 2 Trips)
V Route E5 Airplane Model 2 Actual Trips[Team] = IF(Route E5 Online = 0, 0, IF(Airplane 2 Warning = 1, 0, Route E5 Airplane Model 2 Trips))
V Route E5 Airplane Model 2 Kms Flown Daily[Team] = Route E5 Airplane Model 2 Actual Trips * Market E Roundtrip Distance

D Route E5 Airplane Model 3 Trips[Team] = 0
P Route E5 Airplane Model 3 Trips.ExecuteDecisionImmediately = true
V Route E5 Airplane Model 3 Proposed Trips[Team] = IF(Route E5 Online = 0, 0, Route E5 Airplane Model 3 Trips)
V Route E5 Airplane Model 3 Actual Trips[Team] = IF(Route E5 Online = 0, 0, IF(Airplane 3 Warning = 1, 0, Route E5 Airplane Model 3 Trips))
V Route E5 Airplane Model 3 Kms Flown Daily[Team] = Route E5 Airplane Model 3 Actual Trips * Market E Roundtrip Distance

D Route E5 Airplane Model 4 Trips[Team] = 0
P Route E5 Airplane Model 4 Trips.ExecuteDecisionImmediately = true
V Route E5 Airplane Model 4 Proposed Trips[Team] = IF(Route E5 Online = 0, 0, Route E5 Airplane Model 4 Trips)
V Route E5 Airplane Model 4 Actual Trips[Team] = IF(Route E5 Online = 0, 0, IF(Airplane 4 Warning = 1, 0, Route E5 Airplane Model 4 Trips))
V Route E5 Airplane Model 4 Kms Flown Daily[Team] = Route E5 Airplane Model 4 Actual Trips * Market E Roundtrip Distance

D Route E5 Airplane Model 5 Trips[Team] = 0
P Route E5 Airplane Model 5 Trips.ExecuteDecisionImmediately = true
V Route E5 Airplane Model 5 Proposed Trips[Team] = IF(Route E5 Online = 0, 0, Route E5 Airplane Model 5 Trips)
V Route E5 Airplane Model 5 Actual Trips[Team] = IF(Route E5 Online = 0, 0, IF(Airplane 5 Warning = 1, 0, Route E5 Airplane Model 5 Trips))
V Route E5 Airplane Model 5 Kms Flown Daily[Team] = Route E5 Airplane Model 5 Actual Trips * Market E Roundtrip Distance

D Route E5 Airplane Model 6 Trips[Team] = 0
P Route E5 Airplane Model 6 Trips.ExecuteDecisionImmediately = true
V Route E5 Airplane Model 6 Proposed Trips[Team] = IF(Route E5 Online = 0, 0, Route E5 Airplane Model 6 Trips)
V Route E5 Airplane Model 6 Actual Trips[Team] = IF(Route E5 Online = 0, 0, IF(Airplane 6 Warning = 1, 0, Route E5 Airplane Model 6 Trips))
V Route E5 Airplane Model 6 Kms Flown Daily[Team] = Route E5 Airplane Model 6 Actual Trips * Market E Roundtrip Distance

D Route E5 Airplane Model 7 Trips[Team] = 0
P Route E5 Airplane Model 7 Trips.ExecuteDecisionImmediately = true
V Route E5 Airplane Model 7 Proposed Trips[Team] = IF(Route E5 Online = 0, 0, Route E5 Airplane Model 7 Trips)
V Route E5 Airplane Model 7 Actual Trips[Team] = IF(Route E5 Online = 0, 0, IF(Airplane 7 Warning = 1, 0, Route E5 Airplane Model 7 Trips))
V Route E5 Airplane Model 7 Kms Flown Daily[Team] = Route E5 Airplane Model 7 Actual Trips * Market E Roundtrip Distance


## Route Pricing ##

V Route E5 Price Economy Number Of Teams[Team] = IF(Route E5 Online = 1 & Price Structure = 1, 1, 0)
V Route E5 Price Normal Number Of Teams[Team] = IF(Route E5 Online = 1 & Price Structure = 2, 1, 0)
V Route E5 Price Luxury Number Of Teams[Team] = IF(Route E5 Online = 1 & Price Structure = 3, 1, 0)

V Route E5 Price Sensitivity Economy = 1.001
V Route E5 Price Attractiveness Economy[Team] = SQRT(((ARRAYSUM(Price Economy) / ARRAYSUM(Route E5 Price Economy Number Of Teams)) / Price Economy) ^ Route E5 Price Sensitivity Economy)
V Route E5 Price Market Share Economy[Team] = (Route E5 Price Attractiveness Economy / ARRAYSUM(Route E5 Price Attractiveness Economy))

V Route E5 Middling of Price[Team] = IF(Route E5 Online = 1 & Price Structure = 2, ABS(Price Normal - ((ARRAYSUM(Price Normal) / ARRAYSUM(Route E5 Price Normal Number Of Teams)) - 0.12)), 0)
V Route E5 Price Sensitivity Normal = 1.5
V Route E5 Price Attractiveness Normal[Team] = (ARRAYAVG(Route E5 Middling of Price) / Route E5 Middling of Price) ^ Route E5 Price Sensitivity Normal
V Route E5 Price Market Share Normal[Team] = (Route E5 Price Attractiveness Normal / ARRAYSUM(Route E5 Price Attractiveness Normal))

V Route E5 Price Sensitivity Luxury = 1.001
V Route E5 Price Attractiveness Luxury[Team] = SQRT((Price Luxury / (ARRAYSUM(Price Luxury) / ARRAYSUM(Route E5 Price Luxury Number Of Teams))) ^ Route E5 Price Sensitivity Luxury)
V Route E5 Price Market Share Luxury[Team] = (Route E5 Price Attractiveness Luxury / ARRAYSUM(Route E5 Price Attractiveness Luxury))

V Route E5 Price Overall Market Share[Team] = IF(Price Structure = 1, Route E5 Price Market Share Economy, IF(Price Structure = 2, Route E5 Price Market Share Normal, Route E5 Price Market Share Luxury))

## Route Expenses5##

V Route E5 Opening Expense[Team] = IF(PREVIOUS(Route E5 Online = 0) & Route E5 Online = 1, Route Const Opening New Route Expense, 0) 

V Route E5 Fuel Expenses Airplane Model 1[Team] = Route E5 Airplane Model 1 Kms Flown Daily * Airplane Model 1 Seats * Airplane Model 1 Fuel Cost Per Seat Km
V Route E5 Fuel Expenses Airplane Model 2[Team] = Route E5 Airplane Model 2 Kms Flown Daily * Airplane Model 2 Seats * Airplane Model 2 Fuel Cost Per Seat Km
V Route E5 Fuel Expenses Airplane Model 3[Team] = Route E5 Airplane Model 3 Kms Flown Daily * Airplane Model 3 Seats * Airplane Model 3 Fuel Cost Per Seat Km
V Route E5 Fuel Expenses Airplane Model 4[Team] = Route E5 Airplane Model 4 Kms Flown Daily * Airplane Model 4 Seats * Airplane Model 4 Fuel Cost Per Seat Km
V Route E5 Fuel Expenses Airplane Model 5[Team] = Route E5 Airplane Model 5 Kms Flown Daily * Airplane Model 5 Seats * Airplane Model 5 Fuel Cost Per Seat Km
V Route E5 Fuel Expenses Airplane Model 6[Team] = Route E5 Airplane Model 6 Kms Flown Daily * Airplane Model 6 Seats * Airplane Model 6 Fuel Cost Per Seat Km
V Route E5 Fuel Expenses Airplane Model 7[Team] = Route E5 Airplane Model 7 Kms Flown Daily * Airplane Model 7 Seats * Airplane Model 7 Fuel Cost Per Seat Km

V Route E5 Total Fuel Expenses[Team] = Route E5 Fuel Expenses Airplane Model 1 + Route E5 Fuel Expenses Airplane Model 2 + Route E5 Fuel Expenses Airplane Model 3 + Route E5 Fuel Expenses Airplane Model 4 + Route E5 Fuel Expenses Airplane Model 5 + Route E5 Fuel Expenses Airplane Model 6 + Route E5 Fuel Expenses Airplane Model 7 



### Route A1 Establishment
#V Route A1 Norm Demand = PREVIOUS(Route A1 Norm Demand * 1.02, 1000)
#V Route A1 Norm Demand For Teams = Route A1 Norm Demand + ((SQRT(Route A1 Norm Demand / 10 * Route A1 Norm Num Of Teams)) * 10)
#D Route A1 Norm Online[Team] = 0
#P Route A1 Norm Online.ExecuteDecisionImmediately = true
#V Route A1 Norm First Quarter Online[Team] = REMEMBER((Route A1 Norm Online = 1) & (PREVIOUS(Route A1 Norm Online) = 0), STEP)
#V Route A1 Norm Number Of Quarters Online[Team] = IF(Route A1 Norm Online = 1, STEP - Route A1 Norm First Quarter Online + 1, 0)
#V Route A1 Norm Num Of Teams = ARRAYSUM(Route A1 Norm Online)

#V Route A1 Norm Quarters[Team] = 0 + IF(Route A1 Norm Online = 1, 1, (-1) * Route A1 Norm Quarters Mirror)
#V Route A1 Norm Quarters Mirror[Team] = Route A1 Norm Quarters
#P Route A1 Norm Quarters Mirror.ExecuteDecisionImmediately = false

#V Route A1 Norm Attractiveness[Team] = IF(Route A1 Norm Number Of Quarters Online = 1, 1, SQRT(Route A1 Norm Number Of Quarters Online) + Route A1 Norm Number Of Quarters Online)
#V Route A1 Norm Market Share[Team] = (Route A1 Norm Attractiveness / ARRAYSUM(Route A1 Norm Attractiveness))
#V Route A1 Norm Total Market Share[Team] = IF(Route A1 Norm Online = 0, 0, (0.5 * Route A1 Norm Market Share ) + (0.2 * Route A1 Return Trips Market Share) + (0.3 * Price Market Share))
#V Route A1 Norm Market Share For Customers[Team] = Route A1 Norm Total Market Share * Route A1 Norm Demand For Teams
#V Route A1 Norm Sales[Team] = Route A1 Norm Total Market Share * Route A1 Norm Demand For Teams

## Route Trips
#D Route A1 Return Trips[Team] = 0
#P Route A1 Return Trips.DecisionMax = 10
#P Route A1 Return Trips.ExecuteDecisionImmediately = true
#V Route A1 Return Trips Sensitivity = 1.5
#V Route A1 Return Trips Attractiveness[Team] = (Route A1 Return Trips / ARRAYAVG(Route A1 Return Trips)) ^ Route A1 Return Trips Sensitivity
#V Route A1 Return Trips Market Share[Team] = (Route A1 Return Trips Attractiveness / ARRAYSUM(Route A1 Return Trips Attractiveness))

## Route A2 Establishment
#V Route A2 Norm Demand = PREVIOUS(Route A2 Norm Demand * 1.02, 1000)
#V Route A2 Norm Demand For Teams = Route A2 Norm Demand + ((SQRT(Route A2 Norm Demand / 10 * Route A2 Norm Num Of Teams)) * 10)
#D Route A2 Norm Online[Team] = 0
#P Route A2 Norm Online.ExecuteDecisionImmediately = true
#V Route A2 Norm First Quarter Online[Team] = REMEMBER((Route A2 Norm Online = 1) & (PREVIOUS(Route A2 Norm Online) = 0), STEP)
#V Route A2 Norm Number Of Quarters Online[Team] = IF(Route A2 Norm Online = 1, STEP - Route A2 Norm First Quarter Online + 1, 0)
#V Route A2 Norm Num Of Teams = ARRAYSUM(Route A2 Norm Online)

#V Route A2 Norm Attractiveness[Team] = IF(Route A2 Norm Number Of Quarters Online = 1, 1, SQRT(Route A2 Norm Number Of Quarters Online) + Route A2 Norm Number Of Quarters Online)
#V Route A2 Norm Market Share[Team] = (Route A2 Norm Attractiveness / ARRAYSUM(Route A2 Norm Attractiveness))
#V Route A2 Norm Total Market Share[Team] = IF(Route A2 Norm Online = 0, 0, (0.5 * Route A2 Norm Market Share ) + (0.2 * Route A2 Return Trips Market Share) + (0.3 * Route A1 Price Overall Market Share))
#V Route A2 Norm Market Share For Customers[Team] = Route A2 Norm Total Market Share * Route A2 Norm Demand For Teams
#V Route A2 Norm Sales[Team] = Route A2 Norm Total Market Share * Route A2 Norm Demand For Teams

# Route Trips
#D Route A2 Return Trips[Team] = 0
#P Route A2 Return Trips.DecisionMax = 10
#P Route A2 Return Trips.ExecuteDecisionImmediately = true
#V Route A2 Return Trips Sensitivity = 1.5
#V Route A2 Return Trips Attractiveness[Team] = (Route A2 Return Trips / ARRAYAVG(Route A2 Return Trips)) ^ Route A2 Return Trips Sensitivity
#V Route A2 Return Trips Market Share[Team] = (Route A2 Return Trips Attractiveness / ARRAYSUM(Route A2 Return Trips Attractiveness))




####- FLEET DECISIONS -####
V Fleet 0 Sale Transaction Fee Percentage = 0.027
V Fleet Aircraft Life Expectancy = 20

V Fleet Acquisition Validation[Team] = PREVIOUS(Asset A Cash, Asset 0 Initial Cash) + Financing G Instant Cash Decisions - (Airplane Model 1 Buying Cost + Airplane Model 2 Buying Cost + Airplane Model 3 Buying Cost + Airplane Model 4 Buying Cost + Airplane Model 5 Buying Cost + Airplane Model 6 Buying Cost + Airplane Model 7 Buying Cost)
V Fleet Acquisition Actual Cost[Team] = Airplane Model 1 Actual Buying Cost + Airplane Model 2 Actual Buying Cost

V Total Airplane Daily Flight Capacity[Team] = Airplane Model 1 Available Maximum Daily Kms + Airplane Model 2 Available Maximum Daily Kms + Airplane Model 3 Available Maximum Daily Kms + Airplane Model 4 Available Maximum Daily Kms + Airplane Model 5 Available Maximum Daily Kms + Airplane Model 6 Available Maximum Daily Kms + Airplane Model 7 Available Maximum Daily Kms
V Total Airplane Daily Flight Capacity Previ[Team] = PREVIOUS(Total Airplane Daily Flight Capacity, 0)

V Total Airplanes In Possession[Team] = Airplane Model 1 Owned A Leased Planes + Airplane Model 2 Owned A Leased Planes + Airplane Model 3 Owned A Leased Planes + Airplane Model 4 Owned A Leased Planes + Airplane Model 5 Owned A Leased Planes + Airplane Model 6 Owned A Leased Planes + Airplane Model 7 Owned A Leased Planes
V Total Airplanes In Possession Previ[Team] = PREVIOUS(Total Airplanes In Possession, 0)

V Total Seats Available[Team] = Airplane Model 1 Seats Available + Airplane Model 2 Seats Available + Airplane Model 3 Seats Available + Airplane Model 4 Seats Available + Airplane Model 5 Seats Available + Airplane Model 6 Seats Available + Airplane Model 7 Seats Available
V Total Seats Available Previ[Team] = PREVIOUS(Total Seats Available, 0)

V Fleet Quarterly Depreciation Expense[Team] = Airplane Model 1 Depreciation Expense + Airplane Model 2 Depreciation Expense + Airplane Model 3 Depreciation Expense + Airplane Model 4 Depreciation Expense + Airplane Model 5 Depreciation Expense + Airplane Model 6 Depreciation Expense + Airplane Model 7 Depreciation Expense
V Fleet Total Depreciation[Team] = Airplane Model 1 Depreciation Total + Airplane Model 2 Depreciation Total + Airplane Model 3 Depreciation Total + Airplane Model 4 Depreciation Total + Airplane Model 5 Depreciation Total + Airplane Model 6 Depreciation Total + Airplane Model 7 Depreciation Total
V Fleet Proceeds From Sale Of Airplanes[Team] = Airplane Model 1 Airplanes Sold Funds From Sale + Airplane Model 2 Airplanes Sold Funds From Sale + Airplane Model 3 Airplanes Sold Funds From Sale + Airplane Model 4 Airplanes Sold Funds From Sale + Airplane Model 5 Airplanes Sold Funds From Sale + Airplane Model 6 Airplanes Sold Funds From Sale + Airplane Model 7 Airplanes Sold Funds From Sale
V Fleet Selling Expenses[Team] = Airplane Model 1 Airplanes Selling Expense + Airplane Model 2 Airplanes Selling Expense + Airplane Model 3 Airplanes Selling Expense + Airplane Model 4 Airplanes Selling Expense + Airplane Model 5 Airplanes Selling Expense + Airplane Model 6 Airplanes Selling Expense + Airplane Model 7 Airplanes Selling Expense

V Fleet Airplanes Fuel Cost Per Seat Mile Total[Team] = Airplane Model 1 Fuel Cost Per Seat Mile + Airplane Model 2 Fuel Cost Per Seat Mile + Airplane Model 3 Fuel Cost Per Seat Mile + Airplane Model 4 Fuel Cost Per Seat Mile + Airplane Model 5 Fuel Cost Per Seat Mile + Airplane Model 6 Fuel Cost Per Seat Mile + Airplane Model 7 Fuel Cost Per Seat Mile
V Fleet Airplanes Fuel Cost Per Seat Mile Average[Team] = Fleet Airplanes Fuel Cost Per Seat Mile Total / Total Airplanes In Possession

## Airplane Model 1 ##

V Airplane Model 1 Seats = 60
V Airplane Model 1 Maximum Daily Kms = 8000
V Airplane Model 1 Cruising Kms Per Hour = 425
V Airplane Model 1 Purchase Cost  = 2500000
V Airplane Model 1 Beginning Planes = 2
V Airplane Model 1 Monthly Lease Cost = Airplane Model 1 Purchase Cost / 20 / 4 
V Airplane Model 1 Fuel Cost Per Seat Km = 0.03
V Airplane Model 1 Maintenance Cost Per Seat Km = 0.0337
V Airplane Model 1 Insurance Rate Per Seat = 66
V Airplane Model 1 Insurance Cost Per Plane = Airplane Model 1 Seats * Airplane Model 1 Insurance Rate Per Seat

V Airplane Model 1 Depreciation Per Quarter = (Airplane Model 1 Purchase Cost / Fleet Aircraft Life Expectancy) / 4
V Airplane Model 1 Depreciation Expense[Team] = Airplane Model 1 Own * Airplane Model 1 Depreciation Per Quarter
V Airplane Model 1 Depreciation Total[Team] = PREVIOUS(Airplane Model 1 Depreciation Total, 0) + Airplane Model 1 Depreciation Expense - Airplane Model 1 Airplanes Sold Depreciation Removed

V Airplane Model 1 Available Maximum Daily Kms[Team] = Airplane Model 1 Own * Airplane Model 1 Maximum Daily Kms + Airplane Model 1 Leased * Airplane Model 1 Maximum Daily Kms

V Airplane Model 1 Owned A Leased Planes[Team] = Airplane Model 1 Own + Airplane Model 1 Leased
V Airplane Model 1 Available Daily Kms[Team] = Airplane Model 1 Owned A Leased Planes * Airplane Model 1 Maximum Daily Kms
V Airplane Model 1 Seats Available[Team] = Airplane Model 1 Owned A Leased Planes * Airplane Model 1 Seats
V Airplane Model 1 Fuel Cost Per Seat Mile[Team] = Airplane Model 1 Owned A Leased Planes * Airplane Model 1 Fuel Cost Per Seat Km

D Airplane Model 1 Buying[Team] = 0
P Airplane Model 1 Buying.ExecuteDecisionImmediately = true
P Airplane Model 1 Buying.SaveResult = true
P Airplane Model 1 Buying.ResetDecision = true
P Airplane Model 1 Buying.DecisionMin = 0
P Airplane Model 1 Buying.DecisionMax = 5
V Airplane Model 1 Buying Cost[Team] = Airplane Model 1 Buying * Airplane Model 1 Purchase Cost
V Airplane Model 1 Actual Buying[Team] = IF(Fleet Acquisition Validation < 0, 0, Airplane Model 1 Buying)
V Airplane Model 1 Actual Buying Cost[Team] = Airplane Model 1 Actual Buying * Airplane Model 1 Purchase Cost

V Airplane Model 1 Own[Team] = PREVIOUS(Airplane Model 1 Own, Airplane Model 1 Beginning Planes) + IF(Fleet Acquisition Validation < 0, 0, Airplane Model 1 Buying) - Airplane Model 1 Actual Selling
V Airplane Model 1 Total Bought[Team] = PREVIOUS(Airplane Model 1 Total Bought, Airplane Model 1 Beginning Planes) + Airplane Model 1 Actual Buying 
V Airplane Model 1 Total Sold[Team] = PREVIOUS(Airplane Model 1 Total Sold, 0) + Airplane Model 1 Actual Selling

V Airplane Model 1 Bought Beginning[Team] = Airplane Model 1 Beginning Planes
V Airplane Model 1 Bought Quarter 0[Team] = REMEMBER(STEP = 0,Airplane Model 1 Actual Buying,0)
V Airplane Model 1 Bought Quarter 1[Team] = REMEMBER(STEP = 1,Airplane Model 1 Actual Buying,0)
V Airplane Model 1 Bought Quarter 2[Team] = REMEMBER(STEP = 2,Airplane Model 1 Actual Buying,0)
V Airplane Model 1 Bought Quarter 3[Team] = REMEMBER(STEP = 3,Airplane Model 1 Actual Buying,0)
V Airplane Model 1 Bought Quarter 4[Team] = REMEMBER(STEP = 4,Airplane Model 1 Actual Buying,0)
V Airplane Model 1 Bought Quarter 5[Team] = REMEMBER(STEP = 5,Airplane Model 1 Actual Buying,0)
V Airplane Model 1 Bought Quarter 6[Team] = REMEMBER(STEP = 6,Airplane Model 1 Actual Buying,0)
V Airplane Model 1 Bought Quarter 7[Team] = REMEMBER(STEP = 7,Airplane Model 1 Actual Buying,0)

V Airplane Model 1 Left Over Beginning[Team] = IF(Airplane Model 1 Bought Beginning >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Beginning - Airplane Model 1 Total Sold, 0)

V Airplane Model 1 Left Over Quarter 0[Team] = IF(Airplane Model 1 Bought Beginning >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Quarter 0, IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 - Airplane Model 1 Total Sold, 0))
V Airplane Model 1 Left Over Quarter 1[Team] = IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Quarter 1, IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 - Airplane Model 1 Total Sold, 0))
V Airplane Model 1 Left Over Quarter 2[Team] = IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Quarter 2, IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 - Airplane Model 1 Total Sold, 0))
V Airplane Model 1 Left Over Quarter 3[Team] = IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Quarter 3, IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3 - Airplane Model 1 Total Sold, 0))
V Airplane Model 1 Left Over Quarter 4[Team] = IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Quarter 4, IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3 + Airplane Model 1 Bought Quarter 4) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3 + Airplane Model 1 Bought Quarter 4 - Airplane Model 1 Total Sold, 0))
V Airplane Model 1 Left Over Quarter 5[Team] = IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3 + Airplane Model 1 Bought Quarter 4) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Quarter 5, IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3 + Airplane Model 1 Bought Quarter 4 + Airplane Model 1 Bought Quarter 5) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3 + Airplane Model 1 Bought Quarter 4 + Airplane Model 1 Bought Quarter 5 - Airplane Model 1 Total Sold, 0))
V Airplane Model 1 Left Over Quarter 6[Team] = IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3 + Airplane Model 1 Bought Quarter 4 + Airplane Model 1 Bought Quarter 5) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Quarter 6, IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3 + Airplane Model 1 Bought Quarter 4 + Airplane Model 1 Bought Quarter 5 + Airplane Model 1 Bought Quarter 6) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3 + Airplane Model 1 Bought Quarter 4 + Airplane Model 1 Bought Quarter 5 + Airplane Model 1 Bought Quarter 6 - Airplane Model 1 Total Sold, 0))
V Airplane Model 1 Left Over Quarter 7[Team] = IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3 + Airplane Model 1 Bought Quarter 4 + Airplane Model 1 Bought Quarter 5 + Airplane Model 1 Bought Quarter 6) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Quarter 7, IF((Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3 + Airplane Model 1 Bought Quarter 4 + Airplane Model 1 Bought Quarter 5 + Airplane Model 1 Bought Quarter 6 + Airplane Model 1 Bought Quarter 7) >= Airplane Model 1 Total Sold, Airplane Model 1 Bought Beginning + Airplane Model 1 Bought Quarter 0 + Airplane Model 1 Bought Quarter 1 + Airplane Model 1 Bought Quarter 2 + Airplane Model 1 Bought Quarter 3 + Airplane Model 1 Bought Quarter 4 + Airplane Model 1 Bought Quarter 5 + Airplane Model 1 Bought Quarter 6 + Airplane Model 1 Bought Quarter 7 - Airplane Model 1 Total Sold, 0))

V Airplane Model 1 Depreciation Rate = Airplane Model 1 Depreciation Per Quarter

V Airplane Model 1 Planes Sold From Beginning[Team] = IF((PREVIOUS(Airplane Model 1 Left Over Beginning, 0) > 0) & (PREVIOUS(Airplane Model 1 Left Over Beginning, 0) != Airplane Model 1 Left Over Beginning), PREVIOUS(Airplane Model 1 Left Over Beginning, 0) - Airplane Model 1 Left Over Beginning, 0)
V Airplane Model 1 Quarters Difference Between Bought And Sold Beginning[Team] = STEP - 0
V Airplane Model 1 Planes Sold Depreciation Removed Beginning[Team] = Airplane Model 1 Planes Sold From Beginning * Airplane Model 1 Quarters Difference Between Bought And Sold Beginning * Airplane Model 1 Depreciation Rate

V Airplane Model 1 Planes Sold From Quarter 0[Team] = IF((PREVIOUS(Airplane Model 1 Left Over Quarter 0, 0) > 0) & (PREVIOUS(Airplane Model 1 Left Over Quarter 0, 0) != Airplane Model 1 Left Over Quarter 0), PREVIOUS(Airplane Model 1 Left Over Quarter 0, 0) - Airplane Model 1 Left Over Quarter 0, 0)
V Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 0[Team] = STEP - 1
V Airplane Model 1 Planes Sold Depreciation Removed Quarter 0[Team] = Airplane Model 1 Planes Sold From Quarter 0 * Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 0 * Airplane Model 1 Depreciation Rate

V Airplane Model 1 Planes Sold From Quarter 1[Team] = IF((PREVIOUS(Airplane Model 1 Left Over Quarter 1, 0) > 0) & (PREVIOUS(Airplane Model 1 Left Over Quarter 1, 0) != Airplane Model 1 Left Over Quarter 1), PREVIOUS(Airplane Model 1 Left Over Quarter 1, 0) - Airplane Model 1 Left Over Quarter 1, 0)
V Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 1[Team] = STEP - 2
V Airplane Model 1 Planes Sold Depreciation Removed Quarter 1[Team] = Airplane Model 1 Planes Sold From Quarter 1 * Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 1 * Airplane Model 1 Depreciation Rate

V Airplane Model 1 Planes Sold From Quarter 2[Team] = IF((PREVIOUS(Airplane Model 1 Left Over Quarter 2, 0) > 0) & (PREVIOUS(Airplane Model 1 Left Over Quarter 2, 0) != Airplane Model 1 Left Over Quarter 2), PREVIOUS(Airplane Model 1 Left Over Quarter 2, 0) - Airplane Model 1 Left Over Quarter 2, 0)
V Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 2[Team] = STEP - 3
V Airplane Model 1 Planes Sold Depreciation Removed Quarter 2[Team] = Airplane Model 1 Planes Sold From Quarter 2 * Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 2 * Airplane Model 1 Depreciation Rate

V Airplane Model 1 Planes Sold From Quarter 3[Team] = IF((PREVIOUS(Airplane Model 1 Left Over Quarter 3, 0) > 0) & (PREVIOUS(Airplane Model 1 Left Over Quarter 3, 0) != Airplane Model 1 Left Over Quarter 3), PREVIOUS(Airplane Model 1 Left Over Quarter 3, 0) - Airplane Model 1 Left Over Quarter 3, 0)
V Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 3[Team] = STEP - 4
V Airplane Model 1 Planes Sold Depreciation Removed Quarter 3[Team] = Airplane Model 1 Planes Sold From Quarter 3 * Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 3 * Airplane Model 1 Depreciation Rate

V Airplane Model 1 Planes Sold From Quarter 4[Team] = IF((PREVIOUS(Airplane Model 1 Left Over Quarter 4, 0) > 0) & (PREVIOUS(Airplane Model 1 Left Over Quarter 4, 0) != Airplane Model 1 Left Over Quarter 4), PREVIOUS(Airplane Model 1 Left Over Quarter 4, 0) - Airplane Model 1 Left Over Quarter 4, 0)
V Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 4[Team] = STEP - 5
V Airplane Model 1 Planes Sold Depreciation Removed Quarter 4[Team] = Airplane Model 1 Planes Sold From Quarter 4 * Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 4 * Airplane Model 1 Depreciation Rate

V Airplane Model 1 Planes Sold From Quarter 5[Team] = IF((PREVIOUS(Airplane Model 1 Left Over Quarter 5, 0) > 0) & (PREVIOUS(Airplane Model 1 Left Over Quarter 5, 0) != Airplane Model 1 Left Over Quarter 5), PREVIOUS(Airplane Model 1 Left Over Quarter 5, 0) - Airplane Model 1 Left Over Quarter 5, 0)
V Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 5[Team] = STEP - 6
V Airplane Model 1 Planes Sold Depreciation Removed Quarter 5[Team] = Airplane Model 1 Planes Sold From Quarter 5 * Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 5 * Airplane Model 1 Depreciation Rate

V Airplane Model 1 Planes Sold From Quarter 6[Team] = IF((PREVIOUS(Airplane Model 1 Left Over Quarter 6, 0) > 0) & (PREVIOUS(Airplane Model 1 Left Over Quarter 6, 0) != Airplane Model 1 Left Over Quarter 6), PREVIOUS(Airplane Model 1 Left Over Quarter 6, 0) - Airplane Model 1 Left Over Quarter 6, 0)
V Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 6[Team] = STEP - 7
V Airplane Model 1 Planes Sold Depreciation Removed Quarter 6[Team] = Airplane Model 1 Planes Sold From Quarter 6 * Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 6 * Airplane Model 1 Depreciation Rate

V Airplane Model 1 Planes Sold From Quarter 7[Team] = IF((PREVIOUS(Airplane Model 1 Left Over Quarter 7, 0) > 0) & (PREVIOUS(Airplane Model 1 Left Over Quarter 7, 0) != Airplane Model 1 Left Over Quarter 7), PREVIOUS(Airplane Model 1 Left Over Quarter 7, 0) - Airplane Model 1 Left Over Quarter 7, 0)
V Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 7[Team] = STEP - 8
V Airplane Model 1 Planes Sold Depreciation Removed Quarter 7[Team] = Airplane Model 1 Planes Sold From Quarter 7 * Airplane Model 1 Quarters Difference Between Bought And Sold Quarter 7 * Airplane Model 1 Depreciation Rate

V Airplane Model 1 Airplanes Sold Number[Team] = Airplane Model 1 Planes Sold From Beginning + Airplane Model 1 Planes Sold From Quarter 0 + Airplane Model 1 Planes Sold From Quarter 1 + Airplane Model 1 Planes Sold From Quarter 2 + Airplane Model 1 Planes Sold From Quarter 3 + Airplane Model 1 Planes Sold From Quarter 4 + Airplane Model 1 Planes Sold From Quarter 5 + Airplane Model 1 Planes Sold From Quarter 6 + Airplane Model 1 Planes Sold From Quarter 7
V Airplane Model 1 Airplanes Sold Cost[Team] = Airplane Model 1 Airplanes Sold Number * Airplane Model 1 Purchase Cost
V Airplane Model 1 Airplanes Sold Depreciation Removed[Team] = Airplane Model 1 Planes Sold Depreciation Removed Beginning + Airplane Model 1 Planes Sold Depreciation Removed Quarter 0 + Airplane Model 1 Planes Sold Depreciation Removed Quarter 1 + Airplane Model 1 Planes Sold Depreciation Removed Quarter 2 + Airplane Model 1 Planes Sold Depreciation Removed Quarter 3 + Airplane Model 1 Planes Sold Depreciation Removed Quarter 4 + Airplane Model 1 Planes Sold Depreciation Removed Quarter 5 + Airplane Model 1 Planes Sold Depreciation Removed Quarter 6 + Airplane Model 1 Planes Sold Depreciation Removed Quarter 7
V Airplane Model 1 Airplanes Sold Book Value[Team] = Airplane Model 1 Airplanes Sold Cost - Airplane Model 1 Airplanes Sold Depreciation Removed
V Airplane Model 1 Airplanes Sold Funds From Sale[Team] = Airplane Model 1 Airplanes Sold Book Value
V Airplane Model 1 Airplanes Selling Expense[Team] = Airplane Model 1 Airplanes Sold Book Value * Fleet 0 Sale Transaction Fee Percentage


#V Airplane Model 1 Own Depreciation[35] = {, } ALL AIRPLANES IN HERE WITH IF STATEMENTS ACCUMULATING DEPRECIATION
#V Airplane Model 1 Own Depreciation[6] = {IF((Airplane Model 1 Total Bought > 0) & (Airplane Model 1 Total Sold < 1), PREVIOUS(Airplane Model 1 Own Depreciation[1], 0) + Airplane Model 1 Depreciation Per Quarter, 0), IF((Airplane Model 1 Total Bought > 1) & (Airplane Model 1 Total Sold < 2), PREVIOUS(Airplane Model 1 Own Depreciation[1], 0) + Airplane Model 1 Depreciation Per Quarter, 0), IF((Airplane Model 1 Total Bought > 2) & (Airplane Model 1 Total Sold < 3), PREVIOUS(Airplane Model 1 Own Depreciation[1], 0) + Airplane Model 1 Depreciation Per Quarter, 0), IF((Airplane Model 1 Total Bought > 3) & (Airplane Model 1 Total Sold < 4), PREVIOUS(Airplane Model 1 Own Depreciation[1], 0) + Airplane Model 1 Depreciation Per Quarter, 0), IF((Airplane Model 1 Total Bought > 4) & (Airplane Model 1 Total Sold < 5), PREVIOUS(Airplane Model 1 Own Depreciation[1], 0) + Airplane Model 1 Depreciation Per Quarter, 0), IF((Airplane Model 1 Total Bought > 5) & (Airplane Model 1 Total Sold < 6), PREVIOUS(Airplane Model 1 Own Depreciation[1], 0) + Airplane Model 1 Depreciation Per Quarter, 0)}
#V Airplane Model 1 Own Depreciation[6] = {RAMP(Airplane Model 1 Depreciation Per Quarter, 2, 4), 2, 3, 4, 5, 6}

#V Airplane Model 1 Own Depreciation Airplane 1[Team] = IF((Airplane Model 1 Total Bought > 0) & (Airplane Model 1 Total Sold < 1), PREVIOUS(Airplane Model 1 Own Depreciation[1], 0) + Airplane Model 1 Depreciation Per Quarter, 0)

#V Airplane Model 1 Depreciation Removal[Team] = IF(Airplane Model 1 Actual Selling = 0, 0, IF(Airplane Model 1 Actual Selling = 1, Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 1], IF(Airplane Model 1 Actual Selling = 2, Airplane Model 1 Own Depreciation[Airplane Model 1 Total Sold + 1]
#V Airplane Model 1 Depreciation Removal[Team] = IF(Airplane Model 1 Actual Selling = 0, 0, IF(Airplane Model 1 Actual Selling = 1, Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 1], IF(Airplane Model 1 Actual Selling = 2, Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 1] + Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 2], IF(Airplane Model 1 Actual Selling = 3, Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 1] + Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 2] + Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 3], IF(Airplane Model 1 Actual Selling = 4, Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 1] + Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 2] + Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 3] + Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 4], Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 1] + Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 2] + Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 3] + Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 4] + Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 5])))))
#V Airplane Model 1 Depreciation Removal[Team] = Airplane Model 1 Own Depreciation[PREVIOUS(Airplane Model 1 Total Sold, 0) + 1]

D Airplane Model 1 Selling[Team] = 0
P Airplane Model 1 Selling.ExecuteDecisionImmediately = true
P Airplane Model 1 Selling.SaveResult = true
P Airplane Model 1 Selling.ResetDecision = true
P Airplane Model 1 Selling.DecisionMin = 0
P Airplane Model 1 Selling.DecisionMax = 5

V Airplane Model 1 Actual Selling[Team] = IF(Airplane Model 1 Selling = 0, 0, IF(Airplane Model 1 Selling > PREVIOUS(Airplane Model 1 Own, 2), PREVIOUS(Airplane Model 1 Own, 2), Airplane Model 1 Selling))

D Airplane Model 1 Leasing[Team] = 0
P Airplane Model 1 Leasing.ExecuteDecisionImmediately = true
P Airplane Model 1 Leasing.SaveResult = true
P Airplane Model 1 Leasing.ResetDecision = true
P Airplane Model 1 Leasing.DecisionMin = 0
P Airplane Model 1 Leasing.DecisionMax = 5

V Airplane Model 1 Leased[Team] = PREVIOUS(Airplane Model 1 Leased, 0) + Airplane Model 1 Leasing - Airplane Model 1 Actual Cancelling

D Airplane Model 1 Cancelling[Team] = 0
P Airplane Model 1 Cancelling.ExecuteDecisionImmediately = true
P Airplane Model 1 Cancelling.SaveResult = true
P Airplane Model 1 Cancelling.ResetDecision = true
P Airplane Model 1 Cancelling.DecisionMin = 0
P Airplane Model 1 Cancelling.DecisionMax = 5

V Airplane Model 1 Actual Cancelling[Team] = IF(Airplane Model 1 Cancelling = 0, 0, IF(Airplane Model 1 Cancelling > PREVIOUS(Airplane Model 1 Leased, 0), PREVIOUS(Airplane Model 1 Leased, 0), Airplane Model 1 Cancelling))

## Airplane Model 2 ##

V Airplane Model 2 Seats = 100
V Airplane Model 2 Maximum Daily Kms = 2500
V Airplane Model 2 Cruising Kms Per Hour = 425
V Airplane Model 2 Purchase Cost = 3500000
V Airplane Model 2 Monthly Lease Cost = Airplane Model 2 Purchase Cost / 20 / 4
V Airplane Model 2 Fuel Cost Per Seat Km = 0.0372
V Airplane Model 2 Maintenance Cost Per Seat Km = 0.0384
V Airplane Model 2 Insurance Rate Per Seat = 134
V Airplane Model 2 Insurance Cost Per Plane = Airplane Model 2 Seats * Airplane Model 2 Insurance Rate Per Seat

V Airplane Model 2 Depreciation Per Quarter = Airplane Model 2 Purchase Cost / Fleet Aircraft Life Expectancy
V Airplane Model 2 Depreciation Expense[Team] = Airplane Model 2 Own * Airplane Model 2 Depreciation Per Quarter
V Airplane Model 2 Depreciation Total[Team] = PREVIOUS(Airplane Model 2 Depreciation Total, 0) + Airplane Model 2 Depreciation Expense - Airplane Model 2 Airplanes Sold Depreciation Removed

V Airplane Model 2 Available Maximum Daily Kms[Team] = Airplane Model 2 Own * Airplane Model 2 Maximum Daily Kms + Airplane Model 2 Leased * Airplane Model 2 Maximum Daily Kms

V Airplane Model 2 Owned A Leased Planes[Team] = Airplane Model 2 Own + Airplane Model 2 Leased
V Airplane Model 2 Available Daily Kms[Team] = Airplane Model 2 Owned A Leased Planes * Airplane Model 2 Maximum Daily Kms
V Airplane Model 2 Seats Available[Team] = Airplane Model 2 Owned A Leased Planes * Airplane Model 2 Seats
V Airplane Model 2 Fuel Cost Per Seat Mile[Team] = Airplane Model 2 Owned A Leased Planes * Airplane Model 2 Fuel Cost Per Seat Km

D Airplane Model 2 Buying[Team] = 0
P Airplane Model 2 Buying.ExecuteDecisionImmediately = true
P Airplane Model 2 Buying.SaveResult = true
P Airplane Model 2 Buying.ResetDecision = true
P Airplane Model 2 Buying.DecisionMin = 0
P Airplane Model 2 Buying.DecisionMax = 5
V Airplane Model 2 Buying Cost[Team] = Airplane Model 2 Buying * Airplane Model 2 Purchase Cost
V Airplane Model 2 Actual Buying[Team] = IF(Fleet Acquisition Validation < 0, 0, Airplane Model 2 Buying)
V Airplane Model 2 Actual Buying Cost[Team] = Airplane Model 2 Actual Buying * Airplane Model 2 Purchase Cost

V Airplane Model 2 Own[Team] = PREVIOUS(Airplane Model 2 Own, 0) + IF(Fleet Acquisition Validation < 0, 0, Airplane Model 2 Buying) - Airplane Model 2 Actual Selling
V Airplane Model 2 Total Bought[Team] = PREVIOUS(Airplane Model 2 Total Bought, 0) + Airplane Model 2 Actual Buying 
V Airplane Model 2 Total Sold[Team] = PREVIOUS(Airplane Model 2 Total Sold, 0) + Airplane Model 2 Actual Selling

V Airplane Model 2 Bought Quarter 0[Team] = REMEMBER(STEP = 0,Airplane Model 2 Actual Buying,0)
V Airplane Model 2 Bought Quarter 1[Team] = REMEMBER(STEP = 1,Airplane Model 2 Actual Buying,0)
V Airplane Model 2 Bought Quarter 2[Team] = REMEMBER(STEP = 2,Airplane Model 2 Actual Buying,0)
V Airplane Model 2 Bought Quarter 3[Team] = REMEMBER(STEP = 3,Airplane Model 2 Actual Buying,0)
V Airplane Model 2 Bought Quarter 4[Team] = REMEMBER(STEP = 4,Airplane Model 2 Actual Buying,0)
V Airplane Model 2 Bought Quarter 5[Team] = REMEMBER(STEP = 5,Airplane Model 2 Actual Buying,0)
V Airplane Model 2 Bought Quarter 6[Team] = REMEMBER(STEP = 6,Airplane Model 2 Actual Buying,0)
V Airplane Model 2 Bought Quarter 7[Team] = REMEMBER(STEP = 7,Airplane Model 2 Actual Buying,0)

V Airplane Model 2 Left Over Quarter 0[Team] = 
IF(Airplane Model 2 Bought Quarter 0 >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 0 - Airplane Model 2 Total Sold, 0)

V Airplane Model 2 Left Over Quarter 1[Team] = 
IF(Airplane Model 2 Bought Quarter 0 >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 1, 
IF((Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1) >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 - Airplane Model 2 Total Sold, 0))

V Airplane Model 2 Left Over Quarter 2[Team] = 
IF((Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1) >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 2, 
IF((Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2) >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 - Airplane Model 2 Total Sold, 0))

V Airplane Model 2 Left Over Quarter 3[Team] = 
IF((Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2) >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 3, 
IF((Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3) >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3 - Airplane Model 2 Total Sold, 0))

V Airplane Model 2 Left Over Quarter 4[Team] = 
IF((Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3) >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 4, 
IF((Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3 + Airplane Model 2 Bought Quarter 4) >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3 + Airplane Model 2 Bought Quarter 4 - Airplane Model 2 Total Sold, 0))

V Airplane Model 2 Left Over Quarter 5[Team] = 
IF((Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3 + Airplane Model 2 Bought Quarter 4) >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 5, 
IF((Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3 + Airplane Model 2 Bought Quarter 4 + Airplane Model 2 Bought Quarter 5) >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3 + Airplane Model 2 Bought Quarter 4 + Airplane Model 2 Bought Quarter 5 - Airplane Model 2 Total Sold, 0))

V Airplane Model 2 Left Over Quarter 6[Team] = 
IF((Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3 + Airplane Model 2 Bought Quarter 4 + Airplane Model 2 Bought Quarter 5) >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 6, 
IF((Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3 + Airplane Model 2 Bought Quarter 4 + Airplane Model 2 Bought Quarter 5 + Airplane Model 2 Bought Quarter 6) >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3 + Airplane Model 2 Bought Quarter 4 + Airplane Model 2 Bought Quarter 5 + Airplane Model 2 Bought Quarter 6 - Airplane Model 2 Total Sold, 0))

V Airplane Model 2 Left Over Quarter 7[Team] = 
IF((Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3 + Airplane Model 2 Bought Quarter 4 + Airplane Model 2 Bought Quarter 5 + Airplane Model 2 Bought Quarter 6) >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 7, 
IF((Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3 + Airplane Model 2 Bought Quarter 4 + Airplane Model 2 Bought Quarter 5 + Airplane Model 2 Bought Quarter 6 + Airplane Model 2 Bought Quarter 7) >= Airplane Model 2 Total Sold, Airplane Model 2 Bought Quarter 0 + Airplane Model 2 Bought Quarter 1 + Airplane Model 2 Bought Quarter 2 + Airplane Model 2 Bought Quarter 3 + Airplane Model 2 Bought Quarter 4 + Airplane Model 2 Bought Quarter 5 + Airplane Model 2 Bought Quarter 6 + Airplane Model 2 Bought Quarter 7 - Airplane Model 2 Total Sold, 0))

V Airplane Model 2 Depreciation Rate = Airplane Model 2 Depreciation Per Quarter

V Airplane Model 2 Planes Sold From Quarter 0[Team] = IF((PREVIOUS(Airplane Model 2 Left Over Quarter 0, 0) > 0) & (PREVIOUS(Airplane Model 2 Left Over Quarter 0, 0) != Airplane Model 2 Left Over Quarter 0), PREVIOUS(Airplane Model 2 Left Over Quarter 0, 0) - Airplane Model 2 Left Over Quarter 0, 0)
V Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 0[Team] = STEP - 0
V Airplane Model 2 Planes Sold Depreciation Removed Quarter 0[Team] = Airplane Model 2 Planes Sold From Quarter 0 * Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 0 * Airplane Model 2 Depreciation Rate

V Airplane Model 2 Planes Sold From Quarter 1[Team] = IF((PREVIOUS(Airplane Model 2 Left Over Quarter 1, 0) > 0) & (PREVIOUS(Airplane Model 2 Left Over Quarter 1, 0) != Airplane Model 2 Left Over Quarter 1), PREVIOUS(Airplane Model 2 Left Over Quarter 1, 0) - Airplane Model 2 Left Over Quarter 1, 0)
V Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 1[Team] = STEP - 0
V Airplane Model 2 Planes Sold Depreciation Removed Quarter 1[Team] = Airplane Model 2 Planes Sold From Quarter 1 * Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 1 * Airplane Model 2 Depreciation Rate

V Airplane Model 2 Planes Sold From Quarter 2[Team] = IF((PREVIOUS(Airplane Model 2 Left Over Quarter 2, 0) > 0) & (PREVIOUS(Airplane Model 2 Left Over Quarter 2, 0) != Airplane Model 2 Left Over Quarter 2), PREVIOUS(Airplane Model 2 Left Over Quarter 2, 0) - Airplane Model 2 Left Over Quarter 2, 0)
V Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 2[Team] = STEP - 0
V Airplane Model 2 Planes Sold Depreciation Removed Quarter 2[Team] = Airplane Model 2 Planes Sold From Quarter 2 * Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 2 * Airplane Model 2 Depreciation Rate

V Airplane Model 2 Planes Sold From Quarter 3[Team] = IF((PREVIOUS(Airplane Model 2 Left Over Quarter 3, 0) > 0) & (PREVIOUS(Airplane Model 2 Left Over Quarter 3, 0) != Airplane Model 2 Left Over Quarter 3), PREVIOUS(Airplane Model 2 Left Over Quarter 3, 0) - Airplane Model 2 Left Over Quarter 3, 0)
V Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 3[Team] = STEP - 0
V Airplane Model 2 Planes Sold Depreciation Removed Quarter 3[Team] = Airplane Model 2 Planes Sold From Quarter 3 * Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 3 * Airplane Model 2 Depreciation Rate

V Airplane Model 2 Planes Sold From Quarter 4[Team] = IF((PREVIOUS(Airplane Model 2 Left Over Quarter 4, 0) > 0) & (PREVIOUS(Airplane Model 2 Left Over Quarter 4, 0) != Airplane Model 2 Left Over Quarter 4), PREVIOUS(Airplane Model 2 Left Over Quarter 4, 0) - Airplane Model 2 Left Over Quarter 4, 0)
V Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 4[Team] = STEP - 0
V Airplane Model 2 Planes Sold Depreciation Removed Quarter 4[Team] = Airplane Model 2 Planes Sold From Quarter 4 * Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 4 * Airplane Model 2 Depreciation Rate

V Airplane Model 2 Planes Sold From Quarter 5[Team] = IF((PREVIOUS(Airplane Model 2 Left Over Quarter 5, 0) > 0) & (PREVIOUS(Airplane Model 2 Left Over Quarter 5, 0) != Airplane Model 2 Left Over Quarter 5), PREVIOUS(Airplane Model 2 Left Over Quarter 5, 0) - Airplane Model 2 Left Over Quarter 5, 0)
V Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 5[Team] = STEP - 0
V Airplane Model 2 Planes Sold Depreciation Removed Quarter 5[Team] = Airplane Model 2 Planes Sold From Quarter 5 * Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 5 * Airplane Model 2 Depreciation Rate

V Airplane Model 2 Planes Sold From Quarter 6[Team] = IF((PREVIOUS(Airplane Model 2 Left Over Quarter 6, 0) > 0) & (PREVIOUS(Airplane Model 2 Left Over Quarter 6, 0) != Airplane Model 2 Left Over Quarter 6), PREVIOUS(Airplane Model 2 Left Over Quarter 6, 0) - Airplane Model 2 Left Over Quarter 6, 0)
V Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 6[Team] = STEP - 0
V Airplane Model 2 Planes Sold Depreciation Removed Quarter 6[Team] = Airplane Model 2 Planes Sold From Quarter 6 * Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 6 * Airplane Model 2 Depreciation Rate

V Airplane Model 2 Planes Sold From Quarter 7[Team] = IF((PREVIOUS(Airplane Model 2 Left Over Quarter 7, 0) > 0) & (PREVIOUS(Airplane Model 2 Left Over Quarter 7, 0) != Airplane Model 2 Left Over Quarter 7), PREVIOUS(Airplane Model 2 Left Over Quarter 7, 0) - Airplane Model 2 Left Over Quarter 7, 0)
V Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 7[Team] = STEP - 0
V Airplane Model 2 Planes Sold Depreciation Removed Quarter 7[Team] = Airplane Model 2 Planes Sold From Quarter 7 * Airplane Model 2 Quarters Difference Between Bought And Sold Quarter 7 * Airplane Model 2 Depreciation Rate

V Airplane Model 2 Airplanes Sold Number[Team] = Airplane Model 2 Planes Sold From Quarter 0 + Airplane Model 2 Planes Sold From Quarter 1 + Airplane Model 2 Planes Sold From Quarter 2 + Airplane Model 2 Planes Sold From Quarter 3 + Airplane Model 2 Planes Sold From Quarter 4 + Airplane Model 2 Planes Sold From Quarter 5 + Airplane Model 2 Planes Sold From Quarter 6 + Airplane Model 2 Planes Sold From Quarter 7
V Airplane Model 2 Airplanes Sold Cost[Team] = Airplane Model 2 Airplanes Sold Number * Airplane Model 2 Purchase Cost
V Airplane Model 2 Airplanes Sold Depreciation Removed[Team] = Airplane Model 2 Planes Sold Depreciation Removed Quarter 0 + Airplane Model 2 Planes Sold Depreciation Removed Quarter 1 + Airplane Model 2 Planes Sold Depreciation Removed Quarter 2 + Airplane Model 2 Planes Sold Depreciation Removed Quarter 3 + Airplane Model 2 Planes Sold Depreciation Removed Quarter 4 + Airplane Model 2 Planes Sold Depreciation Removed Quarter 5 + Airplane Model 2 Planes Sold Depreciation Removed Quarter 6 + Airplane Model 2 Planes Sold Depreciation Removed Quarter 7
V Airplane Model 2 Airplanes Sold Book Value[Team] = Airplane Model 2 Airplanes Sold Cost - Airplane Model 2 Airplanes Sold Depreciation Removed
V Airplane Model 2 Airplanes Sold Funds From Sale[Team] = Airplane Model 2 Airplanes Sold Book Value
V Airplane Model 2 Airplanes Selling Expense[Team] = Airplane Model 2 Airplanes Sold Book Value * Fleet 0 Sale Transaction Fee Percentage

D Airplane Model 2 Selling[Team] = 0
P Airplane Model 2 Selling.ExecuteDecisionImmediately = true
P Airplane Model 2 Selling.SaveResult = true
P Airplane Model 2 Selling.ResetDecision = true
P Airplane Model 2 Selling.DecisionMin = 0
P Airplane Model 2 Selling.DecisionMax = 5

V Airplane Model 2 Actual Selling[Team] = IF(Airplane Model 2 Selling = 0, 0, IF(Airplane Model 2 Selling > PREVIOUS(Airplane Model 2 Own, 0), PREVIOUS(Airplane Model 2 Own, 0), Airplane Model 2 Selling))

D Airplane Model 2 Leasing[Team] = 0
P Airplane Model 2 Leasing.ExecuteDecisionImmediately = true
P Airplane Model 2 Leasing.SaveResult = true
P Airplane Model 2 Leasing.ResetDecision = true
P Airplane Model 2 Leasing.DecisionMin = 0
P Airplane Model 2 Leasing.DecisionMax = 5

V Airplane Model 2 Leased[Team] = PREVIOUS(Airplane Model 2 Leased, 0) + Airplane Model 2 Leasing - Airplane Model 2 Actual Cancelling

D Airplane Model 2 Cancelling[Team] = 0
P Airplane Model 2 Cancelling.ExecuteDecisionImmediately = true
P Airplane Model 2 Cancelling.SaveResult = true
P Airplane Model 2 Cancelling.ResetDecision = true
P Airplane Model 2 Cancelling.DecisionMin = 0
P Airplane Model 2 Cancelling.DecisionMax = 5

V Airplane Model 2 Actual Cancelling[Team] = IF(Airplane Model 2 Cancelling = 0, 0, IF(Airplane Model 2 Cancelling > PREVIOUS(Airplane Model 2 Leased, 0), PREVIOUS(Airplane Model 2 Leased, 0), Airplane Model 2 Cancelling))


## Airplane Model 3 ##

V Airplane Model 3 Seats = 100
V Airplane Model 3 Maximum Daily Kms = 6000
V Airplane Model 3 Cruising Kms Per Hour = 425
V Airplane Model 3 Purchase Cost  = 5000000
V Airplane Model 3 Beginning Planes = 0
V Airplane Model 3 Monthly Lease Cost = Airplane Model 3 Purchase Cost / 20 / 4 
V Airplane Model 3 Fuel Cost Per Seat Km = 0.03
V Airplane Model 3 Maintenance Cost Per Seat Km = 0.0337
V Airplane Model 3 Insurance Rate Per Seat = 66
V Airplane Model 3 Insurance Cost Per Plane = Airplane Model 3 Seats * Airplane Model 3 Insurance Rate Per Seat

V Airplane Model 3 Depreciation Per Quarter = (Airplane Model 3 Purchase Cost / Fleet Aircraft Life Expectancy) / 4
V Airplane Model 3 Depreciation Expense[Team] = Airplane Model 3 Own * Airplane Model 3 Depreciation Per Quarter
V Airplane Model 3 Depreciation Total[Team] = PREVIOUS(Airplane Model 3 Depreciation Total, 0) + Airplane Model 3 Depreciation Expense - Airplane Model 3 Airplanes Sold Depreciation Removed

V Airplane Model 3 Available Maximum Daily Kms[Team] = Airplane Model 3 Own * Airplane Model 3 Maximum Daily Kms + Airplane Model 3 Leased * Airplane Model 3 Maximum Daily Kms

V Airplane Model 3 Owned A Leased Planes[Team] = Airplane Model 3 Own + Airplane Model 3 Leased
V Airplane Model 3 Available Daily Kms[Team] = Airplane Model 3 Owned A Leased Planes * Airplane Model 3 Maximum Daily Kms
V Airplane Model 3 Seats Available[Team] = Airplane Model 3 Owned A Leased Planes * Airplane Model 3 Seats
V Airplane Model 3 Fuel Cost Per Seat Mile[Team] = Airplane Model 3 Owned A Leased Planes * Airplane Model 3 Fuel Cost Per Seat Km

D Airplane Model 3 Buying[Team] = 0
P Airplane Model 3 Buying.ExecuteDecisionImmediately = true
P Airplane Model 3 Buying.SaveResult = true
P Airplane Model 3 Buying.ResetDecision = true
P Airplane Model 3 Buying.DecisionMin = 0
P Airplane Model 3 Buying.DecisionMax = 5
V Airplane Model 3 Buying Cost[Team] = Airplane Model 3 Buying * Airplane Model 3 Purchase Cost
V Airplane Model 3 Actual Buying[Team] = IF(Fleet Acquisition Validation < 0, 0, Airplane Model 3 Buying)
V Airplane Model 3 Actual Buying Cost[Team] = Airplane Model 3 Actual Buying * Airplane Model 3 Purchase Cost

V Airplane Model 3 Own[Team] = PREVIOUS(Airplane Model 3 Own, Airplane Model 3 Beginning Planes) + IF(Fleet Acquisition Validation < 0, 0, Airplane Model 3 Buying) - Airplane Model 3 Actual Selling
V Airplane Model 3 Total Bought[Team] = PREVIOUS(Airplane Model 3 Total Bought, Airplane Model 3 Beginning Planes) + Airplane Model 3 Actual Buying 
V Airplane Model 3 Total Sold[Team] = PREVIOUS(Airplane Model 3 Total Sold, 0) + Airplane Model 3 Actual Selling

V Airplane Model 3 Bought Beginning[Team] = Airplane Model 3 Beginning Planes
V Airplane Model 3 Bought Quarter 0[Team] = REMEMBER(STEP = 0,Airplane Model 3 Actual Buying,0)
V Airplane Model 3 Bought Quarter 1[Team] = REMEMBER(STEP = 1,Airplane Model 3 Actual Buying,0)
V Airplane Model 3 Bought Quarter 2[Team] = REMEMBER(STEP = 2,Airplane Model 3 Actual Buying,0)
V Airplane Model 3 Bought Quarter 3[Team] = REMEMBER(STEP = 3,Airplane Model 3 Actual Buying,0)
V Airplane Model 3 Bought Quarter 4[Team] = REMEMBER(STEP = 4,Airplane Model 3 Actual Buying,0)
V Airplane Model 3 Bought Quarter 5[Team] = REMEMBER(STEP = 5,Airplane Model 3 Actual Buying,0)
V Airplane Model 3 Bought Quarter 6[Team] = REMEMBER(STEP = 6,Airplane Model 3 Actual Buying,0)
V Airplane Model 3 Bought Quarter 7[Team] = REMEMBER(STEP = 7,Airplane Model 3 Actual Buying,0)

V Airplane Model 3 Left Over Beginning[Team] = IF(Airplane Model 3 Bought Beginning >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Beginning - Airplane Model 3 Total Sold, 0)

V Airplane Model 3 Left Over Quarter 0[Team] = IF(Airplane Model 3 Bought Beginning >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Quarter 0, IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 - Airplane Model 3 Total Sold, 0))
V Airplane Model 3 Left Over Quarter 1[Team] = IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Quarter 1, IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 - Airplane Model 3 Total Sold, 0))
V Airplane Model 3 Left Over Quarter 2[Team] = IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Quarter 2, IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 - Airplane Model 3 Total Sold, 0))
V Airplane Model 3 Left Over Quarter 3[Team] = IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Quarter 3, IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3 - Airplane Model 3 Total Sold, 0))
V Airplane Model 3 Left Over Quarter 4[Team] = IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Quarter 4, IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3 + Airplane Model 3 Bought Quarter 4) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3 + Airplane Model 3 Bought Quarter 4 - Airplane Model 3 Total Sold, 0))
V Airplane Model 3 Left Over Quarter 5[Team] = IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3 + Airplane Model 3 Bought Quarter 4) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Quarter 5, IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3 + Airplane Model 3 Bought Quarter 4 + Airplane Model 3 Bought Quarter 5) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3 + Airplane Model 3 Bought Quarter 4 + Airplane Model 3 Bought Quarter 5 - Airplane Model 3 Total Sold, 0))
V Airplane Model 3 Left Over Quarter 6[Team] = IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3 + Airplane Model 3 Bought Quarter 4 + Airplane Model 3 Bought Quarter 5) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Quarter 6, IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3 + Airplane Model 3 Bought Quarter 4 + Airplane Model 3 Bought Quarter 5 + Airplane Model 3 Bought Quarter 6) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3 + Airplane Model 3 Bought Quarter 4 + Airplane Model 3 Bought Quarter 5 + Airplane Model 3 Bought Quarter 6 - Airplane Model 3 Total Sold, 0))
V Airplane Model 3 Left Over Quarter 7[Team] = IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3 + Airplane Model 3 Bought Quarter 4 + Airplane Model 3 Bought Quarter 5 + Airplane Model 3 Bought Quarter 6) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Quarter 7, IF((Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3 + Airplane Model 3 Bought Quarter 4 + Airplane Model 3 Bought Quarter 5 + Airplane Model 3 Bought Quarter 6 + Airplane Model 3 Bought Quarter 7) >= Airplane Model 3 Total Sold, Airplane Model 3 Bought Beginning + Airplane Model 3 Bought Quarter 0 + Airplane Model 3 Bought Quarter 1 + Airplane Model 3 Bought Quarter 2 + Airplane Model 3 Bought Quarter 3 + Airplane Model 3 Bought Quarter 4 + Airplane Model 3 Bought Quarter 5 + Airplane Model 3 Bought Quarter 6 + Airplane Model 3 Bought Quarter 7 - Airplane Model 3 Total Sold, 0))

V Airplane Model 3 Depreciation Rate = Airplane Model 3 Depreciation Per Quarter

V Airplane Model 3 Planes Sold From Beginning[Team] = IF((PREVIOUS(Airplane Model 3 Left Over Beginning, 0) > 0) & (PREVIOUS(Airplane Model 3 Left Over Beginning, 0) != Airplane Model 3 Left Over Beginning), PREVIOUS(Airplane Model 3 Left Over Beginning, 0) - Airplane Model 3 Left Over Beginning, 0)
V Airplane Model 3 Quarters Difference Between Bought And Sold Beginning[Team] = STEP - 0
V Airplane Model 3 Planes Sold Depreciation Removed Beginning[Team] = Airplane Model 3 Planes Sold From Beginning * Airplane Model 3 Quarters Difference Between Bought And Sold Beginning * Airplane Model 3 Depreciation Rate

V Airplane Model 3 Planes Sold From Quarter 0[Team] = IF((PREVIOUS(Airplane Model 3 Left Over Quarter 0, 0) > 0) & (PREVIOUS(Airplane Model 3 Left Over Quarter 0, 0) != Airplane Model 3 Left Over Quarter 0), PREVIOUS(Airplane Model 3 Left Over Quarter 0, 0) - Airplane Model 3 Left Over Quarter 0, 0)
V Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 0[Team] = STEP - 1
V Airplane Model 3 Planes Sold Depreciation Removed Quarter 0[Team] = Airplane Model 3 Planes Sold From Quarter 0 * Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 0 * Airplane Model 3 Depreciation Rate

V Airplane Model 3 Planes Sold From Quarter 1[Team] = IF((PREVIOUS(Airplane Model 3 Left Over Quarter 1, 0) > 0) & (PREVIOUS(Airplane Model 3 Left Over Quarter 1, 0) != Airplane Model 3 Left Over Quarter 1), PREVIOUS(Airplane Model 3 Left Over Quarter 1, 0) - Airplane Model 3 Left Over Quarter 1, 0)
V Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 1[Team] = STEP - 2
V Airplane Model 3 Planes Sold Depreciation Removed Quarter 1[Team] = Airplane Model 3 Planes Sold From Quarter 1 * Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 1 * Airplane Model 3 Depreciation Rate

V Airplane Model 3 Planes Sold From Quarter 2[Team] = IF((PREVIOUS(Airplane Model 3 Left Over Quarter 2, 0) > 0) & (PREVIOUS(Airplane Model 3 Left Over Quarter 2, 0) != Airplane Model 3 Left Over Quarter 2), PREVIOUS(Airplane Model 3 Left Over Quarter 2, 0) - Airplane Model 3 Left Over Quarter 2, 0)
V Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 2[Team] = STEP - 3
V Airplane Model 3 Planes Sold Depreciation Removed Quarter 2[Team] = Airplane Model 3 Planes Sold From Quarter 2 * Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 2 * Airplane Model 3 Depreciation Rate

V Airplane Model 3 Planes Sold From Quarter 3[Team] = IF((PREVIOUS(Airplane Model 3 Left Over Quarter 3, 0) > 0) & (PREVIOUS(Airplane Model 3 Left Over Quarter 3, 0) != Airplane Model 3 Left Over Quarter 3), PREVIOUS(Airplane Model 3 Left Over Quarter 3, 0) - Airplane Model 3 Left Over Quarter 3, 0)
V Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 3[Team] = STEP - 4
V Airplane Model 3 Planes Sold Depreciation Removed Quarter 3[Team] = Airplane Model 3 Planes Sold From Quarter 3 * Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 3 * Airplane Model 3 Depreciation Rate

V Airplane Model 3 Planes Sold From Quarter 4[Team] = IF((PREVIOUS(Airplane Model 3 Left Over Quarter 4, 0) > 0) & (PREVIOUS(Airplane Model 3 Left Over Quarter 4, 0) != Airplane Model 3 Left Over Quarter 4), PREVIOUS(Airplane Model 3 Left Over Quarter 4, 0) - Airplane Model 3 Left Over Quarter 4, 0)
V Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 4[Team] = STEP - 5
V Airplane Model 3 Planes Sold Depreciation Removed Quarter 4[Team] = Airplane Model 3 Planes Sold From Quarter 4 * Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 4 * Airplane Model 3 Depreciation Rate

V Airplane Model 3 Planes Sold From Quarter 5[Team] = IF((PREVIOUS(Airplane Model 3 Left Over Quarter 5, 0) > 0) & (PREVIOUS(Airplane Model 3 Left Over Quarter 5, 0) != Airplane Model 3 Left Over Quarter 5), PREVIOUS(Airplane Model 3 Left Over Quarter 5, 0) - Airplane Model 3 Left Over Quarter 5, 0)
V Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 5[Team] = STEP - 6
V Airplane Model 3 Planes Sold Depreciation Removed Quarter 5[Team] = Airplane Model 3 Planes Sold From Quarter 5 * Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 5 * Airplane Model 3 Depreciation Rate

V Airplane Model 3 Planes Sold From Quarter 6[Team] = IF((PREVIOUS(Airplane Model 3 Left Over Quarter 6, 0) > 0) & (PREVIOUS(Airplane Model 3 Left Over Quarter 6, 0) != Airplane Model 3 Left Over Quarter 6), PREVIOUS(Airplane Model 3 Left Over Quarter 6, 0) - Airplane Model 3 Left Over Quarter 6, 0)
V Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 6[Team] = STEP - 7
V Airplane Model 3 Planes Sold Depreciation Removed Quarter 6[Team] = Airplane Model 3 Planes Sold From Quarter 6 * Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 6 * Airplane Model 3 Depreciation Rate

V Airplane Model 3 Planes Sold From Quarter 7[Team] = IF((PREVIOUS(Airplane Model 3 Left Over Quarter 7, 0) > 0) & (PREVIOUS(Airplane Model 3 Left Over Quarter 7, 0) != Airplane Model 3 Left Over Quarter 7), PREVIOUS(Airplane Model 3 Left Over Quarter 7, 0) - Airplane Model 3 Left Over Quarter 7, 0)
V Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 7[Team] = STEP - 8
V Airplane Model 3 Planes Sold Depreciation Removed Quarter 7[Team] = Airplane Model 3 Planes Sold From Quarter 7 * Airplane Model 3 Quarters Difference Between Bought And Sold Quarter 7 * Airplane Model 3 Depreciation Rate

V Airplane Model 3 Airplanes Sold Number[Team] = Airplane Model 3 Planes Sold From Beginning + Airplane Model 3 Planes Sold From Quarter 0 + Airplane Model 3 Planes Sold From Quarter 1 + Airplane Model 3 Planes Sold From Quarter 2 + Airplane Model 3 Planes Sold From Quarter 3 + Airplane Model 3 Planes Sold From Quarter 4 + Airplane Model 3 Planes Sold From Quarter 5 + Airplane Model 3 Planes Sold From Quarter 6 + Airplane Model 3 Planes Sold From Quarter 7
V Airplane Model 3 Airplanes Sold Cost[Team] = Airplane Model 3 Airplanes Sold Number * Airplane Model 3 Purchase Cost
V Airplane Model 3 Airplanes Sold Depreciation Removed[Team] = Airplane Model 3 Planes Sold Depreciation Removed Beginning + Airplane Model 3 Planes Sold Depreciation Removed Quarter 0 + Airplane Model 3 Planes Sold Depreciation Removed Quarter 1 + Airplane Model 3 Planes Sold Depreciation Removed Quarter 2 + Airplane Model 3 Planes Sold Depreciation Removed Quarter 3 + Airplane Model 3 Planes Sold Depreciation Removed Quarter 4 + Airplane Model 3 Planes Sold Depreciation Removed Quarter 5 + Airplane Model 3 Planes Sold Depreciation Removed Quarter 6 + Airplane Model 3 Planes Sold Depreciation Removed Quarter 7
V Airplane Model 3 Airplanes Sold Book Value[Team] = Airplane Model 3 Airplanes Sold Cost - Airplane Model 3 Airplanes Sold Depreciation Removed
V Airplane Model 3 Airplanes Sold Funds From Sale[Team] = Airplane Model 3 Airplanes Sold Book Value
V Airplane Model 3 Airplanes Selling Expense[Team] = Airplane Model 3 Airplanes Sold Book Value * Fleet 0 Sale Transaction Fee Percentage

D Airplane Model 3 Selling[Team] = 0
P Airplane Model 3 Selling.ExecuteDecisionImmediately = true
P Airplane Model 3 Selling.SaveResult = true
P Airplane Model 3 Selling.ResetDecision = true
P Airplane Model 3 Selling.DecisionMin = 0
P Airplane Model 3 Selling.DecisionMax = 5

V Airplane Model 3 Actual Selling[Team] = IF(Airplane Model 3 Selling = 0, 0, IF(Airplane Model 3 Selling > PREVIOUS(Airplane Model 3 Own, 2), PREVIOUS(Airplane Model 3 Own, 2), Airplane Model 3 Selling))

D Airplane Model 3 Leasing[Team] = 0
P Airplane Model 3 Leasing.ExecuteDecisionImmediately = true
P Airplane Model 3 Leasing.SaveResult = true
P Airplane Model 3 Leasing.ResetDecision = true
P Airplane Model 3 Leasing.DecisionMin = 0
P Airplane Model 3 Leasing.DecisionMax = 5

V Airplane Model 3 Leased[Team] = PREVIOUS(Airplane Model 3 Leased, 0) + Airplane Model 3 Leasing - Airplane Model 3 Actual Cancelling

D Airplane Model 3 Cancelling[Team] = 0
P Airplane Model 3 Cancelling.ExecuteDecisionImmediately = true
P Airplane Model 3 Cancelling.SaveResult = true
P Airplane Model 3 Cancelling.ResetDecision = true
P Airplane Model 3 Cancelling.DecisionMin = 0
P Airplane Model 3 Cancelling.DecisionMax = 5

V Airplane Model 3 Actual Cancelling[Team] = IF(Airplane Model 3 Cancelling = 0, 0, IF(Airplane Model 3 Cancelling > PREVIOUS(Airplane Model 3 Leased, 0), PREVIOUS(Airplane Model 3 Leased, 0), Airplane Model 3 Cancelling))


## Airplane Model 4 ##

V Airplane Model 4 Seats = 75
V Airplane Model 4 Maximum Daily Kms = 20000
V Airplane Model 4 Cruising Kms Per Hour = 425
V Airplane Model 4 Purchase Cost  = 5500000
V Airplane Model 4 Beginning Planes = 0
V Airplane Model 4 Monthly Lease Cost = Airplane Model 4 Purchase Cost / 20 / 4 
V Airplane Model 4 Fuel Cost Per Seat Km = 0.03
V Airplane Model 4 Maintenance Cost Per Seat Km = 0.0337
V Airplane Model 4 Insurance Rate Per Seat = 66
V Airplane Model 4 Insurance Cost Per Plane = Airplane Model 4 Seats * Airplane Model 4 Insurance Rate Per Seat

V Airplane Model 4 Depreciation Per Quarter = (Airplane Model 4 Purchase Cost / Fleet Aircraft Life Expectancy) / 4
V Airplane Model 4 Depreciation Expense[Team] = Airplane Model 4 Own * Airplane Model 4 Depreciation Per Quarter
V Airplane Model 4 Depreciation Total[Team] = PREVIOUS(Airplane Model 4 Depreciation Total, 0) + Airplane Model 4 Depreciation Expense - Airplane Model 4 Airplanes Sold Depreciation Removed

V Airplane Model 4 Available Maximum Daily Kms[Team] = Airplane Model 4 Own * Airplane Model 4 Maximum Daily Kms + Airplane Model 4 Leased * Airplane Model 4 Maximum Daily Kms

V Airplane Model 4 Owned A Leased Planes[Team] = Airplane Model 4 Own + Airplane Model 4 Leased
V Airplane Model 4 Available Daily Kms[Team] = Airplane Model 4 Owned A Leased Planes * Airplane Model 4 Maximum Daily Kms
V Airplane Model 4 Seats Available[Team] = Airplane Model 4 Owned A Leased Planes * Airplane Model 4 Seats
V Airplane Model 4 Fuel Cost Per Seat Mile[Team] = Airplane Model 4 Owned A Leased Planes * Airplane Model 4 Fuel Cost Per Seat Km

D Airplane Model 4 Buying[Team] = 0
P Airplane Model 4 Buying.ExecuteDecisionImmediately = true
P Airplane Model 4 Buying.SaveResult = true
P Airplane Model 4 Buying.ResetDecision = true
P Airplane Model 4 Buying.DecisionMin = 0
P Airplane Model 4 Buying.DecisionMax = 5
V Airplane Model 4 Buying Cost[Team] = Airplane Model 4 Buying * Airplane Model 4 Purchase Cost
V Airplane Model 4 Actual Buying[Team] = IF(Fleet Acquisition Validation < 0, 0, Airplane Model 4 Buying)
V Airplane Model 4 Actual Buying Cost[Team] = Airplane Model 4 Actual Buying * Airplane Model 4 Purchase Cost

V Airplane Model 4 Own[Team] = PREVIOUS(Airplane Model 4 Own, Airplane Model 4 Beginning Planes) + IF(Fleet Acquisition Validation < 0, 0, Airplane Model 4 Buying) - Airplane Model 4 Actual Selling
V Airplane Model 4 Total Bought[Team] = PREVIOUS(Airplane Model 4 Total Bought, Airplane Model 4 Beginning Planes) + Airplane Model 4 Actual Buying 
V Airplane Model 4 Total Sold[Team] = PREVIOUS(Airplane Model 4 Total Sold, 0) + Airplane Model 4 Actual Selling

V Airplane Model 4 Bought Beginning[Team] = Airplane Model 4 Beginning Planes
V Airplane Model 4 Bought Quarter 0[Team] = REMEMBER(STEP = 0,Airplane Model 4 Actual Buying,0)
V Airplane Model 4 Bought Quarter 1[Team] = REMEMBER(STEP = 1,Airplane Model 4 Actual Buying,0)
V Airplane Model 4 Bought Quarter 2[Team] = REMEMBER(STEP = 2,Airplane Model 4 Actual Buying,0)
V Airplane Model 4 Bought Quarter 3[Team] = REMEMBER(STEP = 3,Airplane Model 4 Actual Buying,0)
V Airplane Model 4 Bought Quarter 4[Team] = REMEMBER(STEP = 4,Airplane Model 4 Actual Buying,0)
V Airplane Model 4 Bought Quarter 5[Team] = REMEMBER(STEP = 5,Airplane Model 4 Actual Buying,0)
V Airplane Model 4 Bought Quarter 6[Team] = REMEMBER(STEP = 6,Airplane Model 4 Actual Buying,0)
V Airplane Model 4 Bought Quarter 7[Team] = REMEMBER(STEP = 7,Airplane Model 4 Actual Buying,0)

V Airplane Model 4 Left Over Beginning[Team] = IF(Airplane Model 4 Bought Beginning >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Beginning - Airplane Model 4 Total Sold, 0)

V Airplane Model 4 Left Over Quarter 0[Team] = IF(Airplane Model 4 Bought Beginning >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Quarter 0, IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 - Airplane Model 4 Total Sold, 0))
V Airplane Model 4 Left Over Quarter 1[Team] = IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Quarter 1, IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 - Airplane Model 4 Total Sold, 0))
V Airplane Model 4 Left Over Quarter 2[Team] = IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Quarter 2, IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 - Airplane Model 4 Total Sold, 0))
V Airplane Model 4 Left Over Quarter 3[Team] = IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Quarter 3, IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3 - Airplane Model 4 Total Sold, 0))
V Airplane Model 4 Left Over Quarter 4[Team] = IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Quarter 4, IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3 + Airplane Model 4 Bought Quarter 4) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3 + Airplane Model 4 Bought Quarter 4 - Airplane Model 4 Total Sold, 0))
V Airplane Model 4 Left Over Quarter 5[Team] = IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3 + Airplane Model 4 Bought Quarter 4) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Quarter 5, IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3 + Airplane Model 4 Bought Quarter 4 + Airplane Model 4 Bought Quarter 5) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3 + Airplane Model 4 Bought Quarter 4 + Airplane Model 4 Bought Quarter 5 - Airplane Model 4 Total Sold, 0))
V Airplane Model 4 Left Over Quarter 6[Team] = IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3 + Airplane Model 4 Bought Quarter 4 + Airplane Model 4 Bought Quarter 5) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Quarter 6, IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3 + Airplane Model 4 Bought Quarter 4 + Airplane Model 4 Bought Quarter 5 + Airplane Model 4 Bought Quarter 6) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3 + Airplane Model 4 Bought Quarter 4 + Airplane Model 4 Bought Quarter 5 + Airplane Model 4 Bought Quarter 6 - Airplane Model 4 Total Sold, 0))
V Airplane Model 4 Left Over Quarter 7[Team] = IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3 + Airplane Model 4 Bought Quarter 4 + Airplane Model 4 Bought Quarter 5 + Airplane Model 4 Bought Quarter 6) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Quarter 7, IF((Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3 + Airplane Model 4 Bought Quarter 4 + Airplane Model 4 Bought Quarter 5 + Airplane Model 4 Bought Quarter 6 + Airplane Model 4 Bought Quarter 7) >= Airplane Model 4 Total Sold, Airplane Model 4 Bought Beginning + Airplane Model 4 Bought Quarter 0 + Airplane Model 4 Bought Quarter 1 + Airplane Model 4 Bought Quarter 2 + Airplane Model 4 Bought Quarter 3 + Airplane Model 4 Bought Quarter 4 + Airplane Model 4 Bought Quarter 5 + Airplane Model 4 Bought Quarter 6 + Airplane Model 4 Bought Quarter 7 - Airplane Model 4 Total Sold, 0))

V Airplane Model 4 Depreciation Rate = Airplane Model 4 Depreciation Per Quarter

V Airplane Model 4 Planes Sold From Beginning[Team] = IF((PREVIOUS(Airplane Model 4 Left Over Beginning, 0) > 0) & (PREVIOUS(Airplane Model 4 Left Over Beginning, 0) != Airplane Model 4 Left Over Beginning), PREVIOUS(Airplane Model 4 Left Over Beginning, 0) - Airplane Model 4 Left Over Beginning, 0)
V Airplane Model 4 Quarters Difference Between Bought And Sold Beginning[Team] = STEP - 0
V Airplane Model 4 Planes Sold Depreciation Removed Beginning[Team] = Airplane Model 4 Planes Sold From Beginning * Airplane Model 4 Quarters Difference Between Bought And Sold Beginning * Airplane Model 4 Depreciation Rate

V Airplane Model 4 Planes Sold From Quarter 0[Team] = IF((PREVIOUS(Airplane Model 4 Left Over Quarter 0, 0) > 0) & (PREVIOUS(Airplane Model 4 Left Over Quarter 0, 0) != Airplane Model 4 Left Over Quarter 0), PREVIOUS(Airplane Model 4 Left Over Quarter 0, 0) - Airplane Model 4 Left Over Quarter 0, 0)
V Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 0[Team] = STEP - 1
V Airplane Model 4 Planes Sold Depreciation Removed Quarter 0[Team] = Airplane Model 4 Planes Sold From Quarter 0 * Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 0 * Airplane Model 4 Depreciation Rate

V Airplane Model 4 Planes Sold From Quarter 1[Team] = IF((PREVIOUS(Airplane Model 4 Left Over Quarter 1, 0) > 0) & (PREVIOUS(Airplane Model 4 Left Over Quarter 1, 0) != Airplane Model 4 Left Over Quarter 1), PREVIOUS(Airplane Model 4 Left Over Quarter 1, 0) - Airplane Model 4 Left Over Quarter 1, 0)
V Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 1[Team] = STEP - 2
V Airplane Model 4 Planes Sold Depreciation Removed Quarter 1[Team] = Airplane Model 4 Planes Sold From Quarter 1 * Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 1 * Airplane Model 4 Depreciation Rate

V Airplane Model 4 Planes Sold From Quarter 2[Team] = IF((PREVIOUS(Airplane Model 4 Left Over Quarter 2, 0) > 0) & (PREVIOUS(Airplane Model 4 Left Over Quarter 2, 0) != Airplane Model 4 Left Over Quarter 2), PREVIOUS(Airplane Model 4 Left Over Quarter 2, 0) - Airplane Model 4 Left Over Quarter 2, 0)
V Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 2[Team] = STEP - 3
V Airplane Model 4 Planes Sold Depreciation Removed Quarter 2[Team] = Airplane Model 4 Planes Sold From Quarter 2 * Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 2 * Airplane Model 4 Depreciation Rate

V Airplane Model 4 Planes Sold From Quarter 3[Team] = IF((PREVIOUS(Airplane Model 4 Left Over Quarter 3, 0) > 0) & (PREVIOUS(Airplane Model 4 Left Over Quarter 3, 0) != Airplane Model 4 Left Over Quarter 3), PREVIOUS(Airplane Model 4 Left Over Quarter 3, 0) - Airplane Model 4 Left Over Quarter 3, 0)
V Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 3[Team] = STEP - 4
V Airplane Model 4 Planes Sold Depreciation Removed Quarter 3[Team] = Airplane Model 4 Planes Sold From Quarter 3 * Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 3 * Airplane Model 4 Depreciation Rate

V Airplane Model 4 Planes Sold From Quarter 4[Team] = IF((PREVIOUS(Airplane Model 4 Left Over Quarter 4, 0) > 0) & (PREVIOUS(Airplane Model 4 Left Over Quarter 4, 0) != Airplane Model 4 Left Over Quarter 4), PREVIOUS(Airplane Model 4 Left Over Quarter 4, 0) - Airplane Model 4 Left Over Quarter 4, 0)
V Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 4[Team] = STEP - 5
V Airplane Model 4 Planes Sold Depreciation Removed Quarter 4[Team] = Airplane Model 4 Planes Sold From Quarter 4 * Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 4 * Airplane Model 4 Depreciation Rate

V Airplane Model 4 Planes Sold From Quarter 5[Team] = IF((PREVIOUS(Airplane Model 4 Left Over Quarter 5, 0) > 0) & (PREVIOUS(Airplane Model 4 Left Over Quarter 5, 0) != Airplane Model 4 Left Over Quarter 5), PREVIOUS(Airplane Model 4 Left Over Quarter 5, 0) - Airplane Model 4 Left Over Quarter 5, 0)
V Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 5[Team] = STEP - 6
V Airplane Model 4 Planes Sold Depreciation Removed Quarter 5[Team] = Airplane Model 4 Planes Sold From Quarter 5 * Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 5 * Airplane Model 4 Depreciation Rate

V Airplane Model 4 Planes Sold From Quarter 6[Team] = IF((PREVIOUS(Airplane Model 4 Left Over Quarter 6, 0) > 0) & (PREVIOUS(Airplane Model 4 Left Over Quarter 6, 0) != Airplane Model 4 Left Over Quarter 6), PREVIOUS(Airplane Model 4 Left Over Quarter 6, 0) - Airplane Model 4 Left Over Quarter 6, 0)
V Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 6[Team] = STEP - 7
V Airplane Model 4 Planes Sold Depreciation Removed Quarter 6[Team] = Airplane Model 4 Planes Sold From Quarter 6 * Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 6 * Airplane Model 4 Depreciation Rate

V Airplane Model 4 Planes Sold From Quarter 7[Team] = IF((PREVIOUS(Airplane Model 4 Left Over Quarter 7, 0) > 0) & (PREVIOUS(Airplane Model 4 Left Over Quarter 7, 0) != Airplane Model 4 Left Over Quarter 7), PREVIOUS(Airplane Model 4 Left Over Quarter 7, 0) - Airplane Model 4 Left Over Quarter 7, 0)
V Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 7[Team] = STEP - 8
V Airplane Model 4 Planes Sold Depreciation Removed Quarter 7[Team] = Airplane Model 4 Planes Sold From Quarter 7 * Airplane Model 4 Quarters Difference Between Bought And Sold Quarter 7 * Airplane Model 4 Depreciation Rate

V Airplane Model 4 Airplanes Sold Number[Team] = Airplane Model 4 Planes Sold From Beginning + Airplane Model 4 Planes Sold From Quarter 0 + Airplane Model 4 Planes Sold From Quarter 1 + Airplane Model 4 Planes Sold From Quarter 2 + Airplane Model 4 Planes Sold From Quarter 3 + Airplane Model 4 Planes Sold From Quarter 4 + Airplane Model 4 Planes Sold From Quarter 5 + Airplane Model 4 Planes Sold From Quarter 6 + Airplane Model 4 Planes Sold From Quarter 7
V Airplane Model 4 Airplanes Sold Cost[Team] = Airplane Model 4 Airplanes Sold Number * Airplane Model 4 Purchase Cost
V Airplane Model 4 Airplanes Sold Depreciation Removed[Team] = Airplane Model 4 Planes Sold Depreciation Removed Beginning + Airplane Model 4 Planes Sold Depreciation Removed Quarter 0 + Airplane Model 4 Planes Sold Depreciation Removed Quarter 1 + Airplane Model 4 Planes Sold Depreciation Removed Quarter 2 + Airplane Model 4 Planes Sold Depreciation Removed Quarter 3 + Airplane Model 4 Planes Sold Depreciation Removed Quarter 4 + Airplane Model 4 Planes Sold Depreciation Removed Quarter 5 + Airplane Model 4 Planes Sold Depreciation Removed Quarter 6 + Airplane Model 4 Planes Sold Depreciation Removed Quarter 7
V Airplane Model 4 Airplanes Sold Book Value[Team] = Airplane Model 4 Airplanes Sold Cost - Airplane Model 4 Airplanes Sold Depreciation Removed
V Airplane Model 4 Airplanes Sold Funds From Sale[Team] = Airplane Model 4 Airplanes Sold Book Value
V Airplane Model 4 Airplanes Selling Expense[Team] = Airplane Model 4 Airplanes Sold Book Value * Fleet 0 Sale Transaction Fee Percentage

D Airplane Model 4 Selling[Team] = 0
P Airplane Model 4 Selling.ExecuteDecisionImmediately = true
P Airplane Model 4 Selling.SaveResult = true
P Airplane Model 4 Selling.ResetDecision = true
P Airplane Model 4 Selling.DecisionMin = 0
P Airplane Model 4 Selling.DecisionMax = 5

V Airplane Model 4 Actual Selling[Team] = IF(Airplane Model 4 Selling = 0, 0, IF(Airplane Model 4 Selling > PREVIOUS(Airplane Model 4 Own, 2), PREVIOUS(Airplane Model 4 Own, 2), Airplane Model 4 Selling))

D Airplane Model 4 Leasing[Team] = 0
P Airplane Model 4 Leasing.ExecuteDecisionImmediately = true
P Airplane Model 4 Leasing.SaveResult = true
P Airplane Model 4 Leasing.ResetDecision = true
P Airplane Model 4 Leasing.DecisionMin = 0
P Airplane Model 4 Leasing.DecisionMax = 5

V Airplane Model 4 Leased[Team] = PREVIOUS(Airplane Model 4 Leased, 0) + Airplane Model 4 Leasing - Airplane Model 4 Actual Cancelling

D Airplane Model 4 Cancelling[Team] = 0
P Airplane Model 4 Cancelling.ExecuteDecisionImmediately = true
P Airplane Model 4 Cancelling.SaveResult = true
P Airplane Model 4 Cancelling.ResetDecision = true
P Airplane Model 4 Cancelling.DecisionMin = 0
P Airplane Model 4 Cancelling.DecisionMax = 5

V Airplane Model 4 Actual Cancelling[Team] = IF(Airplane Model 4 Cancelling = 0, 0, IF(Airplane Model 4 Cancelling > PREVIOUS(Airplane Model 4 Leased, 0), PREVIOUS(Airplane Model 4 Leased, 0), Airplane Model 4 Cancelling))


## Airplane Model 5 ##

V Airplane Model 5 Seats = 150
V Airplane Model 5 Maximum Daily Kms = 12000
V Airplane Model 5 Cruising Kms Per Hour = 425
V Airplane Model 5 Purchase Cost  = 10000000
V Airplane Model 5 Beginning Planes = 0
V Airplane Model 5 Monthly Lease Cost = Airplane Model 5 Purchase Cost / 20 / 4 
V Airplane Model 5 Fuel Cost Per Seat Km = 0.03
V Airplane Model 5 Maintenance Cost Per Seat Km = 0.0337
V Airplane Model 5 Insurance Rate Per Seat = 66
V Airplane Model 5 Insurance Cost Per Plane = Airplane Model 5 Seats * Airplane Model 5 Insurance Rate Per Seat

V Airplane Model 5 Depreciation Per Quarter = (Airplane Model 5 Purchase Cost / Fleet Aircraft Life Expectancy) / 4
V Airplane Model 5 Depreciation Expense[Team] = Airplane Model 5 Own * Airplane Model 5 Depreciation Per Quarter
V Airplane Model 5 Depreciation Total[Team] = PREVIOUS(Airplane Model 5 Depreciation Total, 0) + Airplane Model 5 Depreciation Expense - Airplane Model 5 Airplanes Sold Depreciation Removed

V Airplane Model 5 Available Maximum Daily Kms[Team] = Airplane Model 5 Own * Airplane Model 5 Maximum Daily Kms + Airplane Model 5 Leased * Airplane Model 5 Maximum Daily Kms

V Airplane Model 5 Owned A Leased Planes[Team] = Airplane Model 5 Own + Airplane Model 5 Leased
V Airplane Model 5 Available Daily Kms[Team] = Airplane Model 5 Owned A Leased Planes * Airplane Model 5 Maximum Daily Kms
V Airplane Model 5 Seats Available[Team] = Airplane Model 5 Owned A Leased Planes * Airplane Model 5 Seats
V Airplane Model 5 Fuel Cost Per Seat Mile[Team] = Airplane Model 5 Owned A Leased Planes * Airplane Model 5 Fuel Cost Per Seat Km

D Airplane Model 5 Buying[Team] = 0
P Airplane Model 5 Buying.ExecuteDecisionImmediately = true
P Airplane Model 5 Buying.SaveResult = true
P Airplane Model 5 Buying.ResetDecision = true
P Airplane Model 5 Buying.DecisionMin = 0
P Airplane Model 5 Buying.DecisionMax = 5
V Airplane Model 5 Buying Cost[Team] = Airplane Model 5 Buying * Airplane Model 5 Purchase Cost
V Airplane Model 5 Actual Buying[Team] = IF(Fleet Acquisition Validation < 0, 0, Airplane Model 5 Buying)
V Airplane Model 5 Actual Buying Cost[Team] = Airplane Model 5 Actual Buying * Airplane Model 5 Purchase Cost

V Airplane Model 5 Own[Team] = PREVIOUS(Airplane Model 5 Own, Airplane Model 5 Beginning Planes) + IF(Fleet Acquisition Validation < 0, 0, Airplane Model 5 Buying) - Airplane Model 5 Actual Selling
V Airplane Model 5 Total Bought[Team] = PREVIOUS(Airplane Model 5 Total Bought, Airplane Model 5 Beginning Planes) + Airplane Model 5 Actual Buying 
V Airplane Model 5 Total Sold[Team] = PREVIOUS(Airplane Model 5 Total Sold, 0) + Airplane Model 5 Actual Selling

V Airplane Model 5 Bought Beginning[Team] = Airplane Model 5 Beginning Planes
V Airplane Model 5 Bought Quarter 0[Team] = REMEMBER(STEP = 0,Airplane Model 5 Actual Buying,0)
V Airplane Model 5 Bought Quarter 1[Team] = REMEMBER(STEP = 1,Airplane Model 5 Actual Buying,0)
V Airplane Model 5 Bought Quarter 2[Team] = REMEMBER(STEP = 2,Airplane Model 5 Actual Buying,0)
V Airplane Model 5 Bought Quarter 3[Team] = REMEMBER(STEP = 3,Airplane Model 5 Actual Buying,0)
V Airplane Model 5 Bought Quarter 4[Team] = REMEMBER(STEP = 4,Airplane Model 5 Actual Buying,0)
V Airplane Model 5 Bought Quarter 5[Team] = REMEMBER(STEP = 5,Airplane Model 5 Actual Buying,0)
V Airplane Model 5 Bought Quarter 6[Team] = REMEMBER(STEP = 6,Airplane Model 5 Actual Buying,0)
V Airplane Model 5 Bought Quarter 7[Team] = REMEMBER(STEP = 7,Airplane Model 5 Actual Buying,0)

V Airplane Model 5 Left Over Beginning[Team] = IF(Airplane Model 5 Bought Beginning >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Beginning - Airplane Model 5 Total Sold, 0)

V Airplane Model 5 Left Over Quarter 0[Team] = IF(Airplane Model 5 Bought Beginning >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Quarter 0, IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 - Airplane Model 5 Total Sold, 0))
V Airplane Model 5 Left Over Quarter 1[Team] = IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Quarter 1, IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 - Airplane Model 5 Total Sold, 0))
V Airplane Model 5 Left Over Quarter 2[Team] = IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Quarter 2, IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 - Airplane Model 5 Total Sold, 0))
V Airplane Model 5 Left Over Quarter 3[Team] = IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Quarter 3, IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3 - Airplane Model 5 Total Sold, 0))
V Airplane Model 5 Left Over Quarter 4[Team] = IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Quarter 4, IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3 + Airplane Model 5 Bought Quarter 4) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3 + Airplane Model 5 Bought Quarter 4 - Airplane Model 5 Total Sold, 0))
V Airplane Model 5 Left Over Quarter 5[Team] = IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3 + Airplane Model 5 Bought Quarter 4) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Quarter 5, IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3 + Airplane Model 5 Bought Quarter 4 + Airplane Model 5 Bought Quarter 5) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3 + Airplane Model 5 Bought Quarter 4 + Airplane Model 5 Bought Quarter 5 - Airplane Model 5 Total Sold, 0))
V Airplane Model 5 Left Over Quarter 6[Team] = IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3 + Airplane Model 5 Bought Quarter 4 + Airplane Model 5 Bought Quarter 5) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Quarter 6, IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3 + Airplane Model 5 Bought Quarter 4 + Airplane Model 5 Bought Quarter 5 + Airplane Model 5 Bought Quarter 6) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3 + Airplane Model 5 Bought Quarter 4 + Airplane Model 5 Bought Quarter 5 + Airplane Model 5 Bought Quarter 6 - Airplane Model 5 Total Sold, 0))
V Airplane Model 5 Left Over Quarter 7[Team] = IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3 + Airplane Model 5 Bought Quarter 4 + Airplane Model 5 Bought Quarter 5 + Airplane Model 5 Bought Quarter 6) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Quarter 7, IF((Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3 + Airplane Model 5 Bought Quarter 4 + Airplane Model 5 Bought Quarter 5 + Airplane Model 5 Bought Quarter 6 + Airplane Model 5 Bought Quarter 7) >= Airplane Model 5 Total Sold, Airplane Model 5 Bought Beginning + Airplane Model 5 Bought Quarter 0 + Airplane Model 5 Bought Quarter 1 + Airplane Model 5 Bought Quarter 2 + Airplane Model 5 Bought Quarter 3 + Airplane Model 5 Bought Quarter 4 + Airplane Model 5 Bought Quarter 5 + Airplane Model 5 Bought Quarter 6 + Airplane Model 5 Bought Quarter 7 - Airplane Model 5 Total Sold, 0))

V Airplane Model 5 Depreciation Rate = Airplane Model 5 Depreciation Per Quarter

V Airplane Model 5 Planes Sold From Beginning[Team] = IF((PREVIOUS(Airplane Model 5 Left Over Beginning, 0) > 0) & (PREVIOUS(Airplane Model 5 Left Over Beginning, 0) != Airplane Model 5 Left Over Beginning), PREVIOUS(Airplane Model 5 Left Over Beginning, 0) - Airplane Model 5 Left Over Beginning, 0)
V Airplane Model 5 Quarters Difference Between Bought And Sold Beginning[Team] = STEP - 0
V Airplane Model 5 Planes Sold Depreciation Removed Beginning[Team] = Airplane Model 5 Planes Sold From Beginning * Airplane Model 5 Quarters Difference Between Bought And Sold Beginning * Airplane Model 5 Depreciation Rate

V Airplane Model 5 Planes Sold From Quarter 0[Team] = IF((PREVIOUS(Airplane Model 5 Left Over Quarter 0, 0) > 0) & (PREVIOUS(Airplane Model 5 Left Over Quarter 0, 0) != Airplane Model 5 Left Over Quarter 0), PREVIOUS(Airplane Model 5 Left Over Quarter 0, 0) - Airplane Model 5 Left Over Quarter 0, 0)
V Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 0[Team] = STEP - 1
V Airplane Model 5 Planes Sold Depreciation Removed Quarter 0[Team] = Airplane Model 5 Planes Sold From Quarter 0 * Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 0 * Airplane Model 5 Depreciation Rate

V Airplane Model 5 Planes Sold From Quarter 1[Team] = IF((PREVIOUS(Airplane Model 5 Left Over Quarter 1, 0) > 0) & (PREVIOUS(Airplane Model 5 Left Over Quarter 1, 0) != Airplane Model 5 Left Over Quarter 1), PREVIOUS(Airplane Model 5 Left Over Quarter 1, 0) - Airplane Model 5 Left Over Quarter 1, 0)
V Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 1[Team] = STEP - 2
V Airplane Model 5 Planes Sold Depreciation Removed Quarter 1[Team] = Airplane Model 5 Planes Sold From Quarter 1 * Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 1 * Airplane Model 5 Depreciation Rate

V Airplane Model 5 Planes Sold From Quarter 2[Team] = IF((PREVIOUS(Airplane Model 5 Left Over Quarter 2, 0) > 0) & (PREVIOUS(Airplane Model 5 Left Over Quarter 2, 0) != Airplane Model 5 Left Over Quarter 2), PREVIOUS(Airplane Model 5 Left Over Quarter 2, 0) - Airplane Model 5 Left Over Quarter 2, 0)
V Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 2[Team] = STEP - 3
V Airplane Model 5 Planes Sold Depreciation Removed Quarter 2[Team] = Airplane Model 5 Planes Sold From Quarter 2 * Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 2 * Airplane Model 5 Depreciation Rate

V Airplane Model 5 Planes Sold From Quarter 3[Team] = IF((PREVIOUS(Airplane Model 5 Left Over Quarter 3, 0) > 0) & (PREVIOUS(Airplane Model 5 Left Over Quarter 3, 0) != Airplane Model 5 Left Over Quarter 3), PREVIOUS(Airplane Model 5 Left Over Quarter 3, 0) - Airplane Model 5 Left Over Quarter 3, 0)
V Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 3[Team] = STEP - 4
V Airplane Model 5 Planes Sold Depreciation Removed Quarter 3[Team] = Airplane Model 5 Planes Sold From Quarter 3 * Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 3 * Airplane Model 5 Depreciation Rate

V Airplane Model 5 Planes Sold From Quarter 4[Team] = IF((PREVIOUS(Airplane Model 5 Left Over Quarter 4, 0) > 0) & (PREVIOUS(Airplane Model 5 Left Over Quarter 4, 0) != Airplane Model 5 Left Over Quarter 4), PREVIOUS(Airplane Model 5 Left Over Quarter 4, 0) - Airplane Model 5 Left Over Quarter 4, 0)
V Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 4[Team] = STEP - 5
V Airplane Model 5 Planes Sold Depreciation Removed Quarter 4[Team] = Airplane Model 5 Planes Sold From Quarter 4 * Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 4 * Airplane Model 5 Depreciation Rate

V Airplane Model 5 Planes Sold From Quarter 5[Team] = IF((PREVIOUS(Airplane Model 5 Left Over Quarter 5, 0) > 0) & (PREVIOUS(Airplane Model 5 Left Over Quarter 5, 0) != Airplane Model 5 Left Over Quarter 5), PREVIOUS(Airplane Model 5 Left Over Quarter 5, 0) - Airplane Model 5 Left Over Quarter 5, 0)
V Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 5[Team] = STEP - 6
V Airplane Model 5 Planes Sold Depreciation Removed Quarter 5[Team] = Airplane Model 5 Planes Sold From Quarter 5 * Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 5 * Airplane Model 5 Depreciation Rate

V Airplane Model 5 Planes Sold From Quarter 6[Team] = IF((PREVIOUS(Airplane Model 5 Left Over Quarter 6, 0) > 0) & (PREVIOUS(Airplane Model 5 Left Over Quarter 6, 0) != Airplane Model 5 Left Over Quarter 6), PREVIOUS(Airplane Model 5 Left Over Quarter 6, 0) - Airplane Model 5 Left Over Quarter 6, 0)
V Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 6[Team] = STEP - 7
V Airplane Model 5 Planes Sold Depreciation Removed Quarter 6[Team] = Airplane Model 5 Planes Sold From Quarter 6 * Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 6 * Airplane Model 5 Depreciation Rate

V Airplane Model 5 Planes Sold From Quarter 7[Team] = IF((PREVIOUS(Airplane Model 5 Left Over Quarter 7, 0) > 0) & (PREVIOUS(Airplane Model 5 Left Over Quarter 7, 0) != Airplane Model 5 Left Over Quarter 7), PREVIOUS(Airplane Model 5 Left Over Quarter 7, 0) - Airplane Model 5 Left Over Quarter 7, 0)
V Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 7[Team] = STEP - 8
V Airplane Model 5 Planes Sold Depreciation Removed Quarter 7[Team] = Airplane Model 5 Planes Sold From Quarter 7 * Airplane Model 5 Quarters Difference Between Bought And Sold Quarter 7 * Airplane Model 5 Depreciation Rate

V Airplane Model 5 Airplanes Sold Number[Team] = Airplane Model 5 Planes Sold From Beginning + Airplane Model 5 Planes Sold From Quarter 0 + Airplane Model 5 Planes Sold From Quarter 1 + Airplane Model 5 Planes Sold From Quarter 2 + Airplane Model 5 Planes Sold From Quarter 3 + Airplane Model 5 Planes Sold From Quarter 4 + Airplane Model 5 Planes Sold From Quarter 5 + Airplane Model 5 Planes Sold From Quarter 6 + Airplane Model 5 Planes Sold From Quarter 7
V Airplane Model 5 Airplanes Sold Cost[Team] = Airplane Model 5 Airplanes Sold Number * Airplane Model 5 Purchase Cost
V Airplane Model 5 Airplanes Sold Depreciation Removed[Team] = Airplane Model 5 Planes Sold Depreciation Removed Beginning + Airplane Model 5 Planes Sold Depreciation Removed Quarter 0 + Airplane Model 5 Planes Sold Depreciation Removed Quarter 1 + Airplane Model 5 Planes Sold Depreciation Removed Quarter 2 + Airplane Model 5 Planes Sold Depreciation Removed Quarter 3 + Airplane Model 5 Planes Sold Depreciation Removed Quarter 4 + Airplane Model 5 Planes Sold Depreciation Removed Quarter 5 + Airplane Model 5 Planes Sold Depreciation Removed Quarter 6 + Airplane Model 5 Planes Sold Depreciation Removed Quarter 7
V Airplane Model 5 Airplanes Sold Book Value[Team] = Airplane Model 5 Airplanes Sold Cost - Airplane Model 5 Airplanes Sold Depreciation Removed
V Airplane Model 5 Airplanes Sold Funds From Sale[Team] = Airplane Model 5 Airplanes Sold Book Value
V Airplane Model 5 Airplanes Selling Expense[Team] = Airplane Model 5 Airplanes Sold Book Value * Fleet 0 Sale Transaction Fee Percentage

D Airplane Model 5 Selling[Team] = 0
P Airplane Model 5 Selling.ExecuteDecisionImmediately = true
P Airplane Model 5 Selling.SaveResult = true
P Airplane Model 5 Selling.ResetDecision = true
P Airplane Model 5 Selling.DecisionMin = 0
P Airplane Model 5 Selling.DecisionMax = 5

V Airplane Model 5 Actual Selling[Team] = IF(Airplane Model 5 Selling = 0, 0, IF(Airplane Model 5 Selling > PREVIOUS(Airplane Model 5 Own, 2), PREVIOUS(Airplane Model 5 Own, 2), Airplane Model 5 Selling))

D Airplane Model 5 Leasing[Team] = 0
P Airplane Model 5 Leasing.ExecuteDecisionImmediately = true
P Airplane Model 5 Leasing.SaveResult = true
P Airplane Model 5 Leasing.ResetDecision = true
P Airplane Model 5 Leasing.DecisionMin = 0
P Airplane Model 5 Leasing.DecisionMax = 5

V Airplane Model 5 Leased[Team] = PREVIOUS(Airplane Model 5 Leased, 0) + Airplane Model 5 Leasing - Airplane Model 5 Actual Cancelling

D Airplane Model 5 Cancelling[Team] = 0
P Airplane Model 5 Cancelling.ExecuteDecisionImmediately = true
P Airplane Model 5 Cancelling.SaveResult = true
P Airplane Model 5 Cancelling.ResetDecision = true
P Airplane Model 5 Cancelling.DecisionMin = 0
P Airplane Model 5 Cancelling.DecisionMax = 5

V Airplane Model 5 Actual Cancelling[Team] = IF(Airplane Model 5 Cancelling = 0, 0, IF(Airplane Model 5 Cancelling > PREVIOUS(Airplane Model 5 Leased, 0), PREVIOUS(Airplane Model 5 Leased, 0), Airplane Model 5 Cancelling))


## Airplane Model 6 ##

V Airplane Model 6 Seats = 180
V Airplane Model 6 Maximum Daily Kms = 15000
V Airplane Model 6 Cruising Kms Per Hour = 425
V Airplane Model 6 Purchase Cost  = 12500000
V Airplane Model 6 Beginning Planes = 0
V Airplane Model 6 Monthly Lease Cost = Airplane Model 6 Purchase Cost / 20 / 4 
V Airplane Model 6 Fuel Cost Per Seat Km = 0.03
V Airplane Model 6 Maintenance Cost Per Seat Km = 0.0337
V Airplane Model 6 Insurance Rate Per Seat = 66
V Airplane Model 6 Insurance Cost Per Plane = Airplane Model 6 Seats * Airplane Model 6 Insurance Rate Per Seat

V Airplane Model 6 Depreciation Per Quarter = (Airplane Model 6 Purchase Cost / Fleet Aircraft Life Expectancy) / 4
V Airplane Model 6 Depreciation Expense[Team] = Airplane Model 6 Own * Airplane Model 6 Depreciation Per Quarter
V Airplane Model 6 Depreciation Total[Team] = PREVIOUS(Airplane Model 6 Depreciation Total, 0) + Airplane Model 6 Depreciation Expense - Airplane Model 6 Airplanes Sold Depreciation Removed

V Airplane Model 6 Available Maximum Daily Kms[Team] = Airplane Model 6 Own * Airplane Model 6 Maximum Daily Kms + Airplane Model 6 Leased * Airplane Model 6 Maximum Daily Kms

V Airplane Model 6 Owned A Leased Planes[Team] = Airplane Model 6 Own + Airplane Model 6 Leased
V Airplane Model 6 Available Daily Kms[Team] = Airplane Model 6 Owned A Leased Planes * Airplane Model 6 Maximum Daily Kms
V Airplane Model 6 Seats Available[Team] = Airplane Model 6 Owned A Leased Planes * Airplane Model 6 Seats
V Airplane Model 6 Fuel Cost Per Seat Mile[Team] = Airplane Model 6 Owned A Leased Planes * Airplane Model 6 Fuel Cost Per Seat Km

D Airplane Model 6 Buying[Team] = 0
P Airplane Model 6 Buying.ExecuteDecisionImmediately = true
P Airplane Model 6 Buying.SaveResult = true
P Airplane Model 6 Buying.ResetDecision = true
P Airplane Model 6 Buying.DecisionMin = 0
P Airplane Model 6 Buying.DecisionMax = 5
V Airplane Model 6 Buying Cost[Team] = Airplane Model 6 Buying * Airplane Model 6 Purchase Cost
V Airplane Model 6 Actual Buying[Team] = IF(Fleet Acquisition Validation < 0, 0, Airplane Model 6 Buying)
V Airplane Model 6 Actual Buying Cost[Team] = Airplane Model 6 Actual Buying * Airplane Model 6 Purchase Cost

V Airplane Model 6 Own[Team] = PREVIOUS(Airplane Model 6 Own, Airplane Model 6 Beginning Planes) + IF(Fleet Acquisition Validation < 0, 0, Airplane Model 6 Buying) - Airplane Model 6 Actual Selling
V Airplane Model 6 Total Bought[Team] = PREVIOUS(Airplane Model 6 Total Bought, Airplane Model 6 Beginning Planes) + Airplane Model 6 Actual Buying 
V Airplane Model 6 Total Sold[Team] = PREVIOUS(Airplane Model 6 Total Sold, 0) + Airplane Model 6 Actual Selling

V Airplane Model 6 Bought Beginning[Team] = Airplane Model 6 Beginning Planes
V Airplane Model 6 Bought Quarter 0[Team] = REMEMBER(STEP = 0,Airplane Model 6 Actual Buying,0)
V Airplane Model 6 Bought Quarter 1[Team] = REMEMBER(STEP = 1,Airplane Model 6 Actual Buying,0)
V Airplane Model 6 Bought Quarter 2[Team] = REMEMBER(STEP = 2,Airplane Model 6 Actual Buying,0)
V Airplane Model 6 Bought Quarter 3[Team] = REMEMBER(STEP = 3,Airplane Model 6 Actual Buying,0)
V Airplane Model 6 Bought Quarter 4[Team] = REMEMBER(STEP = 4,Airplane Model 6 Actual Buying,0)
V Airplane Model 6 Bought Quarter 5[Team] = REMEMBER(STEP = 5,Airplane Model 6 Actual Buying,0)
V Airplane Model 6 Bought Quarter 6[Team] = REMEMBER(STEP = 6,Airplane Model 6 Actual Buying,0)
V Airplane Model 6 Bought Quarter 7[Team] = REMEMBER(STEP = 7,Airplane Model 6 Actual Buying,0)

V Airplane Model 6 Left Over Beginning[Team] = IF(Airplane Model 6 Bought Beginning >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Beginning - Airplane Model 6 Total Sold, 0)

V Airplane Model 6 Left Over Quarter 0[Team] = IF(Airplane Model 6 Bought Beginning >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Quarter 0, IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 - Airplane Model 6 Total Sold, 0))
V Airplane Model 6 Left Over Quarter 1[Team] = IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Quarter 1, IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 - Airplane Model 6 Total Sold, 0))
V Airplane Model 6 Left Over Quarter 2[Team] = IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Quarter 2, IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 - Airplane Model 6 Total Sold, 0))
V Airplane Model 6 Left Over Quarter 3[Team] = IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Quarter 3, IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3 - Airplane Model 6 Total Sold, 0))
V Airplane Model 6 Left Over Quarter 4[Team] = IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Quarter 4, IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3 + Airplane Model 6 Bought Quarter 4) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3 + Airplane Model 6 Bought Quarter 4 - Airplane Model 6 Total Sold, 0))
V Airplane Model 6 Left Over Quarter 5[Team] = IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3 + Airplane Model 6 Bought Quarter 4) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Quarter 5, IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3 + Airplane Model 6 Bought Quarter 4 + Airplane Model 6 Bought Quarter 5) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3 + Airplane Model 6 Bought Quarter 4 + Airplane Model 6 Bought Quarter 5 - Airplane Model 6 Total Sold, 0))
V Airplane Model 6 Left Over Quarter 6[Team] = IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3 + Airplane Model 6 Bought Quarter 4 + Airplane Model 6 Bought Quarter 5) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Quarter 6, IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3 + Airplane Model 6 Bought Quarter 4 + Airplane Model 6 Bought Quarter 5 + Airplane Model 6 Bought Quarter 6) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3 + Airplane Model 6 Bought Quarter 4 + Airplane Model 6 Bought Quarter 5 + Airplane Model 6 Bought Quarter 6 - Airplane Model 6 Total Sold, 0))
V Airplane Model 6 Left Over Quarter 7[Team] = IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3 + Airplane Model 6 Bought Quarter 4 + Airplane Model 6 Bought Quarter 5 + Airplane Model 6 Bought Quarter 6) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Quarter 7, IF((Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3 + Airplane Model 6 Bought Quarter 4 + Airplane Model 6 Bought Quarter 5 + Airplane Model 6 Bought Quarter 6 + Airplane Model 6 Bought Quarter 7) >= Airplane Model 6 Total Sold, Airplane Model 6 Bought Beginning + Airplane Model 6 Bought Quarter 0 + Airplane Model 6 Bought Quarter 1 + Airplane Model 6 Bought Quarter 2 + Airplane Model 6 Bought Quarter 3 + Airplane Model 6 Bought Quarter 4 + Airplane Model 6 Bought Quarter 5 + Airplane Model 6 Bought Quarter 6 + Airplane Model 6 Bought Quarter 7 - Airplane Model 6 Total Sold, 0))

V Airplane Model 6 Depreciation Rate = Airplane Model 6 Depreciation Per Quarter

V Airplane Model 6 Planes Sold From Beginning[Team] = IF((PREVIOUS(Airplane Model 6 Left Over Beginning, 0) > 0) & (PREVIOUS(Airplane Model 6 Left Over Beginning, 0) != Airplane Model 6 Left Over Beginning), PREVIOUS(Airplane Model 6 Left Over Beginning, 0) - Airplane Model 6 Left Over Beginning, 0)
V Airplane Model 6 Quarters Difference Between Bought And Sold Beginning[Team] = STEP - 0
V Airplane Model 6 Planes Sold Depreciation Removed Beginning[Team] = Airplane Model 6 Planes Sold From Beginning * Airplane Model 6 Quarters Difference Between Bought And Sold Beginning * Airplane Model 6 Depreciation Rate

V Airplane Model 6 Planes Sold From Quarter 0[Team] = IF((PREVIOUS(Airplane Model 6 Left Over Quarter 0, 0) > 0) & (PREVIOUS(Airplane Model 6 Left Over Quarter 0, 0) != Airplane Model 6 Left Over Quarter 0), PREVIOUS(Airplane Model 6 Left Over Quarter 0, 0) - Airplane Model 6 Left Over Quarter 0, 0)
V Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 0[Team] = STEP - 1
V Airplane Model 6 Planes Sold Depreciation Removed Quarter 0[Team] = Airplane Model 6 Planes Sold From Quarter 0 * Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 0 * Airplane Model 6 Depreciation Rate

V Airplane Model 6 Planes Sold From Quarter 1[Team] = IF((PREVIOUS(Airplane Model 6 Left Over Quarter 1, 0) > 0) & (PREVIOUS(Airplane Model 6 Left Over Quarter 1, 0) != Airplane Model 6 Left Over Quarter 1), PREVIOUS(Airplane Model 6 Left Over Quarter 1, 0) - Airplane Model 6 Left Over Quarter 1, 0)
V Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 1[Team] = STEP - 2
V Airplane Model 6 Planes Sold Depreciation Removed Quarter 1[Team] = Airplane Model 6 Planes Sold From Quarter 1 * Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 1 * Airplane Model 6 Depreciation Rate

V Airplane Model 6 Planes Sold From Quarter 2[Team] = IF((PREVIOUS(Airplane Model 6 Left Over Quarter 2, 0) > 0) & (PREVIOUS(Airplane Model 6 Left Over Quarter 2, 0) != Airplane Model 6 Left Over Quarter 2), PREVIOUS(Airplane Model 6 Left Over Quarter 2, 0) - Airplane Model 6 Left Over Quarter 2, 0)
V Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 2[Team] = STEP - 3
V Airplane Model 6 Planes Sold Depreciation Removed Quarter 2[Team] = Airplane Model 6 Planes Sold From Quarter 2 * Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 2 * Airplane Model 6 Depreciation Rate

V Airplane Model 6 Planes Sold From Quarter 3[Team] = IF((PREVIOUS(Airplane Model 6 Left Over Quarter 3, 0) > 0) & (PREVIOUS(Airplane Model 6 Left Over Quarter 3, 0) != Airplane Model 6 Left Over Quarter 3), PREVIOUS(Airplane Model 6 Left Over Quarter 3, 0) - Airplane Model 6 Left Over Quarter 3, 0)
V Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 3[Team] = STEP - 4
V Airplane Model 6 Planes Sold Depreciation Removed Quarter 3[Team] = Airplane Model 6 Planes Sold From Quarter 3 * Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 3 * Airplane Model 6 Depreciation Rate

V Airplane Model 6 Planes Sold From Quarter 4[Team] = IF((PREVIOUS(Airplane Model 6 Left Over Quarter 4, 0) > 0) & (PREVIOUS(Airplane Model 6 Left Over Quarter 4, 0) != Airplane Model 6 Left Over Quarter 4), PREVIOUS(Airplane Model 6 Left Over Quarter 4, 0) - Airplane Model 6 Left Over Quarter 4, 0)
V Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 4[Team] = STEP - 5
V Airplane Model 6 Planes Sold Depreciation Removed Quarter 4[Team] = Airplane Model 6 Planes Sold From Quarter 4 * Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 4 * Airplane Model 6 Depreciation Rate

V Airplane Model 6 Planes Sold From Quarter 5[Team] = IF((PREVIOUS(Airplane Model 6 Left Over Quarter 5, 0) > 0) & (PREVIOUS(Airplane Model 6 Left Over Quarter 5, 0) != Airplane Model 6 Left Over Quarter 5), PREVIOUS(Airplane Model 6 Left Over Quarter 5, 0) - Airplane Model 6 Left Over Quarter 5, 0)
V Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 5[Team] = STEP - 6
V Airplane Model 6 Planes Sold Depreciation Removed Quarter 5[Team] = Airplane Model 6 Planes Sold From Quarter 5 * Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 5 * Airplane Model 6 Depreciation Rate

V Airplane Model 6 Planes Sold From Quarter 6[Team] = IF((PREVIOUS(Airplane Model 6 Left Over Quarter 6, 0) > 0) & (PREVIOUS(Airplane Model 6 Left Over Quarter 6, 0) != Airplane Model 6 Left Over Quarter 6), PREVIOUS(Airplane Model 6 Left Over Quarter 6, 0) - Airplane Model 6 Left Over Quarter 6, 0)
V Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 6[Team] = STEP - 7
V Airplane Model 6 Planes Sold Depreciation Removed Quarter 6[Team] = Airplane Model 6 Planes Sold From Quarter 6 * Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 6 * Airplane Model 6 Depreciation Rate

V Airplane Model 6 Planes Sold From Quarter 7[Team] = IF((PREVIOUS(Airplane Model 6 Left Over Quarter 7, 0) > 0) & (PREVIOUS(Airplane Model 6 Left Over Quarter 7, 0) != Airplane Model 6 Left Over Quarter 7), PREVIOUS(Airplane Model 6 Left Over Quarter 7, 0) - Airplane Model 6 Left Over Quarter 7, 0)
V Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 7[Team] = STEP - 8
V Airplane Model 6 Planes Sold Depreciation Removed Quarter 7[Team] = Airplane Model 6 Planes Sold From Quarter 7 * Airplane Model 6 Quarters Difference Between Bought And Sold Quarter 7 * Airplane Model 6 Depreciation Rate

V Airplane Model 6 Airplanes Sold Number[Team] = Airplane Model 6 Planes Sold From Beginning + Airplane Model 6 Planes Sold From Quarter 0 + Airplane Model 6 Planes Sold From Quarter 1 + Airplane Model 6 Planes Sold From Quarter 2 + Airplane Model 6 Planes Sold From Quarter 3 + Airplane Model 6 Planes Sold From Quarter 4 + Airplane Model 6 Planes Sold From Quarter 5 + Airplane Model 6 Planes Sold From Quarter 6 + Airplane Model 6 Planes Sold From Quarter 7
V Airplane Model 6 Airplanes Sold Cost[Team] = Airplane Model 6 Airplanes Sold Number * Airplane Model 6 Purchase Cost
V Airplane Model 6 Airplanes Sold Depreciation Removed[Team] = Airplane Model 6 Planes Sold Depreciation Removed Beginning + Airplane Model 6 Planes Sold Depreciation Removed Quarter 0 + Airplane Model 6 Planes Sold Depreciation Removed Quarter 1 + Airplane Model 6 Planes Sold Depreciation Removed Quarter 2 + Airplane Model 6 Planes Sold Depreciation Removed Quarter 3 + Airplane Model 6 Planes Sold Depreciation Removed Quarter 4 + Airplane Model 6 Planes Sold Depreciation Removed Quarter 5 + Airplane Model 6 Planes Sold Depreciation Removed Quarter 6 + Airplane Model 6 Planes Sold Depreciation Removed Quarter 7
V Airplane Model 6 Airplanes Sold Book Value[Team] = Airplane Model 6 Airplanes Sold Cost - Airplane Model 6 Airplanes Sold Depreciation Removed
V Airplane Model 6 Airplanes Sold Funds From Sale[Team] = Airplane Model 6 Airplanes Sold Book Value
V Airplane Model 6 Airplanes Selling Expense[Team] = Airplane Model 6 Airplanes Sold Book Value * Fleet 0 Sale Transaction Fee Percentage

D Airplane Model 6 Selling[Team] = 0
P Airplane Model 6 Selling.ExecuteDecisionImmediately = true
P Airplane Model 6 Selling.SaveResult = true
P Airplane Model 6 Selling.ResetDecision = true
P Airplane Model 6 Selling.DecisionMin = 0
P Airplane Model 6 Selling.DecisionMax = 5

V Airplane Model 6 Actual Selling[Team] = IF(Airplane Model 6 Selling = 0, 0, IF(Airplane Model 6 Selling > PREVIOUS(Airplane Model 6 Own, 2), PREVIOUS(Airplane Model 6 Own, 2), Airplane Model 6 Selling))

D Airplane Model 6 Leasing[Team] = 0
P Airplane Model 6 Leasing.ExecuteDecisionImmediately = true
P Airplane Model 6 Leasing.SaveResult = true
P Airplane Model 6 Leasing.ResetDecision = true
P Airplane Model 6 Leasing.DecisionMin = 0
P Airplane Model 6 Leasing.DecisionMax = 5

V Airplane Model 6 Leased[Team] = PREVIOUS(Airplane Model 6 Leased, 0) + Airplane Model 6 Leasing - Airplane Model 6 Actual Cancelling

D Airplane Model 6 Cancelling[Team] = 0
P Airplane Model 6 Cancelling.ExecuteDecisionImmediately = true
P Airplane Model 6 Cancelling.SaveResult = true
P Airplane Model 6 Cancelling.ResetDecision = true
P Airplane Model 6 Cancelling.DecisionMin = 0
P Airplane Model 6 Cancelling.DecisionMax = 5

V Airplane Model 6 Actual Cancelling[Team] = IF(Airplane Model 6 Cancelling = 0, 0, IF(Airplane Model 6 Cancelling > PREVIOUS(Airplane Model 6 Leased, 0), PREVIOUS(Airplane Model 6 Leased, 0), Airplane Model 6 Cancelling))


## Airplane Model 7 ##

V Airplane Model 7 Seats = 100
V Airplane Model 7 Maximum Daily Kms = 15000
V Airplane Model 7 Cruising Kms Per Hour = 425
V Airplane Model 7 Purchase Cost  = 15000000
V Airplane Model 7 Beginning Planes = 0
V Airplane Model 7 Monthly Lease Cost = Airplane Model 7 Purchase Cost / 20 / 4 
V Airplane Model 7 Fuel Cost Per Seat Km = 0.03
V Airplane Model 7 Maintenance Cost Per Seat Km = 0.0337
V Airplane Model 7 Insurance Rate Per Seat = 66
V Airplane Model 7 Insurance Cost Per Plane = Airplane Model 7 Seats * Airplane Model 7 Insurance Rate Per Seat

V Airplane Model 7 Depreciation Per Quarter = (Airplane Model 7 Purchase Cost / Fleet Aircraft Life Expectancy) / 4
V Airplane Model 7 Depreciation Expense[Team] = Airplane Model 7 Own * Airplane Model 7 Depreciation Per Quarter
V Airplane Model 7 Depreciation Total[Team] = PREVIOUS(Airplane Model 7 Depreciation Total, 0) + Airplane Model 7 Depreciation Expense - Airplane Model 7 Airplanes Sold Depreciation Removed

V Airplane Model 7 Available Maximum Daily Kms[Team] = Airplane Model 7 Own * Airplane Model 7 Maximum Daily Kms + Airplane Model 7 Leased * Airplane Model 7 Maximum Daily Kms

V Airplane Model 7 Owned A Leased Planes[Team] = Airplane Model 7 Own + Airplane Model 7 Leased
V Airplane Model 7 Available Daily Kms[Team] = Airplane Model 7 Owned A Leased Planes * Airplane Model 7 Maximum Daily Kms
V Airplane Model 7 Seats Available[Team] = Airplane Model 7 Owned A Leased Planes * Airplane Model 7 Seats
V Airplane Model 7 Fuel Cost Per Seat Mile[Team] = Airplane Model 7 Owned A Leased Planes * Airplane Model 7 Fuel Cost Per Seat Km

D Airplane Model 7 Buying[Team] = 0
P Airplane Model 7 Buying.ExecuteDecisionImmediately = true
P Airplane Model 7 Buying.SaveResult = true
P Airplane Model 7 Buying.ResetDecision = true
P Airplane Model 7 Buying.DecisionMin = 0
P Airplane Model 7 Buying.DecisionMax = 5
V Airplane Model 7 Buying Cost[Team] = Airplane Model 7 Buying * Airplane Model 7 Purchase Cost
V Airplane Model 7 Actual Buying[Team] = IF(Fleet Acquisition Validation < 0, 0, Airplane Model 7 Buying)
V Airplane Model 7 Actual Buying Cost[Team] = Airplane Model 7 Actual Buying * Airplane Model 7 Purchase Cost

V Airplane Model 7 Own[Team] = PREVIOUS(Airplane Model 7 Own, Airplane Model 7 Beginning Planes) + IF(Fleet Acquisition Validation < 0, 0, Airplane Model 7 Buying) - Airplane Model 7 Actual Selling
V Airplane Model 7 Total Bought[Team] = PREVIOUS(Airplane Model 7 Total Bought, Airplane Model 7 Beginning Planes) + Airplane Model 7 Actual Buying 
V Airplane Model 7 Total Sold[Team] = PREVIOUS(Airplane Model 7 Total Sold, 0) + Airplane Model 7 Actual Selling

V Airplane Model 7 Bought Beginning[Team] = Airplane Model 7 Beginning Planes
V Airplane Model 7 Bought Quarter 0[Team] = REMEMBER(STEP = 0,Airplane Model 7 Actual Buying,0)
V Airplane Model 7 Bought Quarter 1[Team] = REMEMBER(STEP = 1,Airplane Model 7 Actual Buying,0)
V Airplane Model 7 Bought Quarter 2[Team] = REMEMBER(STEP = 2,Airplane Model 7 Actual Buying,0)
V Airplane Model 7 Bought Quarter 3[Team] = REMEMBER(STEP = 3,Airplane Model 7 Actual Buying,0)
V Airplane Model 7 Bought Quarter 4[Team] = REMEMBER(STEP = 4,Airplane Model 7 Actual Buying,0)
V Airplane Model 7 Bought Quarter 5[Team] = REMEMBER(STEP = 5,Airplane Model 7 Actual Buying,0)
V Airplane Model 7 Bought Quarter 6[Team] = REMEMBER(STEP = 6,Airplane Model 7 Actual Buying,0)
V Airplane Model 7 Bought Quarter 7[Team] = REMEMBER(STEP = 7,Airplane Model 7 Actual Buying,0)

V Airplane Model 7 Left Over Beginning[Team] = IF(Airplane Model 7 Bought Beginning >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Beginning - Airplane Model 7 Total Sold, 0)

V Airplane Model 7 Left Over Quarter 0[Team] = IF(Airplane Model 7 Bought Beginning >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Quarter 0, IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 - Airplane Model 7 Total Sold, 0))
V Airplane Model 7 Left Over Quarter 1[Team] = IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Quarter 1, IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 - Airplane Model 7 Total Sold, 0))
V Airplane Model 7 Left Over Quarter 2[Team] = IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Quarter 2, IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 - Airplane Model 7 Total Sold, 0))
V Airplane Model 7 Left Over Quarter 3[Team] = IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Quarter 3, IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3 - Airplane Model 7 Total Sold, 0))
V Airplane Model 7 Left Over Quarter 4[Team] = IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Quarter 4, IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3 + Airplane Model 7 Bought Quarter 4) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3 + Airplane Model 7 Bought Quarter 4 - Airplane Model 7 Total Sold, 0))
V Airplane Model 7 Left Over Quarter 5[Team] = IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3 + Airplane Model 7 Bought Quarter 4) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Quarter 5, IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3 + Airplane Model 7 Bought Quarter 4 + Airplane Model 7 Bought Quarter 5) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3 + Airplane Model 7 Bought Quarter 4 + Airplane Model 7 Bought Quarter 5 - Airplane Model 7 Total Sold, 0))
V Airplane Model 7 Left Over Quarter 6[Team] = IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3 + Airplane Model 7 Bought Quarter 4 + Airplane Model 7 Bought Quarter 5) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Quarter 6, IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3 + Airplane Model 7 Bought Quarter 4 + Airplane Model 7 Bought Quarter 5 + Airplane Model 7 Bought Quarter 6) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3 + Airplane Model 7 Bought Quarter 4 + Airplane Model 7 Bought Quarter 5 + Airplane Model 7 Bought Quarter 6 - Airplane Model 7 Total Sold, 0))
V Airplane Model 7 Left Over Quarter 7[Team] = IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3 + Airplane Model 7 Bought Quarter 4 + Airplane Model 7 Bought Quarter 5 + Airplane Model 7 Bought Quarter 6) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Quarter 7, IF((Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3 + Airplane Model 7 Bought Quarter 4 + Airplane Model 7 Bought Quarter 5 + Airplane Model 7 Bought Quarter 6 + Airplane Model 7 Bought Quarter 7) >= Airplane Model 7 Total Sold, Airplane Model 7 Bought Beginning + Airplane Model 7 Bought Quarter 0 + Airplane Model 7 Bought Quarter 1 + Airplane Model 7 Bought Quarter 2 + Airplane Model 7 Bought Quarter 3 + Airplane Model 7 Bought Quarter 4 + Airplane Model 7 Bought Quarter 5 + Airplane Model 7 Bought Quarter 6 + Airplane Model 7 Bought Quarter 7 - Airplane Model 7 Total Sold, 0))

V Airplane Model 7 Depreciation Rate = Airplane Model 7 Depreciation Per Quarter

V Airplane Model 7 Planes Sold From Beginning[Team] = IF((PREVIOUS(Airplane Model 7 Left Over Beginning, 0) > 0) & (PREVIOUS(Airplane Model 7 Left Over Beginning, 0) != Airplane Model 7 Left Over Beginning), PREVIOUS(Airplane Model 7 Left Over Beginning, 0) - Airplane Model 7 Left Over Beginning, 0)
V Airplane Model 7 Quarters Difference Between Bought And Sold Beginning[Team] = STEP - 0
V Airplane Model 7 Planes Sold Depreciation Removed Beginning[Team] = Airplane Model 7 Planes Sold From Beginning * Airplane Model 7 Quarters Difference Between Bought And Sold Beginning * Airplane Model 7 Depreciation Rate

V Airplane Model 7 Planes Sold From Quarter 0[Team] = IF((PREVIOUS(Airplane Model 7 Left Over Quarter 0, 0) > 0) & (PREVIOUS(Airplane Model 7 Left Over Quarter 0, 0) != Airplane Model 7 Left Over Quarter 0), PREVIOUS(Airplane Model 7 Left Over Quarter 0, 0) - Airplane Model 7 Left Over Quarter 0, 0)
V Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 0[Team] = STEP - 1
V Airplane Model 7 Planes Sold Depreciation Removed Quarter 0[Team] = Airplane Model 7 Planes Sold From Quarter 0 * Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 0 * Airplane Model 7 Depreciation Rate

V Airplane Model 7 Planes Sold From Quarter 1[Team] = IF((PREVIOUS(Airplane Model 7 Left Over Quarter 1, 0) > 0) & (PREVIOUS(Airplane Model 7 Left Over Quarter 1, 0) != Airplane Model 7 Left Over Quarter 1), PREVIOUS(Airplane Model 7 Left Over Quarter 1, 0) - Airplane Model 7 Left Over Quarter 1, 0)
V Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 1[Team] = STEP - 2
V Airplane Model 7 Planes Sold Depreciation Removed Quarter 1[Team] = Airplane Model 7 Planes Sold From Quarter 1 * Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 1 * Airplane Model 7 Depreciation Rate

V Airplane Model 7 Planes Sold From Quarter 2[Team] = IF((PREVIOUS(Airplane Model 7 Left Over Quarter 2, 0) > 0) & (PREVIOUS(Airplane Model 7 Left Over Quarter 2, 0) != Airplane Model 7 Left Over Quarter 2), PREVIOUS(Airplane Model 7 Left Over Quarter 2, 0) - Airplane Model 7 Left Over Quarter 2, 0)
V Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 2[Team] = STEP - 3
V Airplane Model 7 Planes Sold Depreciation Removed Quarter 2[Team] = Airplane Model 7 Planes Sold From Quarter 2 * Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 2 * Airplane Model 7 Depreciation Rate

V Airplane Model 7 Planes Sold From Quarter 3[Team] = IF((PREVIOUS(Airplane Model 7 Left Over Quarter 3, 0) > 0) & (PREVIOUS(Airplane Model 7 Left Over Quarter 3, 0) != Airplane Model 7 Left Over Quarter 3), PREVIOUS(Airplane Model 7 Left Over Quarter 3, 0) - Airplane Model 7 Left Over Quarter 3, 0)
V Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 3[Team] = STEP - 4
V Airplane Model 7 Planes Sold Depreciation Removed Quarter 3[Team] = Airplane Model 7 Planes Sold From Quarter 3 * Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 3 * Airplane Model 7 Depreciation Rate

V Airplane Model 7 Planes Sold From Quarter 4[Team] = IF((PREVIOUS(Airplane Model 7 Left Over Quarter 4, 0) > 0) & (PREVIOUS(Airplane Model 7 Left Over Quarter 4, 0) != Airplane Model 7 Left Over Quarter 4), PREVIOUS(Airplane Model 7 Left Over Quarter 4, 0) - Airplane Model 7 Left Over Quarter 4, 0)
V Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 4[Team] = STEP - 5
V Airplane Model 7 Planes Sold Depreciation Removed Quarter 4[Team] = Airplane Model 7 Planes Sold From Quarter 4 * Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 4 * Airplane Model 7 Depreciation Rate

V Airplane Model 7 Planes Sold From Quarter 5[Team] = IF((PREVIOUS(Airplane Model 7 Left Over Quarter 5, 0) > 0) & (PREVIOUS(Airplane Model 7 Left Over Quarter 5, 0) != Airplane Model 7 Left Over Quarter 5), PREVIOUS(Airplane Model 7 Left Over Quarter 5, 0) - Airplane Model 7 Left Over Quarter 5, 0)
V Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 5[Team] = STEP - 6
V Airplane Model 7 Planes Sold Depreciation Removed Quarter 5[Team] = Airplane Model 7 Planes Sold From Quarter 5 * Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 5 * Airplane Model 7 Depreciation Rate

V Airplane Model 7 Planes Sold From Quarter 6[Team] = IF((PREVIOUS(Airplane Model 7 Left Over Quarter 6, 0) > 0) & (PREVIOUS(Airplane Model 7 Left Over Quarter 6, 0) != Airplane Model 7 Left Over Quarter 6), PREVIOUS(Airplane Model 7 Left Over Quarter 6, 0) - Airplane Model 7 Left Over Quarter 6, 0)
V Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 6[Team] = STEP - 7
V Airplane Model 7 Planes Sold Depreciation Removed Quarter 6[Team] = Airplane Model 7 Planes Sold From Quarter 6 * Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 6 * Airplane Model 7 Depreciation Rate

V Airplane Model 7 Planes Sold From Quarter 7[Team] = IF((PREVIOUS(Airplane Model 7 Left Over Quarter 7, 0) > 0) & (PREVIOUS(Airplane Model 7 Left Over Quarter 7, 0) != Airplane Model 7 Left Over Quarter 7), PREVIOUS(Airplane Model 7 Left Over Quarter 7, 0) - Airplane Model 7 Left Over Quarter 7, 0)
V Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 7[Team] = STEP - 8
V Airplane Model 7 Planes Sold Depreciation Removed Quarter 7[Team] = Airplane Model 7 Planes Sold From Quarter 7 * Airplane Model 7 Quarters Difference Between Bought And Sold Quarter 7 * Airplane Model 7 Depreciation Rate

V Airplane Model 7 Airplanes Sold Number[Team] = Airplane Model 7 Planes Sold From Beginning + Airplane Model 7 Planes Sold From Quarter 0 + Airplane Model 7 Planes Sold From Quarter 1 + Airplane Model 7 Planes Sold From Quarter 2 + Airplane Model 7 Planes Sold From Quarter 3 + Airplane Model 7 Planes Sold From Quarter 4 + Airplane Model 7 Planes Sold From Quarter 5 + Airplane Model 7 Planes Sold From Quarter 6 + Airplane Model 7 Planes Sold From Quarter 7
V Airplane Model 7 Airplanes Sold Cost[Team] = Airplane Model 7 Airplanes Sold Number * Airplane Model 7 Purchase Cost
V Airplane Model 7 Airplanes Sold Depreciation Removed[Team] = Airplane Model 7 Planes Sold Depreciation Removed Beginning + Airplane Model 7 Planes Sold Depreciation Removed Quarter 0 + Airplane Model 7 Planes Sold Depreciation Removed Quarter 1 + Airplane Model 7 Planes Sold Depreciation Removed Quarter 2 + Airplane Model 7 Planes Sold Depreciation Removed Quarter 3 + Airplane Model 7 Planes Sold Depreciation Removed Quarter 4 + Airplane Model 7 Planes Sold Depreciation Removed Quarter 5 + Airplane Model 7 Planes Sold Depreciation Removed Quarter 6 + Airplane Model 7 Planes Sold Depreciation Removed Quarter 7
V Airplane Model 7 Airplanes Sold Book Value[Team] = Airplane Model 7 Airplanes Sold Cost - Airplane Model 7 Airplanes Sold Depreciation Removed
V Airplane Model 7 Airplanes Sold Funds From Sale[Team] = Airplane Model 7 Airplanes Sold Book Value
V Airplane Model 7 Airplanes Selling Expense[Team] = Airplane Model 7 Airplanes Sold Book Value * Fleet 0 Sale Transaction Fee Percentage

D Airplane Model 7 Selling[Team] = 0
P Airplane Model 7 Selling.ExecuteDecisionImmediately = true
P Airplane Model 7 Selling.SaveResult = true
P Airplane Model 7 Selling.ResetDecision = true
P Airplane Model 7 Selling.DecisionMin = 0
P Airplane Model 7 Selling.DecisionMax = 5

V Airplane Model 7 Actual Selling[Team] = IF(Airplane Model 7 Selling = 0, 0, IF(Airplane Model 7 Selling > PREVIOUS(Airplane Model 7 Own, 2), PREVIOUS(Airplane Model 7 Own, 2), Airplane Model 7 Selling))

D Airplane Model 7 Leasing[Team] = 0
P Airplane Model 7 Leasing.ExecuteDecisionImmediately = true
P Airplane Model 7 Leasing.SaveResult = true
P Airplane Model 7 Leasing.ResetDecision = true
P Airplane Model 7 Leasing.DecisionMin = 0
P Airplane Model 7 Leasing.DecisionMax = 5

V Airplane Model 7 Leased[Team] = PREVIOUS(Airplane Model 7 Leased, 0) + Airplane Model 7 Leasing - Airplane Model 7 Actual Cancelling

D Airplane Model 7 Cancelling[Team] = 0
P Airplane Model 7 Cancelling.ExecuteDecisionImmediately = true
P Airplane Model 7 Cancelling.SaveResult = true
P Airplane Model 7 Cancelling.ResetDecision = true
P Airplane Model 7 Cancelling.DecisionMin = 0
P Airplane Model 7 Cancelling.DecisionMax = 5

V Airplane Model 7 Actual Cancelling[Team] = IF(Airplane Model 7 Cancelling = 0, 0, IF(Airplane Model 7 Cancelling > PREVIOUS(Airplane Model 7 Leased, 0), PREVIOUS(Airplane Model 7 Leased, 0), Airplane Model 7 Cancelling))

#V AirplaneFleet[Team] = AirplanesModel1Buy + AirplanesModel1Lease + AirplanesModel2Buy + AirplanesModel2Lease

#V AvailableSeats[Team] = AirplanesModel1Buy * AirplaneSeats + AirplanesModel1Lease * AirplaneSeats + AirplanesModel2Buy * AirplaneSeats + AirplanesModel2Lease * AirplaneSeats

####- MODEL CONSTANTS -####

V Demand = 1000

V AirplaneCost = 100
V AirplaneSeats = 30

V InFightMealsDemand = 0.95

####- INFLIGHT MEALS -###########################

D Inflight Meals Offered[Team] = 0
# 0 = No | 1 = Yesc
P Inflight Meals Offered.ExecuteDecisionImmediately = true

D Inflight Meals Structure[Team] = 0
# 0 = Free | 1 = Charged

D Inflight Beverages Offered[Team] = 0
# 0 = No | 1 = Yes
P Inflight Beverages Offered.ExecuteDecisionImmediately = true

D Inflight Beverages Structure[Team] = 0
# 0 = Free | 1 = Charged

##- CONSTANTS -##

V Inflight Const Meal Expense Per Customer = 8

V Inflight Const Beverage Expense Per Customer = 0.75

V Inflight Const Meal Revenue Per Customer = 12

V Inflight Const Beverage Revenue Per Customer = 2.5

##- INFLIGHT EXPENSES -##

V Inflight Passengers Purchasing Meals[Team] = FLOOR(Inflight Meals Offered * Total Final Seats Sold * 2 * (0.2 + RAND * (1-0.2)), 1)

V Inflight Meal Expenses[Team] = Inflight Passengers Purchasing Meals * Inflight Const Meal Expense Per Customer

V Inflight Passengers Purchasing Beverages[Team] = FLOOR(Inflight Beverages Offered * Total Final Seats Sold * 2 * (0.2 + RAND * (1-0.2)), 1)

V Inflight Beverage Expenses[Team] = Inflight Passengers Purchasing Beverages * Inflight Const Beverage Expense Per Customer

V Inflight Total Food Expenses[Team] = Inflight Beverage Expenses + Inflight Meal Expenses

##- INFLIGHT REVENUE -##

V Inflight Meal Revenue[Team] = Inflight Meals Structure * Inflight Passengers Purchasing Meals * Inflight Const Meal Revenue Per Customer

V Inflight Beverage Revenue[Team] = Inflight Beverages Structure * Inflight Passengers Purchasing Beverages * Inflight Const Beverage Revenue Per Customer

V Inflight Total Food Revenue[Team] = Inflight Meal Revenue + Inflight Beverage Revenue

####- SEATING ARRANGEMENTS -###########################
V Seating 0A Cost Per Seat = 0.002

D Seating Style[Team] = 1
# 1 = First Come First Serve | 2 = Assigned Seating
P Seating Style.ExecuteDecisionImmediately = true

V Seating Style Expenses[Team] = Total Available Seat Kms * Seating 0A Cost Per Seat * Seating Style

D Seating Assigned Premium[Team] = 0
# 1 = Free | 2 = Charged

D Seating First Come Premium[Team] = 0
# 1 = Free | 2 = Charged

####- BAGGAGE ARRANGEMENTS -###########################

D Baggage A Status[Team] = 0
# 0 = Free Baggage | 1 = Paid Baggage
P Baggage A Status.ExecuteDecisionImmediately = true

D Baggage B Number Of Free Bags[Team] = 0
P Baggage B Number Of Free Bags.ExecuteDecisionImmediately = true

D Baggage C Price Per Bag[Team] = 0
P Baggage C Price Per Bag.ExecuteDecisionImmediately = true
P Baggage C Price Per Bag.DecisionMax = 45
P Baggage C Price Per Bag.DecisionMin = 5

V Baggage D Revenue[Team] = FLOOR(Baggage A Status * Total Final Seats Sold * 2 * IF(Baggage B Number Of Free Bags = 0, (0.2 + RAND * (1-0.2)), IF(Baggage B Number Of Free Bags = 1, (0.2 + RAND * (0.9-0.2)), IF(Baggage B Number Of Free Bags = 2, (0.2 + RAND * (0.82-0.2)), (0.2 + RAND * (0.7-0.2))))), 1) * Baggage C Price Per Bag
 

####- CORPORATE RESPONSIBIlITY -####

D Donation A Status[Team] = 0
# 0 = No Donations | 1 = Donations
P Donation A Status.ExecuteDecisionImmediately = true

D Donation B Charitable Cause[Team] = 0

D Donation C Amount Donating[Team] = 0
P Donation C Amount Donating.ExecuteDecisionImmediately = true
P Donation C Amount Donating.DecisionMax = 75000
P Donation C Amount Donating.DecisionMin = 500

V Donation D Actual Amount Donating[Team] = IF(Donation A Status = 1, Donation C Amount Donating, 0) 


####- FINANCING DECISIONS -####
V Financing 0A Term Deposit Interest Rate = 1.0299
V Financing 0A Term Deposit Interest Rate Multiplier = 1.0299
V Financing 0B Short Term Debt Interest Rate = 0.051
V Financing 0B Short Term Debt Interest Rate Multiplier = 1 + Financing 0B Short Term Debt Interest Rate
V Financing 0C Long Term Debt Interest Rate = 0.031
V Financing 0C Long Term Debt Interest Rate Multiplier = 1 + Financing 0C Long Term Debt Interest Rate
V Financing 0D Maximum Stock Sell = 750000

D Financing AA Sell Stock[Team] = 0
P Financing AA Sell Stock.ExecuteDecisionImmediately = true
P Financing AA Sell Stock.ResetDecision = true
P Financing AA Sell Stock.DecisionMin = 0

V Financing AE Sell Stock Indicator[Team] = IF(Financing AA Sell Stock > Financing AF Sell Stock Maximum, 1, 0) 
V Financing AF Sell Stock Maximum[Team] = IF(Financing AF Percentage Of Previous Stock Outstanding > Financing 0D Maximum Stock Sell, Financing 0D Maximum Stock Sell, Financing AF Percentage Of Previous Stock Outstanding)
V Financing AF Percentage Of Previous Stock Outstanding[Team] = PREVIOUS(X Share Price, 0) * PREVIOUS(X Shares Outstanding, 0) * 0.125
V Financing AG Actual Sell Stock[Team] = IF(Financing AA Sell Stock > Financing AF Sell Stock Maximum, 0, Financing AA Sell Stock)
### ^ FIX

D Financing AB Buy Back Stock[Team] = 0
P Financing AB Buy Back Stock.ExecuteDecisionImmediately = true
P Financing AB Buy Back Stock.ResetDecision = true
P Financing AB Buy Back Stock.DecisionMin = 0

V Financing AC Validate Stock Buy Back[Team] = PREVIOUS(Shareholders A Common Stock) - Financing AB Buy Back Stock
V Financing ACB Vailidate Stock Buy Back Cash[Team] = PREVIOUS(Asset A Cash) - Financing AB Buy Back Stock
V Financing AD Actual Stock Buy Back[Team] = IF((Financing AC Validate Stock Buy Back > 150000) & (Financing ACB Vailidate Stock Buy Back Cash > 0), Financing AB Buy Back Stock, 0)



D Financing BA Issue Dividends[Team] = 0
P Financing BA Issue Dividends.ResetDecision = true
P Financing BA Issue Dividends.DecisionMin = 0
P Financing BA Issue Dividends.ExecuteDecisionImmediately = true

V Financing BB Validate Dividends[Team] = PREVIOUS(Asset A Cash, Asset 0 Initial Cash) - Financing BA Issue Dividends
V Financing BC Actual Dividends Paid[Team] = IF(Financing BB Validate Dividends > 0, Financing BA Issue Dividends, 0)
V Financing BD Dividend Share Price Factor[Team] = IF( PREVIOUS(Financing BC Actual Dividends Paid) = 0 & Financing BC Actual Dividends Paid > 0, 1.05, IF(PREVIOUS(Financing BC Actual Dividends Paid) > 0 & Financing BC Actual Dividends Paid = 0, 0.95, IF(PREVIOUS(Financing BC Actual Dividends Paid) > 0 & Financing BC Actual Dividends Paid > PREVIOUS(Financing BC Actual Dividends Paid), 1.02, IF(PREVIOUS(Financing BC Actual Dividends Paid) > 0 & Financing BC Actual Dividends Paid < PREVIOUS(Financing BC Actual Dividends Paid), 0.98, 1))))

D Financing C Obtain Short Term Loans[Team] = 0
P Financing C Obtain Short Term Loans.ExecuteDecisionImmediately = true
P Financing C Obtain Short Term Loans.ResetDecision = true
P Financing C Obtain Short Term Loans.DecisionMin = 0

V Financing CA Proposed Short Term Total Debt[Team] = PREVIOUS(Liability B Short Term Debt, 0) + Financing C Obtain Short Term Loans

V Financing CB Actual Obtain Short Term Loans[Team] = IF(Ratio Debt To Equity Ratio Proposed > 4 | Liability Z Total Liabilities Previ - Liability A Accounts Payable Previ + Financing CA Proposed Short Term Total Debt > Liability D Line Of Credit Previ, 0, Financing C Obtain Short Term Loans)
V Financing CB Short Term Loan Indicator[Team] = IF(Liability Z Total Liabilities Previ - Liability A Accounts Payable Previ + Financing CA Proposed Short Term Total Debt > Liability D Line Of Credit Previ, 1, 0)

D Financing D Obtain Long Term Loans[Team] = 0
P Financing D Obtain Long Term Loans.ExecuteDecisionImmediately = true
P Financing D Obtain Long Term Loans.ResetDecision = true
P Financing D Obtain Long Term Loans.DecisionMin = 0

D Financing H Pay Short Term Loans[Team] = 0
P Financing H Pay Short Term Loans.ExecuteDecisionImmediately = true
P Financing H Pay Short Term Loans.DecisionMin = 0
P Financing H Pay Short Term Loans.ResetDecision = true

D Financing I Pay Long Term Loans[Team] = 0
P Financing I Pay Long Term Loans.ExecuteDecisionImmediately = true
P Financing I Pay Long Term Loans.DecisionMin = 0
P Financing I Pay Long Term Loans.ResetDecision = true

V Financing IB Payment Of Loans Indicator[Team] = IF(Financing I Pay Long Term Loans + Financing H Pay Short Term Loans  > PREVIOUS(Asset A Cash, Asset 0 Initial Cash), 0 , 1)
V Financing IB Adjustment[8] = {0, 0, 0, 0, 0, 1, 1, 1}  
V Financing IB Actual Payment of Long Term Loans[Team] = IF(Financing IB Payment Of Loans Indicator = 0, Financing I Pay Long Term Loans * Financing IB Adjustment[STEP +  1], Financing I Pay Long Term Loans)
V Financing HB Actual Payment of Short Term Loans[Team] = IF(Financing IB Payment Of Loans Indicator = 0, Financing H Pay Short Term Loans * Financing IB Adjustment[STEP +  1], Financing H Pay Short Term Loans)

V Financing DA Proposed Long Term Total Debt[Team] = PREVIOUS(Liability C Long Term Debt, 0) + Financing D Obtain Long Term Loans


V Financing DB Actual Obtain Long Term Loans[Team] = IF(Ratio Debt To Equity Ratio Proposed > 4 | Liability Z Total Liabilities Previ - Liability A Accounts Payable Previ + Financing DA Proposed Long Term Total Debt > Liability D Line Of Credit Previ, 0, Financing D Obtain Long Term Loans)
V Financing DB Long Term Loan Indicator[Team] = IF(Liability Z Total Liabilities Previ - Liability A Accounts Payable Previ + Financing DA Proposed Long Term Total Debt > Liability D Line Of Credit Previ, 1, 0)

V Financing TA Proposed Total Debt And Accounts Payable[Team] = Financing CA Proposed Short Term Total Debt + Financing DA Proposed Long Term Total Debt + PREVIOUS(Liability A Accounts Payable, 0)

D Financing EA Term Deposit Investment[Team] = 0
P Financing EA Term Deposit Investment.ExecuteDecisionImmediately = true
P Financing EA Term Deposit Investment.ResetDecision = true
P Financing EA Term Deposit Investment.DecisionMin = 0

V Financing EB Validate Term Deposit Investment[Team] = PREVIOUS(Asset A Cash, Asset 0 Initial Cash) - Financing EA Term Deposit Investment
V Financing EC Actual Term Deposit Investment[Team] = IF(Financing EB Validate Term Deposit Investment > 0, Financing EA Term Deposit Investment, 0)

V Financing ED Redemption Term Deposit Investment[Team] = PREVIOUS(Financing EC Actual Term Deposit Investment) * Financing 0A Term Deposit Interest Rate

V Financing FA Share Price[Team] = PREVIOUS(Financing FA Share Price, 12)
V Financing FB Number Of Shares Outstanding[Team] = PREVIOUS(Financing FB Number Of Shares Outstanding, 32500) + (Financing AA Sell Stock / PREVIOUS(Financing FA Share Price)) - (Financing AA Sell Stock / PREVIOUS(Financing FA Share Price))

V Financing G Instant Cash Decisions[Team] = Financing AA Sell Stock + Financing C Obtain Short Term Loans + Financing D Obtain Long Term Loans - Financing EC Actual Term Deposit Investment + Financing ED Redemption Term Deposit Investment
# Necessary to determine how much cash is available to obtain aircraft at the beginning of the quarter --> Fleet Acquisition Validation VARIABLE

####- MARKETING DECISIONS -####

D Marketing A Print Advertising Campaign[Team] = 0
P Marketing A Print Advertising Campaign.ExecuteDecisionImmediately = true
V Marketing XA Print Advertising Cost = 75000

D Marketing B Social Media Advertising Campaign[Team] = 0
P Marketing B Social Media Advertising Campaign.ExecuteDecisionImmediately = true
V Marketing XB Social Media Advertising Cost = 10000

D Marketing C Website Advertising Campaign[Team] = 0
P Marketing C Website Advertising Campaign.ExecuteDecisionImmediately = true
V Marketing XC Website Advertising Cost = 65000

D Marketing D Billboards Advertising Campaign[Team] = 0
P Marketing D Billboards Advertising Campaign.ExecuteDecisionImmediately = true
V Marketing XD Billboards Advertising Cost = 150000

D Marketing E Radio Advertising Campaign[Team] = 0
P Marketing E Radio Advertising Campaign.ExecuteDecisionImmediately = true
V Marketing XE Radio Advertising Cost = 300000

D Marketing F TV Advertising Campaign[Team] = 0
P Marketing F TV Advertising Campaign.ExecuteDecisionImmediately = true
V Marketing XF TV Advertising Cost = 1200000

D Marketing G Hire Dedicated Sales Staff[Team] = 0
P Marketing G Hire Dedicated Sales Staff.ExecuteDecisionImmediately = true

D Marketing H Number Of Dedicated Sales Staff[Team] = 0
P Marketing H Number Of Dedicated Sales Staff.ExecuteDecisionImmediately = true
V Marketing H Actual Number of Dedicated Sales Staff[Team] = IF(Marketing G Hire Dedicated Sales Staff = 0, 0, Marketing H Number Of Dedicated Sales Staff)
V Marketing XH Wages Per Staff = 9000
V Marketing H Number Of Dedicated Sales Staff Previous[Team] = PREVIOUS(Marketing H Number Of Dedicated Sales Staff)

D Marketing I Outsourced Call Staff[Team] = 0
V Marketing XI Outsourced Call Staff Cost = 320000

D Marketing J Integrated Website Sales System[Team] = 0
V Marketing XJ Integrated Website Sales System Cost = 913000

D Marketing K Smartphone Application[Team] = 0
V Marketing XK Smartphone Application Cost = 90000

D Marketing M Cargo Service Line Status[Team] = 0
P Marketing M Cargo Service Line Status.ExecuteDecisionImmediately = true

D Marketing L Cargo Marketing Budget[Team] = 0
P Marketing L Cargo Marketing Budget.DecisionMin = 0
P Marketing L Cargo Marketing Budget.ExecuteDecisionImmediately = true
V Marketing L Cargo Marketing Budget Actual[Team] = IF(Marketing M Cargo Service Line Status = 0, 0, Marketing L Cargo Marketing Budget)

V Marketing Z Total Expenses[Team] = (Marketing A Print Advertising Campaign * Marketing XA Print Advertising Cost) + (Marketing B Social Media Advertising Campaign * Marketing XB Social Media Advertising Cost) + (Marketing C Website Advertising Campaign * Marketing XC Website Advertising Cost) + (Marketing D Billboards Advertising Campaign * Marketing XD Billboards Advertising Cost) + (Marketing E Radio Advertising Campaign * Marketing XE Radio Advertising Cost) + (Marketing F TV Advertising Campaign * Marketing XF TV Advertising Cost) + (Marketing H Actual Number of Dedicated Sales Staff * Marketing XH Wages Per Staff) + (Marketing I Outsourced Call Staff * Marketing XI Outsourced Call Staff Cost) + (Marketing J Integrated Website Sales System * Marketing XJ Integrated Website Sales System Cost) + (Marketing K Smartphone Application * Marketing XK Smartphone Application Cost) + Marketing L Cargo Marketing Budget Actual

##- CARGO REVENUE -##
V Marketing 0A Cargo Demand Per Quarter[8] = { 0, 0, 1250000, Marketing 0A Cargo Demand Per Quarter[3] * 1.05, Marketing 0A Cargo Demand Per Quarter[4] * 1.3, Marketing 0A Cargo Demand Per Quarter[5] * 0.90, Marketing 0A Cargo Demand Per Quarter[6] * 1.15, Marketing 0A Cargo Demand Per Quarter[3] * 1.2} 
V Marketing 0B Cargo Budget Sensitivity = 1.1

V Marketing X1 Teams In Cargo = ARRAYSUM(Marketing M Cargo Service Line Status)
#V Marketing X2 Cargo Industry Expenditure = ARRAYSUM(Marketing L Cargo Marketing Budget)

V Marketing X3 Cargo Weighted Expenditure[Team] = IF(Marketing M Cargo Service Line Status = 0, 0, IF(Price Structure = 1, Marketing L Cargo Marketing Budget Actual * 1.10, IF(Price Structure = 2, Marketing L Cargo Marketing Budget Actual * 0.92, Marketing L Cargo Marketing Budget Actual * 0.81)))
#V Marketing X4 Weighted Cargo Industry Expenditure = ARRAYSUM(Marketing X3 Cargo Weighted Expenditure)
V Marketing X5 Cargo Average Weighted Expenditure = ARRAYSUM(Marketing X3 Cargo Weighted Expenditure) / Marketing X1 Teams In Cargo
V Marketing X6 Cargo Attractiveness[Team] = (Marketing X3 Cargo Weighted Expenditure / Marketing X5 Cargo Average Weighted Expenditure) ^ Marketing 0B Cargo Budget Sensitivity

V Marketing X7 Cargo Service Market Share[Team] = Marketing X6 Cargo Attractiveness / ARRAYSUM(Marketing X6 Cargo Attractiveness)

V Marketing X8 Cargo Service Sales[Team] = IF((Marketing X7 Cargo Service Market Share * Marketing 0A Cargo Demand Per Quarter[STEP + 1]) < (40 * Marketing L Cargo Marketing Budget), (Marketing X7 Cargo Service Market Share * Marketing 0A Cargo Demand Per Quarter[STEP + 1]), (40 * Marketing L Cargo Marketing Budget))


# for cargo maybe if time add calculation for established firms to make more


####- WAGE & BENEFITS DECISIONS -####

D Compensation A Employee Training Budget[Team] = 0
P Compensation A Employee Training Budget.ExecuteDecisionImmediately = true

V Compensation AB Increase Quality[Team] = IF(Compensation A Employee Training Budget > 5000, 1.2, 1)

D Compensation B Wage Increase Status[Team] = 0
P Compensation B Wage Increase Status.ExecuteDecisionImmediately = true

D Compensation C Wage Increase Structure[Team] = 0
P Compensation C Wage Increase Structure.ExecuteDecisionImmediately = true

D Compensation D Wage Increase Percentage[Team] = 0
P Compensation D Wage Increase Percentage.ExecuteDecisionImmediately = true

D Compensation E Profit Sharing[Team] = 0
P Compensation E Profit Sharing.ExecuteDecisionImmediately = true

D Compensation F Stock Options[Team] = 0
P Compensation F Stock Options.ExecuteDecisionImmediately = true

D Compensation G Extended Medical And Dental[Team] = 0
P Compensation G Extended Medical And Dental.ExecuteDecisionImmediately = true

D Compensation H Life Insurance Policy[Team] = 0
P Compensation H Life Insurance Policy.ExecuteDecisionImmediately = true

V Compensation Number Of Pilots[Team] = X Employees Total * 1 / 3
V Compensation For Pilots = 0.00002
V Compensation Total For Pilots[Team] = Compensation For Pilots * Compensation Number Of Pilots * Total Available Seat Kms
V Compensation Number Of Managers[Team] = X Employees Total * 1 / 5
V Compensation For Managers = 0.0000275
V Compensation Total For Managers[Team] = Compensation For Managers * Compensation Number Of Managers * Total Available Seat Kms
V Compensation Number Of Others[Team] = X Employees Total * 7 / 15
V Compensation For Others = 0.0000125
V Compensation Total For Others[Team] = Compensation For Others * Compensation Number Of Others * Total Available Seat Kms
V Compensation Total[Team] = Compensation Total For Pilots + Compensation Total For Managers + Compensation Total For Others

####- FUEL & MAINTENANCE DECISIONS -####

D Maintenance A Scheduling[Team] = 0
# 0 = No Additional Maintenance | 1 = $1,750 per plane | 2 = $2,750 per plane
V Maintenance X Level 1 = 1750
V Maintenance X Level 2 = 2750

D Maintenance B Fuel Plan[Team] = 0
### FIX

####- ADMINISTRATIVE EXPENSES -####

V Administrative Expense Level 1 = 125000

V Administrative Expense Level 2 = 180000

V Administrative Expense Level 3 = 235000

V Administrative Expense Level 4 = 290000

V Administrative Expense Level 5 = 345000

V Administrative Expense Level 6 = 400000

V Administrative Expense Level 7 = 455000

V Administrative Expense Level 8 = 510000



###################################
# Simple supply chain model
# v 0.10 Last revised August 29, 2012
#
# This model is a single-player version of the beer game.
# The sim user enters 'Vendor Orders', which is delayed by 3 weeks before
# it becomes part of finished goods inventory.

###################################
# Model properties

#R Team = 1..1

#M MultiplayerRolesRange = Team

#M StartTime = 2010
#M EndTime = 2015

#M InitialSteps = 0
#M NumberFormat = #,##0

#D Advance Decision[Team] = 0
#P Advance Decision.ExecuteDecisionImmediately = true
#P Advance Decision.SaveResult = true
#P Advance Decision.ResetDecision = true

## PW
#D Price Tier[Team] = 0
#P Price Tier.DecisionMax = 3
#P Price Tier.DecisionMin = 0
#### Value of 3 = Luxury | Value of 2 = Normal | Value of 1 = Economy | 
## PW ^
#D Price[Team] = 500
#P Price.NumberFormat = "$#,###"

#D Price Sensitivity = 2
 
#V Industry Sales = 30000
#P Price Sensitivity.NumberFormat = "#,##0.0"
 
#V Market Attractiveness[Team] = ( ARRAYAVG(Price) / Price ) ^ Price Sensitivity
#P Market Attractiveness.NumberFormat = "#,##0.000"
 
#V Market Share[Team] = (Market Attractiveness / ARRAYSUM(Market Attractiveness))
#P Market Share.NumberFormat = "#0%"
 
#V Sales[Team] = Industry Sales * Market Share

## PW 
#V Airplane Cost = 10000
#P Airplane Cost.NumberFormat = "$#,###"

#D Airplane Fleet[Team] = 0
## PW ^

## PW
# ORIG V Costs[Team] = 40000
#V Costs[Team] = Airplane Cost * Airplane Fleet
## PW ^
#P Costs.NumberFormat = "$#,###"

#V Revenue[Team] = Price * Sales
#P Revenue.NumberFormat = "$#,###"
#P Revenue.SaveResult = true

#V Profit[Team] = IF (Airplane Fleet < 1, -1000, Revenue - Costs)
#P Profit.NumberFormat = "$#,###"
#P Profit.SaveResult = true

#V Cumulative Profit[Team] = ACCUM(Profit)  
#P Cumulative Profit.NumberFormat = "$#,###"


####

#M StartTime = 0
#M EndTime = 6
#M TimeStep = 1
#M InitialSteps = 1
#M NumberFormat = "#,##0"
#M TimeFormat = "#0"


#R Team = 1..2
#M MultiplayerRolesRange = Team

###################################

### Decisions

#D Price[Team] = 0
#P Price[Team].DecisionMax = 10
#P Price[Team].ExecuteDecisionImmediately = true
#P Price[Team].SaveResult = true

#D Available Seat Miles[Team] = 0
#P Available Seat Miles[Team].ExecuteDecisionImmediately = true
#P Available Seat Miles[Team].SaveResult = true


#V Possible Revenue[Team] = Price * Available Seat Miles


##################################


### Decisions

## Pricing
#D Price Tier Decision[Team] = 0
#P Price Tier Decision.SaveResult = TRUE
#P Price Tier Decision.DecisionMax = 2
#P Price Tier Decision.DecisionMin = 0


#D Price Per Km Decision[Team] = 0
#P Price Per Km Decision.SaveResult = TRUE

## Fleet



#D Scenario = 0
#D Vendor Orders = 10
#P Vendor Orders.DecisionMin = 0

###################################
# Pricing Tiers

#V Price Tiers = LOOKUP(Price Tier Decision, 0, Premium, Normal, Economy)


# Inventory Model

#V Time To Ship = 1
#V Available Goods = DELAY(Vendor Orders, Time To Ship)
#V Ordered From Vendors = STOCK(Vendor Orders - Available Goods, Vendor Orders)

#V Time To Build Product = 1
#V WIP Completion = DELAY(Available Goods, Time To Build Product)
#V Work In Process = STOCK( Available Goods - WIP Completion, Available Goods)
#V Finished Goods Inventory = STOCK(WIP Completion - Shipments, WIP Completion)

#V New Customer Orders = IF(TIME > 1, IF(Scenario=0, 15, 50), 10)
#V Unfilled Orders = MAX(0, New Customer Orders - Shipments)
#V Total Customer Orders = Cumulative Unfilled Orders + New Customer Orders
#V Shipments = MIN( Total Customer Orders, Finished Goods Inventory)

#V Inventory Coverage = SAFEDIV0(Finished Goods Inventory, Total Customer Orders)

#V Fraction Of Unfilled Orders That Are Cancelled = IF(Scenario = 2, 25%, 0%)
#V Cancelled Unfilled Orders = ROUND((Cumulative Unfilled Orders - Filled Orders) * Fraction Of Unfilled Orders That Are Cancelled)
#P Cancelled Unfilled Orders.NumberFormat = #,###.#
#V Cumulative Unfilled Orders = STOCK(Unfilled Orders - Filled Orders - Cancelled Unfilled Orders, 0)

#V Filled Orders = MAX(0, Shipments - New Customer Orders)
#V Lost Orders = ACCUM( Cancelled Unfilled Orders )
#P Lost Orders.NumberFormat = "#,###.#"

#V Game Over = IF(TIME > 2, IF(Ordered From Vendors = Work In Process, IF(Work In Process = Finished Goods Inventory, IF(Finished Goods Inventory = Total Customer Orders, IF(Cumulative Unfilled Orders=0, 1, 0), 0), 0), 0), 0)
#V Week Finished = Remember(Game Over = 1, TIME)

###################################
# The remaining section is used to generate the comments that appear in the web version of the sim.

#V BacklogCommentType = IF(Total Customer Orders > Shipments, 1, 0)
#V SurplusCommentType = IF(Finished Goods Inventory > Shipments, 1, 0)
#V EquilibriumCommentType = IF(Total Customer Orders = Finished Goods Inventory, 1, 0)
#V Comment Sequence[1..3, 1..5] = REMEMBER( STEP=0, RAND)
#V Number Sequence Count[1..3] = FOREACH(i, 1..3, IF(Comment Type=i, IF(PREVIOUS(Number Sequence Count[i], 0) = 5, 1, PREVIOUS(Number Sequence Count[i], 0 ) + 1), PREVIOUS(Number Sequence Count[i], 0)))
#V Comment Type = IF(BacklogCommentType, 1, IF(SurplusCommentType, 2, IF(EquilibriumCommentType, 3, 0)))
#V Comment = IF(Game Over == 1, -1, IF(STEP == -2, 12, IF(TIME < 2, 0, INDEXOF ( Comment Sequence [Comment Type, Number Sequence Count[Comment Type]], ARRAYSORT ( Comment Sequence[Comment Type, * ] )) + ((Comment Type - 1) * 5 ))))